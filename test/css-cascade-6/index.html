<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>CSS Cascading and Inheritance Level 6</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 3f621ba99, updated Mon Jul 28 15:38:36 2025 -0700" name="generator">
  <link href="https://www.w3.org/TR/css-cascade-6/" rel="canonical">
  <link href="https://drafts.csswg.org/csslogo.ico" rel="icon">
  <meta content="744ea620945d6e1fb3f245e5cc04668dfe3000f5" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-mdn-anno */
:root {
	--mdn-bg: #EEE;
	--mdn-shadow: #999;
	--mdn-nosupport-text: #ccc;
	--mdn-pass: green;
	--mdn-fail: red;
}
@media (prefers-color-scheme: dark) {
	:root {
		--mdn-bg: #222;
		--mdn-shadow: #444;
		--mdn-nosupport-text: #666;
		--mdn-pass: #690;
		--mdn-fail: #d22;
	}
}
.mdn-anno {
	background: var(--mdn-bg, #EEE);
	border-radius: .25em;
	box-shadow: 0 0 3px var(--mdn-shadow, #999);
	color: var(--text, black);
	font: 1em sans-serif;
	hyphens: none;
	max-width: min-content;
	overflow: hidden;
	padding: 0.2em;
	position: absolute;
	right: 0.3em;
	top: auto;
	white-space: nowrap;
	word-wrap: normal;
	z-index: 8;
}
.mdn-anno.unpositioned {
	display: none;
}
.mdn-anno.overlapping-main {
	opacity: .2;
	transition: opacity .1s;
}
.mdn-anno[open] {
	opacity: 1;
	z-index: 9;
	min-width: 9em;
}
.mdn-anno:hover {
	opacity: 1;
	outline: var(--text, black) 1px solid;
}
.mdn-anno > summary {
	font-weight: normal;
	text-align: right;
	cursor: pointer;
	display: block;
}
.mdn-anno > summary > .less-than-two-engines-flag {
	color: var(--mdn-fail);
	padding-right: 2px;
}
.mdn-anno > summary > .all-engines-flag {
	color: var(--mdn-pass);
	padding-right: 2px;
}
.mdn-anno > summary > span {
	color: #fff;
	background-color: #000;
	font-weight: normal;
	font-family: zillaslab, Palatino, "Palatino Linotype", serif;
	padding: 2px 3px 0px 3px;
	line-height: 1.3em;
	vertical-align: top;
}
.mdn-anno > .feature {
	margin-top: 20px;
}
.mdn-anno > .feature:not(:first-of-type) {
	border-top: 1px solid #999;
	margin-top: 6px;
	padding-top: 2px;
}
.mdn-anno > .feature > .less-than-two-engines-text {
	color: var(--mdn-fail);
}
.mdn-anno > .feature > .all-engines-text {
	color: var(--mdn-pass);
}
.mdn-anno > .feature > p {
	font-size: .75em;
	margin-top: 6px;
	margin-bottom: 0;
}
.mdn-anno > .feature > p + p {
	margin-top: 3px;
}
.mdn-anno > .feature > .support {
	display: block;
	font-size: 0.6em;
	margin: 0;
	padding: 0;
	margin-top: 2px;
}
.mdn-anno > .feature > .support + div {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > hr {
	display: block;
	border: none;
	border-top: 1px dotted #999;
	padding: 3px 0px 0px 0px;
	margin: 2px 3px 0px 3px;
}
.mdn-anno > .feature > .support > hr::before {
	content: "";
}
.mdn-anno > .feature > .support > span {
	padding: 0.2em 0;
	display: block;
	display: table;
}
.mdn-anno > .feature > .support > span.no {
	color: var(--mdn-nosupport-text);
	filter: grayscale(100%);
}
.mdn-anno > .feature > .support > span.no::before {
	opacity: 0.5;
}
.mdn-anno > .feature > .support > span:first-of-type {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > span > span {
	padding: 0 0.5em;
	display: table-cell;
}
.mdn-anno > .feature > .support > span > span:first-child {
	width: 100%;
}
.mdn-anno > .feature > .support > span > span:last-child {
	width: 100%;
	white-space: pre;
	padding: 0;
}
.mdn-anno > .feature > .support > span::before {
	content: ' ';
	display: table-cell;
	min-width: 1.5em;
	height: 1.5em;
	background: no-repeat center center;
	background-size: contain;
	text-align: right;
	font-size: 0.75em;
	font-weight: bold;
}
.mdn-anno > .feature > .support > .chrome_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .firefox_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .chrome::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .edge_blink::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
}
.mdn-anno > .feature > .support > .edge::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
}
.mdn-anno > .feature > .support > .firefox::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .ie::before {
	background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
}
.mdn-anno > .feature > .support > .safari_ios::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
}
.mdn-anno > .feature > .support > .nodejs::before {
	background-image: url(https://nodejs.org/favicon.ico);
}
.mdn-anno > .feature > .support > .opera_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .opera::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .safari::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
}
.mdn-anno > .feature > .support > .samsunginternet_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
}
.mdn-anno > .feature > .support > .webview_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
}
.name-slug-mismatch {
	color: red;
}
.caniuse-status:hover {
	z-index: 9;
}
/* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */;
.h-entry:not(.status-LS) dt > .mdn-anno, .h-entry:not(.status-LS) li > .mdn-anno, .h-entry:not(.status-LS) .issue > .mdn-anno, .h-entry:not(.status-LS) .note > .mdn-anno, .h-entry:not(.status-LS) .example > .mdn-anno {
	right: -6.7em;
}
.h-entry p + .mdn-anno {
	margin-top: 0;
}
 h2 + .mdn-anno.after {
	margin: -48px 0 0 0;
}
 h3 + .mdn-anno.after {
	margin: -46px 0 0 0;
}
 h4 + .mdn-anno.after {
	margin: -42px 0 0 0;
}
 h5 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
 h6 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-wpt */
:root {
    --wpt-border: hsl(0, 0%, 60%);
    --wpt-bg: hsl(0, 0%, 95%);
    --wpt-text: var(--text);
    --wptheading-text: hsl(0, 0%, 30%);
}
@media (prefers-color-scheme: dark) {
    :root {
        --wpt-border: hsl(0, 0%, 30%);
        --wpt-bg: var(--borderedblock-bg);
        --wpt-text: var(--text);
        --wptheading-text: hsl(0, 0%, 60%);
    }
}
.wpt-tests-block {
    list-style: none;
    border-left: .5em solid var(--wpt-border);
    background: var(--wpt-bg);
    color: var(--wpt-text);
    margin: 1em auto;
    padding: .5em;
}
.wpt-tests-block summary {
    color: var(--wptheading-text);
    font-weight: normal;
    text-transform: uppercase;
}
.wpt-tests-block summary::marker{
    color: var(--wpt-border);
}
.wpt-tests-block summary:hover::marker{
    color: var(--wpt-text);
}
/*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
.wpt-tests-block:not([open]){
    padding: 0;
    border: none;
    background: none;
    font-size: 0.75em;
    line-height: 1;
    position: relative;
    margin: 1em 0 0;
}
.wpt-tests-block:not([open]) summary {
    position: absolute;
    right: 0;
    bottom: 0;
}
/*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
.wpt-tests-block:not([open]):last-child {
    padding-bottom: 1px;
    margin-bottom: -1px;
}
/*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
li:not(:last-child) > .wpt-tests-block:not([open]):last-child,
dd:not(:last-child) > .wpt-tests-block:not([open]):last-child {
    padding-bottom: 0;
    margin-bottom: 0;
}
.wpt-tests-block:not([open]):not(:hover){
    opacity: 0.5;
}
.wpt-tests-list {
    list-style: none;
    display: grid;
    margin: 0;
    padding: 0;
    grid-template-columns: 1fr max-content auto auto;
    grid-column-gap: .5em;
}
.wpt-tests-block hr:last-child {
    display: none;
}
.wpt-test {
    display: contents;
}
.wpt-test > a {
    text-decoration: underline;
    border: none;
}
.wpt-test > .wpt-name { grid-column: 1; }
.wpt-test > .wpt-results { grid-column: 2; }
.wpt-test > .wpt-live { grid-column: 3; }
.wpt-test > .wpt-source { grid-column: 4; }

.wpt-test > .wpt-results {
    display: flex;
    gap: .1em;
}
.wpt-test .wpt-result {
    display: inline-block;
    height: 1em;
    width: 1em;
    border-radius: 50%;
    position: relative;
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
</a>
</p>
   <h1 class="p-name no-ref" id="title">CSS Cascading and Inheritance Level 6</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>,
    <time class="dt-updated" datetime="2025-03-18">18 March 2025</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://drafts.csswg.org/css-cascade-6/">https://drafts.csswg.org/css-cascade-6/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/css-cascade-6/">https://www.w3.org/TR/css-cascade-6/</a>
      <dt>Previous Versions:
      <dd><a href="https://www.w3.org/TR/2021/WD-css-cascade-6-20211221/" rel="prev">https://www.w3.org/TR/2021/WD-css-cascade-6-20211221/</a>
      <dt>Feedback:
      <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-cascade-6">CSSWG Issues Repository</a>
      <dd><a href="#issues-index">Inline In Spec</a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="35400"><a class="p-name fn u-url url" href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a> (<span class="p-org org">Apple</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="117151"><a class="p-name fn u-url url" href="http://miriamsuzanne.com/contact">Miriam E. Suzanne</a> (<span class="p-org org">Invited Expert</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url" href="http://xanthir.com/contact/">Tab Atkins Jr.</a> (<span class="p-org org">Google</span>)
      <dt>Suggest an Edit for this Spec:
      <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-cascade-6/Overview.bs">GitHub Editor</a>
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply.
</p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This CSS module describes how to collate style rules and assign values to all properties on all elements. By way of cascading and inheritance, values are propagated for all properties on all elements.</p>
   <p>New in this level is <a href="#scoped-styles">§ 2.5 Scoping Styles: the @scope rule</a>.</p>
   


<a href="https://www.w3.org/TR/CSS/">CSS</a> is a language for describing the rendering of structured documents
(such as HTML and XML)
on screen, on paper, etc.


  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p>Please send feedback
	by <a href="https://github.com/w3c/csswg-drafts/issues">filing issues in GitHub</a> (preferred),
	including the spec code “css-cascade” in the title, like this:
	“[css-cascade] <i>…summary of comment…</i>”.
	All issues and comments are <a href="https://lists.w3.org/Archives/Public/public-css-archive/">archived</a>.
	Alternately, feedback can be sent to the (<a href="https://lists.w3.org/Archives/Public/www-style/">archived</a>) public mailing list
	<a href="mailto:www-style@w3.org?Subject=%5Bcss-cascade%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>.

</p>
   <p>This document is governed by the
	<a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">18 August 2025 W3C Process Document</a>.

</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">
Introduction and Missing Sections</span></a>
    <li>
     <a href="#cascading"><span class="secno">2</span> <span class="content">
Cascading</span></a>
     <ol class="toc">
      <li><a href="#cascade-sort"><span class="secno">2.1</span> <span class="content">
Cascade Sorting Order</span></a>
      <li><a href="#cascading-origins"><span class="secno">2.2</span> <span class="content">
Cascading Origins</span></a>
      <li><a href="#importance"><span class="secno">2.3</span> <span class="content">
Important Declarations: the <span class="css">!important</span> annotation</span></a>
      <li>
       <a href="#layering"><span class="secno">2.4</span> <span class="content">
Cascade Layers</span></a>
       <ol class="toc">
        <li><a href="#layer-ordering"><span class="secno">2.4.1</span> <span class="content">
Layer Ordering</span></a>
       </ol>
      <li>
       <a href="#scoped-styles"><span class="secno">2.5</span> <span class="content">
Scoping Styles: the <span class="css">@scope</span> rule</span></a>
       <ol class="toc">
        <li><a href="#scope-effects"><span class="secno">2.5.1</span> <span class="content">
Effects of <span class="css">@scope</span></span></a>
        <li><a href="#scope-syntax"><span class="secno">2.5.2</span> <span class="content">
Syntax of <span class="css">@scope</span></span></a>
        <li><a href="#scoped-rules"><span class="secno">2.5.3</span> <span class="content">
Scoped Style Rules</span></a>
        <li><a href="#scope-limits"><span class="secno">2.5.4</span> <span class="content">
Identifying Scoping Roots and Limits</span></a>
        <li><a href="#scope-scope"><span class="secno">2.5.5</span> <span class="content">
Scope Nesting</span></a>
        <li><a href="#scoped-declarations"><span class="secno">2.5.6</span> <span class="content">
Scoped Declarations </span></a>
       </ol>
      <li><a href="#preshint"><span class="secno">2.6</span> <span class="content">
Precedence of Non-CSS Presentational Hints</span></a>
     </ol>
    <li>
     <a href="#cssom"><span class="secno">3</span> <span class="content">CSSOM</span></a>
     <ol class="toc">
      <li><a href="#the-cssscoperule-interface"><span class="secno">3.1</span> <span class="content">
The <code>CSSScopeRule</code> interface</span></a>
     </ol>
    <li>
     <a href="#changes"><span class="secno">4</span> <span class="content">
Changes</span></a>
     <ol class="toc">
      <li><a href="#changes-since-2023-03"><span class="secno">4.1</span> <span class="content">
Changes since the 21 March 2023 Working Draft</span></a>
      <li><a href="#changes-2022-08"><span class="secno">4.2</span> <span class="content">
Changes since the 21 December 2021 First Public Working Draft</span></a>
      <li><a href="#additions-l5"><span class="secno">4.3</span> <span class="content">
Additions Since Level 5</span></a>
      <li><a href="#additions-l4"><span class="secno">4.4</span> <span class="content">
Additions Since Level 4</span></a>
      <li><a href="#additions-l3"><span class="secno">4.5</span> <span class="content">
Additions Since Level 3</span></a>
      <li><a href="#changes-2"><span class="secno">4.6</span> <span class="content">
Additions Since Level 2</span></a>
     </ol>
    <li><a href="#acknowledgments"><span class="secno"></span> <span class="content">Acknowledgments</span></a>
    <li><a href="#privacy"><span class="secno">5</span> <span class="content">
Privacy Considerations</span></a>
    <li><a href="#security"><span class="secno">6</span> <span class="content">
Security Considerations</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">
Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">
Document conventions</span></a>
      <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
Conformance classes</span></a>
      <li>
       <a href="#w3c-partial"><span class="secno"></span> <span class="content">
Partial implementations</span></a>
       <ol class="toc">
        <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span class="content">
Implementations of Unstable and Proprietary Features</span></a>
       </ol>
      <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">
Non-experimental implementations</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="bs-old-id" id="default"></span><span class="bs-old-id" id="inherit-initial"></span><span class="bs-old-id" id="inherit"></span><span class="bs-old-id" id="initial"></span><span class="bs-old-id" id="defaulting-keywords"></span><span class="bs-old-id" id="inheriting"></span><span class="bs-old-id" id="initial-values"></span><span class="bs-old-id" id="defaulting"></span><span class="bs-old-id" id="at-import"></span><span class="bs-old-id" id="conditional-import"></span><span class="bs-old-id" id="import-processing"></span><span class="bs-old-id" id="content-type"></span><span class="bs-old-id" id="shorthand"></span><span class="bs-old-id" id="aliasing"></span><span class="bs-old-id" id="all-shorthand"></span><span class="bs-old-id" id="value-stages"></span><span class="bs-old-id" id="specified"></span><span class="bs-old-id" id="declared"></span><span class="bs-old-id" id="cascaded"></span><span class="bs-old-id" id="computed"></span><span class="bs-old-id" id="used"></span><span class="bs-old-id" id="actual"></span><span class="bs-old-id" id="stages-examples"></span><span class="bs-old-id" id="fragments"></span><span class="bs-old-id" id="filtering"></span><span class="content">
Introduction and Missing Sections</span><a class="self-link" href="#intro"></a></h2>
   <p class="issue" id="issue-a783701e"><a class="self-link" href="#issue-a783701e"></a> This is a diff spec over <a href="https://www.w3.org/TR/css-cascade-5/">CSS Cascading and Inheritance Level 5</a>.
	It is currently an Exploratory Working Draft:
	if you are implementing anything, please use Level 5 as a reference.
	We will merge the Level 5 text into this draft once it reaches CR.</p>
   <h2 class="heading settled" data-level="2" id="cascading"><span class="secno">2. </span><span class="content">
Cascading</span><a class="self-link" href="#cascading"></a></h2>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="cascade">cascade</dfn>
	takes an unordered list of <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#declared-value" id="ref-for-declared-value">declared values</a>
	for a given property on a given element,
	sorts them by their <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#declaration" id="ref-for-declaration">declaration’s</a> precedence as determined below,
	and outputs a single <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascaded-value" id="ref-for-cascaded-value">cascaded value</a>.</p>
   <h3 class="heading settled" data-level="2.1" id="cascade-sort"><span class="secno">2.1. </span><span class="content">
Cascade Sorting Order</span><a class="self-link" href="#cascade-sort"></a></h3>
   <p>The cascade sorts <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations">declarations</a> according to the following criteria,
	in descending order of precedence:</p>
   <dl>
    <dt id="cascade-origin"><a class="self-link" href="#cascade-origin"></a>Origin and Importance
		
    <dd>
     
			The <a data-link-type="dfn" href="#origin" id="ref-for-origin">origin</a> of a <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#declaration" id="ref-for-declaration①">declaration</a> is based on where it comes from
			and its <a data-link-type="dfn" href="#important" id="ref-for-important">importance</a> is
			whether or not it is declared with <span class="css">!important</span>
			(see <a href="#importance">below</a>).
			The precedence of the various <span id="ref-for-origin①">origins</span> is, in descending order:

			
     <ol>
      <li>Transition declarations <a data-link-type="biblio" href="#biblio-css-transitions-1" title="CSS Transitions">[css-transitions-1]</a>
				
      <li><a data-link-type="dfn" href="#important" id="ref-for-important①">Important</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-origin-ua" id="ref-for-cascade-origin-ua">user agent</a> declarations
				
      <li><a data-link-type="dfn" href="#important" id="ref-for-important②">Important</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-origin-user" id="ref-for-cascade-origin-user">user</a> declarations
				
      <li><a data-link-type="dfn" href="#important" id="ref-for-important③">Important</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-origin-author" id="ref-for-cascade-origin-author">author</a> declarations
				
      <li>Animation declarations <a data-link-type="biblio" href="#biblio-css-animations-1" title="CSS Animations Level 1">[css-animations-1]</a>
				
      <li><a data-link-type="dfn" href="#normal" id="ref-for-normal">Normal</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-origin-author" id="ref-for-cascade-origin-author①">author</a> declarations
				
      <li><a data-link-type="dfn" href="#normal" id="ref-for-normal①">Normal</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-origin-user" id="ref-for-cascade-origin-user①">user</a> declarations
				
      <li><a data-link-type="dfn" href="#normal" id="ref-for-normal②">Normal</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-origin-ua" id="ref-for-cascade-origin-ua①">user agent</a> declarations
			
     </ol>
     <p>Declarations from <a data-link-type="dfn" href="#origin" id="ref-for-origin②">origins</a> earlier in this list win over declarations from later <span id="ref-for-origin③">origins</span>.</p>
    <dt id="cascade-context"><a class="self-link" href="#cascade-context"></a>Context
		
    <dd>
     
			A document language can provide for blending <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations①">declarations</a> sourced
			from different <dfn class="dfn-paneled" data-dfn-type="dfn" data-local-lt="context" data-noexport id="encapsulation-contexts">encapsulation contexts</dfn>,
			such as the nested <a data-link-type="dfn" href="https://drafts.csswg.org/css-scoping-1/#tree-context" id="ref-for-tree-context">tree contexts</a> of <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-shadow-tree" id="ref-for-concept-shadow-tree">shadow trees</a> in the <a data-link-type="biblio" href="#biblio-dom" title="DOM Standard">[DOM]</a>.


     <p>When comparing two declarations
			that are sourced from different <a data-link-type="dfn" href="#encapsulation-contexts" id="ref-for-encapsulation-contexts">encapsulation contexts</a>,
			then for <a data-link-type="dfn" href="#normal" id="ref-for-normal③">normal</a> rules
			the declaration from the outer context wins,
			and for <a data-link-type="dfn" href="#important" id="ref-for-important④">important</a> rules
			the declaration from the inner context wins.
			For this purpose,
			<a data-link-type="biblio" href="#biblio-dom" title="DOM Standard">[DOM]</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-scoping-1/#tree-context" id="ref-for-tree-context①">tree contexts</a> are considered to be nested
			in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-shadow-including-tree-order" id="ref-for-concept-shadow-including-tree-order">shadow-including tree order</a>.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This effectively means that
			<a data-link-type="dfn" href="#normal" id="ref-for-normal④">normal</a> declarations belonging to an <a data-link-type="dfn" href="#encapsulation-contexts" id="ref-for-encapsulation-contexts①">encapsulation context</a>
			can set defaults that are easily overridden by the outer context,
			while <a data-link-type="dfn" href="#important" id="ref-for-important⑤">important</a> declarations belonging to an <span id="ref-for-encapsulation-contexts②">encapsulation context</span>
			can enforce requirements that cannot be overridden by the outer context.</p>
    <dt id="style-attr"><a class="self-link" href="#style-attr"></a>The Style Attribute
		
    <dd>
			Separately for <a data-link-type="dfn" href="#normal" id="ref-for-normal⑤">normal</a> and <a data-link-type="dfn" href="#important" id="ref-for-important⑥">important</a> <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations②">declarations</a>,
			declarations that are attached directly to an element
			(such as the <a href="https://www.w3.org/TR/css-style-attr/#interpret">contents of a style attribute</a>)
			rather than indirectly mapped by means of a style rule selector
			take precedence over declarations the same <span id="ref-for-important⑦">importance</span>
			that are mapped via style rule.

		
    <dt id="cascade-layering"><a class="self-link" href="#cascade-layering"></a>Layers
		
    <dd>
     
			<a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations③">Declarations</a> within each <a data-link-type="dfn" href="#origin" id="ref-for-origin④">origin</a> and <a data-link-type="dfn" href="#encapsulation-contexts" id="ref-for-encapsulation-contexts③">context</a>
			can be explicitly assigned to a <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-layers" id="ref-for-cascade-layers">cascade layer</a>.
			For the purpose of this step,
			any declaration not assigned to an explicit layer is added to an implicit final layer.


     <p>Cascade layers (like declarations) are sorted by order of appearance,
			see <a href="#layer-ordering">§ 2.4.1 Layer Ordering</a>.
			When comparing declarations that belong to different layers,
			then for <a data-link-type="dfn" href="#normal" id="ref-for-normal⑥">normal</a> rules the declaration whose <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-layers" id="ref-for-cascade-layers①">cascade layer</a> is latest in the layer order wins,
			and for <a data-link-type="dfn" href="#important" id="ref-for-important⑧">important</a> rules the declaration whose <span id="ref-for-cascade-layers②">cascade layer</span> is earliest wins.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This follows the same logic used for precedence of <a data-link-type="dfn" href="#normal" id="ref-for-normal⑦">normal</a> and <a data-link-type="dfn" href="#important" id="ref-for-important⑨">important</a> <a data-link-type="dfn" href="#origin" id="ref-for-origin⑤">origins</a>,
			thus the <span class="css">!important</span> flag maintains the same “override” purpose in both settings.</p>
    <dt id="cascade-specificity"><a class="self-link" href="#cascade-specificity"></a>Specificity
		
    <dd>
     
			The <a href="https://www.w3.org/TR/selectors/#specificity">Selectors module</a> <a data-link-type="biblio" href="#biblio-select" title="Selectors Level 3">[SELECT]</a>
			describes how to compute the specificity of a selector.


     <p>When comparing declarations from two style rules,
			the declaration belonging to
			the style rule with the highest specificity wins.</p>
    <dt id="cascade-proximity"><a class="self-link" href="#cascade-proximity"></a><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scope-proximity">Scope Proximity</dfn>
		
    <dd>
			When comparing declarations that appear in style rules
			with different <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root">scoping roots</a>,
			then the declaration with the fewest
			generational or sibling-element hops
			between the <span id="ref-for-scoping-root①">scoping root</span> and the
			<a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules">scoped style rule</a> <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector-subject" id="ref-for-selector-subject">subject</a> wins.
			For this purpose,
			style rules without a <span id="ref-for-scoping-root②">scoping root</span>
			are considered to have infinite proximity hops.

		
    <dt id="cascade-order"><a class="self-link" href="#cascade-order"></a>Order of Appearance
		
    <dd>
     
			The last declaration in document order wins.
			For this purpose:

			
     <ul>
      <li>Style sheets are ordered as in <a href="https://drafts.csswg.org/cssom/#documentorshadowroot-final-css-style-sheets">final CSS style sheets</a>.
				
      <li>Declarations from <a class="css" data-link-type="at-rule" href="https://drafts.csswg.org/css-cascade-5/#at-ruledef-import" id="ref-for-at-ruledef-import">imported style sheets</a>
					are ordered as if their style sheets were substituted in place of the <span class="css" id="ref-for-at-ruledef-import①">@import</span> rule.
				
      <li>Declarations from style sheets independently linked by the originating document
					are treated as if they were concatenated in linking order,
					as determined by the host document language.
				
      <li>Declarations from style attributes
					are ordered according to the document order of the element the style attribute appears on,
					and are all placed after any style sheets.
					<a data-link-type="biblio" href="#biblio-cssstyleattr" title="CSS Style Attributes">[CSSSTYLEATTR]</a>
			
     </ul>
   </dl>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="output-of-the-cascade">output of the cascade</dfn>
	is a (potentially empty) sorted list of <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#declared-value" id="ref-for-declared-value①">declared values</a> for each property on each element.</p>
   <h3 class="heading settled" data-level="2.2" id="cascading-origins"><span class="secno">2.2. </span><span class="content">
Cascading Origins</span><a class="self-link" href="#cascading-origins"></a></h3>
   <p class="issue" id="issue-d41d8cd9"><a class="self-link" href="#issue-d41d8cd9"></a> <a href="https://drafts.csswg.org/css-cascade-5/#cascading-origins"><cite>CSS Cascading 5</cite> § 6.2 Cascading Origins</a></p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="origin" id="origin">cascade origin</dfn></p>
   <h3 class="heading settled" data-level="2.3" id="importance"><span class="secno">2.3. </span><span class="content">
Important Declarations: the <span class="css">!important</span> annotation</span><a class="self-link" href="#importance"></a></h3>
   <p class="issue" id="issue-d41d8cd9①"><a class="self-link" href="#issue-d41d8cd9①"></a> <a href="https://drafts.csswg.org/css-cascade-5/#importance"><cite>CSS Cascading 5</cite> § 6.3 Important Declarations: the !important annotation</a></p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="importance" id="important">important</dfn>
	<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="normal">normal</dfn></p>
   <h3 class="heading settled" data-level="2.4" id="layering"><span class="secno">2.4. </span><span class="content">
Cascade Layers</span><a class="self-link" href="#layering"></a></h3>
   <p class="issue" id="issue-d41d8cd9②"><a class="self-link" href="#issue-d41d8cd9②"></a> <a href="https://drafts.csswg.org/css-cascade-5/#layering"><cite>CSS Cascading 5</cite> § 6.4 Cascade Layers</a></p>
   <h4 class="heading settled" data-level="2.4.1" id="layer-ordering"><span class="secno">2.4.1. </span><span class="content">
Layer Ordering</span><a class="self-link" href="#layer-ordering"></a></h4>
   <p class="issue" id="issue-d41d8cd9③"><a class="self-link" href="#issue-d41d8cd9③"></a> <a href="https://drafts.csswg.org/css-cascade-5/#layer-ordering"><cite>CSS Cascading 5</cite> § 6.4.3 Layer Ordering</a></p>
   <h3 class="heading settled" data-level="2.5" id="scoped-styles"><span class="secno">2.5. </span><span class="bs-old-id" id="scope-atrule"></span><span class="content">
Scoping Styles: the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope">@scope</a> rule</span><a class="self-link" href="#scoped-styles"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scope">scope</dfn> is a subtree or fragment of a document,
	which can be used by selectors for more targeted matching.
	A <a data-link-type="dfn" href="#scope" id="ref-for-scope">scope</a> is formed by determining:</p>
   <ul>
    <li data-md>
     <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root③">scoping root</a> <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#boundary-point-node" id="ref-for-boundary-point-node">node</a>,
which acts as the upper bound of the scope,
and optionally:</p>
    <li data-md>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scoping-limit">scoping limit</dfn> elements,
which act as the lower bounds.</p>
   </ul>
   <p>An element is <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="in-scope">in scope</dfn> if:</p>
   <ul>
    <li data-md>
     <p>It is an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-inclusive-descendant" id="ref-for-concept-tree-inclusive-descendant">inclusive descendant</a> of the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root④">scoping root</a>, and</p>
    <li data-md>
     <p>It is not an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-inclusive-descendant" id="ref-for-concept-tree-inclusive-descendant①">inclusive descendant</a> of a <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit">scoping limit</a>.</p>
   </ul>
   <p class="note" role="note"><span class="marker">Note:</span> In contrast to <a href="https://drafts.csswg.org/css-scoping-1/#shadow-dom">Shadow Encapsulation</a>,
	which describes a persistent one-to-one relationship in the DOM
	between a <a data-link-type="dfn" href="https://www.w3.org/TR/css-scoping-1/#shadow-host" id="ref-for-shadow-host">shadow host</a> and its nested <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-shadow-tree" id="ref-for-concept-shadow-tree①">shadow tree</a>,
	multiple overlapping <a data-link-type="dfn" href="#scope" id="ref-for-scope①">scopes</a> can be defined in relation to the same elements.</p>
   <p>Scoped styles are described in CSS using
	the <dfn class="dfn-paneled css" data-dfn-type="at-rule" data-export id="at-ruledef-scope">@scope</dfn> <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#block-at-rule" id="ref-for-block-at-rule">block at-rule</a>,
	which declares a <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root⑤">scoping root</a> and optional <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit①">scoping limits</a>
	associated with a set of <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#style-rule" id="ref-for-style-rule">style rules</a>.</p>
   <div class="example" id="example-f310c4e4">
    <a class="self-link" href="#example-f310c4e4"></a>
		For example,
		an author might have wide-reaching color-scheme scopes,
		which overlap more narrowly-scoped design patterns
		such as a media object.
		The selectors in the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope①">@scope</a> rule
		establish <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root⑥">scoping root</a> and optional <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit②">scoping limit</a> elements,
		while the nested selectors only match elements
		that are <a data-link-type="dfn" href="#in-scope" id="ref-for-in-scope">in a resulting scope</a>:

		
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->.light-scheme<c- p>)</c-> <c- p>{</c->
  <c- c>/* Only match links inside a light-scheme */</c->
  a <c- p>{</c-> <c- k>color</c-><c- p>:</c-> darkmagenta<c- p>;</c-> <c- p>}</c->
<c- p>}</c->

<c- n>@scope</c-> <c- p>(</c->.dark-scheme<c- p>)</c-> <c- p>{</c->
  <c- c>/* Only match links inside a dark-scheme */</c->
  a <c- p>{</c-> <c- k>color</c-><c- p>:</c-> plum<c- p>;</c-> <c- p>}</c->
<c- p>}</c->

<c- n>@scope</c-> <c- p>(</c->.media-object<c- p>)</c-> <c- p>{</c->
  <c- c>/* Only match author images inside a media-object */</c->
  .author-image <c- p>{</c-> <c- k>border-radius</c-><c- p>:</c-> <c- m>50</c-><c- k>%</c-><c- p>;</c-> <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <div class="example" id="example-b0418ef2">
    <a class="self-link" href="#example-b0418ef2"></a>
		By providing <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit③">scoping limits</a>,
		an author can limit matching more deeply nested descendants.
		For example:

		
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->.media-object<c- p>)</c-> to <c- p>(</c->.content > *<c- p>)</c-> <c- p>{</c->
  img <c- p>{</c-> <c- k>border-radius</c-><c- p>:</c-> <c- m>50</c-><c- k>%</c-><c- p>;</c-> <c- p>}</c->
  .content <c- p>{</c-> <c- k>padding</c-><c- p>:</c-> <c- m>1</c-><c- k>em</c-><c- p>;</c-> <c- p>}</c->
<c- p>}</c->
</pre>
    <p>The <span class="css">img</span> selector will only match image tags that are in a DOM fragment
		starting with any <span class="css">.media-object</span>,
		and including all descendants up to
		any intervening children of the <span class="css">.content</span> class.</p>
   </div>
   <p class="issue" id="issue-acd126a1"><a class="self-link" href="#issue-acd126a1"></a> Should scoping limits be added to the definition of <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoped-selector" id="ref-for-scoped-selector">scoped selectors</a>?</p>
   <h4 class="heading settled" data-level="2.5.1" id="scope-effects"><span class="secno">2.5.1. </span><span class="content">
Effects of <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②">@scope</a></span><a class="self-link" href="#scope-effects"></a></h4>
   <p>The <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope③">@scope</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#at-rule" id="ref-for-at-rule">at-rule</a> has three primary effects
	on the <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#style-rule" id="ref-for-style-rule①">style rules</a> it contains:</p>
   <ul>
    <li data-md>
     <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#style-rule" id="ref-for-style-rule②">style rules</a> in an <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope④">@scope</a> <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-rule-list" id="ref-for-typedef-rule-list">&lt;rule-list></a>
are <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules①">scoped style rules</a>.</p>
    <li data-md>
     <p>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo">:scope</a> selector is defined to match
the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope⑤">@scope</a> rule’s <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root⑦">scoping root</a>,
including the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#featureless" id="ref-for-featureless">featureless</a> <a data-link-type="dfn" href="https://www.w3.org/TR/css-scoping-1/#shadow-host" id="ref-for-shadow-host①">shadow host</a>
when that host is the <span id="ref-for-scoping-root⑧">scoping root</span>.
The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-">&amp;</a> selector is defined to represent
the selector representing the <span id="ref-for-scoping-root⑨">scoping root</span>
(the <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start">&lt;scope-start></a> selector),
or else <span class="css" id="ref-for-scope-pseudo①">:scope</span> if no selector was specified.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#cascade" id="ref-for-cascade">cascade</a> prioritizes declarations
with a <a data-link-type="dfn" href="#scope-proximity" id="ref-for-scope-proximity">more proximate</a> <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①⓪">scoping root</a>,
regardless of specificity or order of appearance
by applying <span id="ref-for-scope-proximity①">scope proximity</span>
between the <span id="ref-for-scoping-root①①">scoping root</span> and the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector-subject" id="ref-for-selector-subject①">subject</a>
of each <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules②">scoped style rule</a>.</p>
   </ul>
   <p class="note" role="note"><span class="marker">Note:</span> Unlike <a href="https://www.w3.org/TR/css-nesting/">Nesting</a>,
	selectors within an <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope⑥">@scope</a> rule
	do not acquire the specificity of any parent selector(s) in the <span class="css" id="ref-for-at-ruledef-scope⑦">@scope</span> prelude.</p>
   <div class="example" id="example-47f85a12">
    <a class="self-link" href="#example-47f85a12"></a>
		The following selectors have the same specificity (0,0,1):

		
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->#hero<c- p>)</c-> <c- p>{</c->
  img <c- p>{</c-> <c- k>border-radius</c-><c- p>:</c-> <c- m>50</c-><c- k>%</c-><c- p>;</c-> <c- p>}</c->
<c- p>}</c->

<c- nf>:where</c-><c- p>(</c->#hero<c- p>)</c-> img <c- p>{</c-> <c- k>border-radius</c-><c- p>:</c-> <c- m>50</c-><c- k>%</c-><c- p>;</c-> <c- p>}</c->
</pre>
    <p>The additional specificity of the <span class="css">#hero</span> selector
		is not applied to the specificity of the scoped selector.
		However, since one <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element">img</a></code> selector is scoped,
		that selector is weighted more strongly in the cascade
		with the application of <a data-link-type="dfn" href="#scope-proximity" id="ref-for-scope-proximity②">scope proximity</a>.</p>
   </div>
   <div class="example" id="example-463550a5">
    <a class="self-link" href="#example-463550a5"></a>
		Many existing tools implement "scoped styles"
		by applying a unique class or attribute
		to every element in a given scope
		or "single file component."
		In this example there are two scopes
		(<code>main-component</code> and <code>sub-component</code>)
		and every element is marked as part of one or both scopes
		using the <code>data-scope</code> attribute:

		
<pre class="lang-html highlight"><c- p>&lt;</c-><c- f>section</c-> <c- e>data-scope</c-><c- o>=</c-><c- s>"main-component"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-> <c- e>data-scope</c-><c- o>=</c-><c- s>"main-component"</c-><c- p>></c->...<c- p>&lt;</c-><c- f>p</c-><c- p>></c->

  <c- d>&lt;!-- sub-component root is in both scopes --></c->
  <c- p>&lt;</c-><c- f>section</c-> <c- e>data-scope</c-><c- o>=</c-><c- s>"main-component sub-component"</c-><c- p>></c->
    <c- d>&lt;!-- children are only in the inner scope --></c->
    <c- p>&lt;</c-><c- f>p</c-> <c- e>data-scope</c-><c- o>=</c-><c- s>"sub-component"</c-><c- p>></c->...<c- p>&lt;</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>section</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>section</c-><c- p>></c->
</pre>
    <p>Those custom scope attributes are then
		appended to every single selector in CSS:</p>
<pre class="highlight">p<c- p>[</c->data-scope~=<c- s>'main-component'</c-><c- p>]</c-> <c- p>{</c-> <c- k>color</c-><c- p>:</c-> red<c- p>;</c-> <c- p>}</c->
p<c- p>[</c->data-scope~=<c- s>'sub-component'</c-><c- p>]</c-> <c- p>{</c-> <c- k>color</c-><c- p>:</c-> blue<c- p>;</c-> <c- p>}</c->

<c- c>/* both sections are part of the outer scope */</c->
section<c- p>[</c->data-scope~=<c- s>'main-component'</c-><c- p>]</c-> <c- p>{</c-> <c- k>background</c-><c- p>:</c-> snow<c- p>;</c-> <c- p>}</c->

<c- c>/* the inner section is also part of the inner scope */</c->
section<c- p>[</c->data-scope~=<c- s>'sub-component'</c-><c- p>]</c-> <c- p>{</c-> <c- k>color</c-><c- p>:</c-> ghostwhite<c- p>;</c-> <c- p>}</c->
</pre>
    <p>Using the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope⑧">@scope</a> rule,
		authors and tools can replicate similar behavior
		with the unique attribute or class
		applied only to the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①②">scoping roots</a>:</p>
<pre class="lang-html highlight"><c- p>&lt;</c-><c- f>section</c-> <c- e>data-scope</c-><c- o>=</c-><c- s>"main-component"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->...<c- p>&lt;</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>section</c-> <c- e>data-scope</c-><c- o>=</c-><c- s>"sub-component"</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>p</c-><c- p>></c->...<c- p>&lt;</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>section</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>section</c-><c- p>></c->
</pre>
    <p>Then the class or attribute can be used
		for establishing both upper and lower boundaries.
		Elements matched by a lower boundary selector
		are excluded from the resulting scope,
		which allows authors to create non-overlapping scopes by default:</p>
<pre class="highlight"><c- n>@scope</c-> <c- p>([</c->data-scope=<c- s>'main-component'</c-><c- p>])</c-> to <c- p>([</c->data-scope<c- p>])</c-> <c- p>{</c->
  p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> red<c- p>;</c-> <c- p>}</c->

  <c- c>/* only the outer section is part of the outer scope */</c->
  section <c- p>{</c-> <c- k>background</c-><c- p>:</c-> snow<c- p>;</c-> <c- p>}</c->
<c- p>}</c->

<c- n>@scope</c-> <c- p>([</c->data-scope=<c- s>'sub-component'</c-><c- p>])</c-> to <c- p>([</c->data-scope<c- p>])</c-> <c- p>{</c->
  p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> blue<c- p>;</c-> <c- p>}</c->

  <c- c>/* the inner section is only part of the inner scope */</c->
  section <c- p>{</c-> <c- k>color</c-><c- p>:</c-> ghostwhite<c- p>;</c-> <c- p>}</c->
<c- p>}</c->
</pre>
    <p>However, authors can use the child combinator
		and universal selector to create scope boundaries that overlap,
		such that the inner scope root is part of both scopes:</p>
<pre class="highlight"><c- n>@scope</c-> <c- p>([</c->data-scope=<c- s>'main-component'</c-><c- p>])</c-> to <c- p>([</c->data-scope<c- p>]</c-> > *<c- p>)</c-> <c- p>{</c->
  p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> red<c- p>;</c-> <c- p>}</c->

  <c- c>/* both sections are part of the outer scope */</c->
  section <c- p>{</c-> <c- k>background</c-><c- p>:</c-> snow<c- p>;</c-> <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h4 class="heading settled" data-level="2.5.2" id="scope-syntax"><span class="secno">2.5.2. </span><span class="content">
Syntax of <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope⑨">@scope</a></span><a class="self-link" href="#scope-syntax"></a></h4>
   <p>The syntax of the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope①⓪">@scope</a> rule is:</p>
<pre class="def prod">@scope [(<a class="production" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start①">&lt;scope-start></a>)]<a data-link-type="grammar" href="https://drafts.csswg.org/css-values-3/#mult-opt" id="ref-for-mult-opt">?</a> [to (<a class="production" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end">&lt;scope-end></a>)]<a data-link-type="grammar" href="https://drafts.csswg.org/css-values-3/#mult-opt" id="ref-for-mult-opt①">?</a> {
  <a class="production" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-block-contents" id="ref-for-typedef-block-contents">&lt;block-contents></a>
}
</pre>
   <p>where:</p>
   <ul>
    <li data-md>
     <p><dfn class="dfn-paneled css" data-dfn-type="type" data-export id="typedef-scope-start"><a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start②">&lt;scope-start></a></dfn> is a <a class="production css" data-link-type="type" href="https://drafts.csswg.org/selectors-4/#typedef-selector-list" id="ref-for-typedef-selector-list">&lt;selector-list></a> <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector" id="ref-for-selector">selector</a>
used to identify the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①③">scoping root</a>(s).</p>
    <li data-md>
     <p><dfn class="dfn-paneled css" data-dfn-type="type" data-export id="typedef-scope-end"><a class="production css" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end①">&lt;scope-end></a></dfn> is a <a class="production css" data-link-type="type" href="https://drafts.csswg.org/selectors-4/#typedef-selector-list" id="ref-for-typedef-selector-list①">&lt;selector-list></a> <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector" id="ref-for-selector①">selector</a>
used to identify any <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit④">scoping limits</a>.</p>
    <li data-md>
     <p>the <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#qualified-rule" id="ref-for-qualified-rule">qualified rules</a> within <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-block-contents" id="ref-for-typedef-block-contents①">&lt;block-contents></a>,
as well as any <a data-link-type="dfn" href="https://drafts.csswg.org/css-nesting-1/#nested-declarations-rule%E2%91%A0" id="ref-for-nested-declarations-rule%E2%91%A0">nested declarations rules</a>
produced by <a href="#scoped-declarations">scoped declarations</a>,
represents the <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules③">scoped style rules</a>.</p>
   </ul>
   <p><a data-link-type="dfn" href="https://www.w3.org/TR/CSS2/selector.html#x22" id="ref-for-x22">Pseudo-elements</a> cannot be <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①④">scoping roots</a> or <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit⑤">scoping limits</a>;
	they are invalid both within <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start③">&lt;scope-start></a> and <a class="production css" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end②">&lt;scope-end></a>.</p>
   <h4 class="heading settled" data-level="2.5.3" id="scoped-rules"><span class="secno">2.5.3. </span><span class="content">
Scoped Style Rules</span><a class="self-link" href="#scoped-rules"></a></h4>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scoped-style-rules">Scoped style rules</dfn> differ from non-scoped rules
	in the following ways:</p>
   <ul>
    <li data-md>
     <p>Their selectors can only match elements that are <a data-link-type="dfn" href="#in-scope" id="ref-for-in-scope①">in scope</a>.
(This only applies to the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector-subject" id="ref-for-selector-subject②">subject</a>;
the rest of the selector can match unrestricted.)</p>
    <li data-md>
     <p>They accept a <a class="production css" data-link-type="type" href="https://drafts.csswg.org/selectors-4/#typedef-relative-selector-list" id="ref-for-typedef-relative-selector-list">&lt;relative-selector-list></a> as their prelude
(rather than just a <a class="production css" data-link-type="type" href="https://drafts.csswg.org/selectors-4/#typedef-selector-list" id="ref-for-typedef-selector-list②">&lt;selector-list></a>).
Such <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#relative-selector" id="ref-for-relative-selector">relative selectors</a>
are relative to <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo②">:scope</a>.</p>
    <li data-md>
     <p>Any selector in the <a class="production css" data-link-type="type" href="https://drafts.csswg.org/selectors-4/#typedef-relative-selector-list" id="ref-for-typedef-relative-selector-list①">&lt;relative-selector-list></a>
that does not start with a <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector-combinator" id="ref-for-selector-combinator">combinator</a>
but does <a data-link-type="dfn" href="https://drafts.csswg.org/css-nesting-1/#contain-the-nesting-selector" id="ref-for-contain-the-nesting-selector">contain the nesting selector</a> or the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo③">:scope</a> selector,
is interpreted as a non-<a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#relative-selector" id="ref-for-relative-selector①">relative selector</a>
(but the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector-subject" id="ref-for-selector-subject③">subject</a> must still be <a data-link-type="dfn" href="#in-scope" id="ref-for-in-scope②">in scope</a> to match).</p>
   </ul>
   <div class="example" id="example-66991251">
    <a class="self-link" href="#example-66991251"></a>
		By default, selectors in a <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules④">scoped style rule</a>
		are <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#relative-selector" id="ref-for-relative-selector②">relative selectors</a>,
		with the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①⑤">scoping root</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#descendant-combinator" id="ref-for-descendant-combinator">descendant combinator</a>
		implied at the start.
		The following selectors will match the same elements:

		
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->#my-component<c- p>)</c-> <c- p>{</c->
  p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> green<c- p>;</c-> <c- p>}</c->
  :scope p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> green<c- p>;</c-> <c- p>}</c->
<c- p>}</c->
</pre>
    <p>Authors can adjust the implied relationship
		by adding an explicit combinator:</p>
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->#my-component<c- p>)</c-> <c- p>{</c->
  > p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> green<c- p>;</c-> <c- p>}</c->
  :scope > p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> green<c- p>;</c-> <c- p>}</c->
<c- p>}</c->
</pre>
    <p>Authors can also target or explicitly position
		the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①⑥">scoping root</a> in a selector
		by including either <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo④">:scope</a> or <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-①">&amp;</a> in a given selector:</p>
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->#my-component<c- p>)</c-> <c- p>{</c->
  :scope <c- p>{</c-> <c- k>border</c-><c- p>:</c-> thin solid<c- p>;</c-> <c- p>}</c->
  &amp; <c- p>{</c-> <c- k>border</c-><c- p>:</c-> thin solid<c- p>;</c-> <c- p>}</c->

  main :scope p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> green<c- p>;</c-> <c- p>}</c->
  main &amp; p <c- p>{</c-> <c- k>color</c-><c- p>:</c-> green<c- p>;</c-> <c- p>}</c->
<c- p>}</c->
</pre>
    <p>While the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo⑤">:scope</a> or <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-②">&amp;</a> selectors
		can both refer to the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①⑦">scoping root</a>,
		they have otherwise different meanings in this context:</p>
    <dl>
     <dt data-md>Differences in selector matching
     <dd data-md>
      <p>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo⑥">:scope</a> selector will only match the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①⑧">scoping root</a> itself,
while the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-③">&amp;</a> selector is able to match any element
that is matched by the <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start④">&lt;scope-start></a> selector list.</p>
     <dt data-md>Differences in selector specificity
     <dd data-md>
      <p>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo⑦">:scope</a> selector has a specificity
equal to other pseudo-classes,
while the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-④">&amp;</a> selector has the specificity
equal to the most specific selector in <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start⑤">&lt;scope-start></a>.</p>
    </dl>
   </div>
   <h4 class="heading settled" data-level="2.5.4" id="scope-limits"><span class="secno">2.5.4. </span><span class="content">
Identifying Scoping Roots and Limits</span><a class="self-link" href="#scope-limits"></a></h4>
   <p>A <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope①①">@scope</a> rule produces one or more <a data-link-type="dfn" href="#scope" id="ref-for-scope②">scopes</a> as follows:</p>
   <dl>
    <dt data-md>Finding the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root①⑨">scoping root</a>(s)
    <dd data-md>
     <p>For each element matched by <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start⑥">&lt;scope-start></a>,
create a <a data-link-type="dfn" href="#scope" id="ref-for-scope③">scope</a> using that element as the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root②⓪">scoping root</a>.
If no <span class="production" id="ref-for-typedef-scope-start⑦">&lt;scope-start></span> is specified,
the <span id="ref-for-scoping-root②①">scoping root</span> is the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#parent-element" id="ref-for-parent-element">parent element</a> of the <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node" id="ref-for-cssstyledeclaration-owner-node">owner node</a>
of the stylesheet where the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope①②">@scope</a> rule is defined.
(If no such element exists
and the containing <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-tree" id="ref-for-concept-node-tree">node tree</a> is a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-shadow-tree" id="ref-for-concept-shadow-tree②">shadow tree</a>,
then the <span id="ref-for-scoping-root②②">scoping root</span> is the <a data-link-type="dfn" href="https://www.w3.org/TR/css-scoping-1/#shadow-host" id="ref-for-shadow-host②">shadow host</a>.
Otherwise,
the <span id="ref-for-scoping-root②③">scoping root</span> is the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-root" id="ref-for-concept-tree-root">root</a> of the containing <span id="ref-for-concept-node-tree①">node tree</span>.)
Any <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo⑧">:scope</a> or <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-⑤">&amp;</a> selectors in <span class="production" id="ref-for-typedef-scope-start⑧">&lt;scope-start></span>
are interpreted as defined for its outer context.</p>
    <dt data-md>Finding any <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit⑥">scoping limits</a>
    <dd data-md>
     <p>For each <a data-link-type="dfn" href="#scope" id="ref-for-scope④">scope</a> created by a <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root②④">scoping root</a>,
its <a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit⑦">scoping limits</a> are set to all elements
that are <a data-link-type="dfn" href="#in-scope" id="ref-for-in-scope③">in scope</a> and that match <a class="production css" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end③">&lt;scope-end></a>,
interpreting <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo⑨">:scope</a> and <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-⑥">&amp;</a>
exactly as in <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules⑤">scoped style rules</a>.</p>
   </dl>
   <div class="example" id="example-52419898">
    <a class="self-link" href="#example-52419898"></a>
		Authors can establish local scoping
		for <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element">style</a></code> elements by leaving out the <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start⑨">&lt;scope-start></a> selector.
		For example:

		
<pre class="lang-html highlight"><c- p>&lt;</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>style</c-><c- p>></c->
    <c- p>@</c-><c- k>scope</c-> <c- p>{</c->
      <c- f>p</c-> <c- p>{</c-> <c- k>color</c-><c- p>:</c-> <c- kc>red</c-><c- p>;</c-> <c- p>}</c->
    <c- p>}</c->
  <c- p>&lt;/</c-><c- f>style</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->this is red<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
<c- p>&lt;</c-><c- f>p</c-><c- p>></c->not red<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
</pre>
    <p>That would be equivalent to:</p>
<pre class="lang-html highlight"><c- p>&lt;</c-><c- f>div</c-> <c- e>id</c-><c- o>=</c-><c- s>"foo"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>style</c-><c- p>></c->
    <c- p>@</c-><c- k>scope</c-> <c- o>(</c-><c- p>#</c-><c- nn>foo</c-><c- o>)</c-> <c- p>{</c->
      <c- f>p</c-> <c- p>{</c-> <c- k>color</c-><c- p>:</c-> <c- kc>red</c-><c- p>;</c-> <c- p>}</c->
    <c- p>}</c->
  <c- p>&lt;/</c-><c- f>style</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->this is red<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
<c- p>&lt;</c-><c- f>p</c-><c- p>></c->not red<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
</pre>
   </div>
   <div class="example" id="example-132cb7e9">
    <a class="self-link" href="#example-132cb7e9"></a>
		<a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit⑧">Scoping limits</a> can use the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo①⓪">:scope</a> pseudo-class
		to require a specific relationship to the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root②⑤">scoping root</a>:

		
<pre class="highlight"><c- c>/* .content is only a limit when it is a direct child of the :scope */</c->
<c- n>@scope</c-> <c- p>(</c->.media-object<c- p>)</c-> to <c- p>(</c->:scope > .content<c- p>)</c-> <c- p>{</c-> ... <c- p>}</c->
</pre>
    <p><a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit⑨">Scoping limits</a> can also reference elements outside their <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root②⑥">scoping root</a>
		by using <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo①①">:scope</a>.
		For example:</p>
<pre class="highlight"><c- c>/* .content is only a limit when the :scope is inside .sidebar */</c->
<c- n>@scope</c-> <c- p>(</c->.media-object<c- p>)</c-> to <c- p>(</c->.sidebar :scope .content<c- p>)</c-> <c- p>{</c-> ... <c- p>}</c->
</pre>
   </div>
   <h4 class="heading settled" data-level="2.5.5" id="scope-scope"><span class="secno">2.5.5. </span><span class="content">
Scope Nesting</span><a class="self-link" href="#scope-scope"></a></h4>
   <p><a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope①③">@scope</a> rules can be nested.
	In this case, just as with the nested style rules,
	the prelude selectors of the inner <span class="css" id="ref-for-at-ruledef-scope①④">@scope</span>
	(those defining its <a data-link-type="dfn" href="#scope" id="ref-for-scope⑤">scope</a>)
	are <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoped-selector" id="ref-for-scoped-selector①">scoped by</a>
	the selectors of the outer one.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The resulting <a data-link-type="dfn" href="#scope" id="ref-for-scope⑥">scope</a>
	for further nested <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules⑥">scoped style rules</a>
	is practically constrained by both
	the outer and inner <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope①⑤">@scope</a> rules,
	but the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root②⑦">scoping root</a> is defined
	by the innermost <span class="css" id="ref-for-at-ruledef-scope①⑥">@scope</span>.
	Since <a data-link-type="dfn" href="#scope-proximity" id="ref-for-scope-proximity③">scope proximity</a> is measured
	between a <span id="ref-for-scoped-style-rules⑦">scoped style rule</span> <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector-subject" id="ref-for-selector-subject④">subject</a>
	and <span id="ref-for-scoping-root②⑧">scoping root</span>,
	only the innermost <span class="css" id="ref-for-at-ruledef-scope①⑦">@scope</span> matters
	for determining <span id="ref-for-scope-proximity④">scope proximity</span> of <a href="#scope-scope">nested @scope rules</a>.</p>
   <p class="issue" id="issue-a2203bb7"><a class="self-link" href="#issue-a2203bb7"></a> Should the scope proximity calculation be impacted by nesting scopes? <a href="https://github.com/w3c/csswg-drafts/issues/10795">[Issue #10795]</a></p>
   <div class="example" id="example-49f2905a">
    <a class="self-link" href="#example-49f2905a"></a>
		When nesting <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope①⑧">@scope</a> rules inside other <span class="css" id="ref-for-at-ruledef-scope①⑨">@scope</span> rules,
		or inside other selectors,
		the <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start①⓪">&lt;scope-start></a> selector is
		<a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#relative-selector" id="ref-for-relative-selector③">relative to</a> the nesting context,
		while the <a class="production css" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end④">&lt;scope-end></a> and any <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules⑧">scoped style rules</a>
		are <span id="ref-for-relative-selector④">relative to</span> the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root②⑨">scoping root</a>
		For example, the following code:

		
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->.parent-scope<c- p>)</c-> <c- p>{</c->
  <c- n>@scope</c-> <c- p>(</c->:scope > .child-scope<c- p>)</c-> to <c- p>(</c->:scope .limit<c- p>)</c-> <c- p>{</c->
    :scope .content <c- p>{</c->
      <c- k>color</c-><c- p>:</c-> red<c- p>;</c->
    <c- p>}</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>is equivalent to:</p>
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->.parent-scope > .child-scope<c- p>)</c-> to <c- p>(</c->.parent-scope > .child-scope .limit<c- p>)</c-> <c- p>{</c->
  .parent-scope > .child-scope .content <c- p>{</c->
    <c- k>color</c-><c- p>:</c-> red<c- p>;</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <p>Global name-defining <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#at-rule" id="ref-for-at-rule①">at-rules</a>
	such as <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes" id="ref-for-at-ruledef-keyframes">@keyframes</a> or <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-fonts-5/#at-font-face-rule" id="ref-for-at-font-face-rule">@font-face</a> or <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#at-ruledef-layer" id="ref-for-at-ruledef-layer">@layer</a>
	that are defined inside <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②⓪">@scope</a> are valid,
	but are not scoped or otherwise affected
	by the enclosing <span class="css" id="ref-for-at-ruledef-scope②①">@scope</span> rule.
	However, any <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#style-rule" id="ref-for-style-rule③">style rules</a> contained by such rules
	(e.g. within <span class="css" id="ref-for-at-ruledef-layer①">@layer</span>)
	are <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules⑨">scoped</a>.</p>
   <h4 class="heading settled" data-level="2.5.6" id="scoped-declarations"><span class="secno">2.5.6. </span><span class="content">
Scoped Declarations </span><a class="self-link" href="#scoped-declarations"></a></h4>
   <p><a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations④">Declarations</a> may be used directly
	with the body of a <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②②">@scope</a> rule.
	Contiguous runs of <span id="ref-for-cssstyledeclaration-declarations⑤">declarations</span>
	are wrapped in <a data-link-type="dfn" href="https://drafts.csswg.org/css-nesting-1/#nested-declarations-rule%E2%91%A0" id="ref-for-nested-declarations-rule%E2%91%A0①">nested declarations rules</a>,
	which match the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root③⓪">scoping root</a>
	with zero <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#specificity" id="ref-for-specificity">specificity</a>.</p>
   <div class="example" id="example-10a88995">
    <a class="self-link" href="#example-10a88995"></a>
		
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->.foo<c- p>)</c-> <c- p>{</c->
  <c- k>border</c-><c- p>:</c-> <c- m>1</c-><c- k>px</c-> solid black<c- p>;</c->
<c- p>}</c->
</pre>
    <p>is equivalent to:</p>
<pre class="highlight"><c- n>@scope</c-> <c- p>(</c->.foo<c- p>)</c-> <c- p>{</c->
  <c- nf>:where</c-><c- p>(</c->:scope<c- p>)</c-> <c- p>{</c->
    <c- k>border</c-><c- p>:</c-> <c- m>1</c-><c- k>px</c-> solid black<c- p>;</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <p>Just like for <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#style-rule" id="ref-for-style-rule④">style rules</a>,
	<a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations⑥">declarations</a> and child <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#css-rule" id="ref-for-css-rule">rules</a>
	may be <a href="https://drafts.csswg.org/css-nesting-1/#mixing">mixed</a>
	within <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②③">@scope</a>.</p>
   <h3 class="heading settled" data-level="2.6" id="preshint"><span class="secno">2.6. </span><span class="content">
Precedence of Non-CSS Presentational Hints</span><a class="self-link" href="#preshint"></a></h3>
   <p class="issue" id="issue-d41d8cd9④"><a class="self-link" href="#issue-d41d8cd9④"></a> <a href="https://drafts.csswg.org/css-cascade-5/#layering"><cite>CSS Cascading 5</cite> § 6.4 Cascade Layers</a></p>
   <h2 class="heading settled" data-level="3" id="cssom"><span class="secno">3. </span><span class="content">CSSOM</span><a class="self-link" href="#cssom"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="the-cssscoperule-interface"><span class="secno">3.1. </span><span class="content">
The <code>CSSScopeRule</code> interface</span><a class="self-link" href="#the-cssscoperule-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#cssscoperule" id="ref-for-cssscoperule">CSSScopeRule</a></code> interface represents the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②④">@scope</a> rule:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="cssscoperule"><code><c- g>CSSScopeRule</c-></code></dfn> : <a data-link-type="idl-name" href="https://drafts.csswg.org/cssom-1/#cssgroupingrule" id="ref-for-cssgroupingrule"><c- n>CSSGroupingRule</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.csswg.org/cssom-1/#cssomstring" id="ref-for-cssomstring"><c- n>CSSOMString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSSScopeRule" data-dfn-type="attribute" data-export data-readonly data-type="CSSOMString?" id="dom-cssscoperule-start"><code><c- g>start</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.csswg.org/cssom-1/#cssomstring" id="ref-for-cssomstring①"><c- n>CSSOMString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSSScopeRule" data-dfn-type="attribute" data-export data-readonly data-type="CSSOMString?" id="dom-cssscoperule-end"><code><c- g>end</c-></code></dfn>;
};
</pre>
   <dl class="idl-attributes">
    <dt><code>start</code> of type <code>CSSOMString</code>
		
    <dd>The <code>start</code> attribute
		returns the result of serializing the <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start①①">&lt;scope-start></a> of the rule
		(without the enclosing parentheses),
		or null if there is no <span class="production" id="ref-for-typedef-scope-start①②">&lt;scope-start></span>.

		
    <dt><code>end</code> of type <code>CSSOMString</code>
		
    <dd>The <code>end</code> attribute
		returns the result of serializing the <a class="production css" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end⑤">&lt;scope-end></a> of the rule
		(without the enclosing parentheses),
		or null if there is no <span class="production" id="ref-for-typedef-scope-end⑥">&lt;scope-end></span>.
	
   </dl>
   <h2 class="heading settled" data-level="4" id="changes"><span class="secno">4. </span><span class="content">
Changes</span><a class="self-link" href="#changes"></a></h2>
   <p>This appendix is <em>informative</em>.</p>
   <h3 class="heading settled" data-level="4.1" id="changes-since-2023-03"><span class="secno">4.1. </span><span class="content">
Changes since the 21 March 2023 Working Draft</span><a class="self-link" href="#changes-since-2023-03"></a></h3>
   <p>Significant changes since the
	<a href="https://www.w3.org/TR/2023/WD-css-cascade-6-20230321/">21 March 2023 Working Draft</a> include:</p>
   <ul>
    <li data-md>
     <p>Allowed <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations⑦">declarations</a> directly within <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②⑤">@scope</a>.
(<a href="https://github.com/w3c/csswg-drafts/issues/10389">Issue 10389</a>)</p>
    <li data-md>
     <p>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo①②">:scope</a> selector can match the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#featureless" id="ref-for-featureless①">featureless</a> <a data-link-type="dfn" href="https://www.w3.org/TR/css-scoping-1/#shadow-host" id="ref-for-shadow-host③">shadow host</a> when
that host is the <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root③①">scoping root</a> element.
(<a href="https://github.com/w3c/csswg-drafts/issues/9025">Issue 9025</a>)</p>
    <li data-md>
     <p><span class="css"><a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start①③">&lt;scope-start></a></span> and <span class="css"><a class="production css" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end⑦">&lt;scope-end></a></span> selectors are unforgiving.
(<a href="https://github.com/w3c/csswg-drafts/issues/10042">Issue 10042</a>)</p>
    <li data-md>
     <p>A <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②⑥">@scope</a> rule without <span class="css"><a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start①④">&lt;scope-start></a></span> scopes to the
<a data-link-type="dfn" href="https://www.w3.org/TR/css-scoping-1/#shadow-host" id="ref-for-shadow-host④">shadow host</a> instead of the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-shadow-root" id="ref-for-concept-shadow-root">shadow root</a>.
(<a href="https://github.com/w3c/csswg-drafts/issues/9178">Issue 9178</a>)</p>
    <li data-md>
     <p>Clarified that <a data-link-type="dfn" href="#scope-proximity" id="ref-for-scope-proximity⑤">scope proximity</a> is a single measurement of the steps
between a single <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoping-root" id="ref-for-scoping-root③②">scoping root</a> and <a data-link-type="dfn" href="#scoped-style-rules" id="ref-for-scoped-style-rules①⓪">scoped style rule</a> <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#selector-subject" id="ref-for-selector-subject⑤">subject</a>
(<a href="https://github.com/w3c/csswg-drafts/issues/10795">Issue 10795</a>
has been opened to discuss this futher).</p>
    <li data-md>
     <p>Removed strong scope proximity.
(<a href="https://github.com/w3c/csswg-drafts/issues/6790">Issue 6790</a>)</p>
    <li data-md>
     <p>Removed the scoped descendant combinator (deferred).
(<a href="https://github.com/w3c/csswg-drafts/issues/8628">Issue 8628</a>)</p>
    <li data-md>
     <p>Added the <code class="idl"><a data-link-type="idl" href="#cssscoperule" id="ref-for-cssscoperule①">CSSScopeRule</a></code> interface.
(<a href="https://github.com/w3c/csswg-drafts/issues/8626">Issue 8626</a>)</p>
   </ul>
   <h3 class="heading settled" data-level="4.2" id="changes-2022-08"><span class="secno">4.2. </span><span class="content">
Changes since the 21 December 2021 First Public Working Draft</span><a class="self-link" href="#changes-2022-08"></a></h3>
   <p>Significant changes since the
	<a href="https://www.w3.org/TR/2021/WD-css-cascade-6-20211221/">21 December 2021 First Public Working Draft</a> include:</p>
   <ul>
    <li data-md>
     <p>Clarified <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②⑦">@scope</a> effects on nested <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/selectors-4/#scope-pseudo" id="ref-for-scope-pseudo①③">:scope</a> and <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-nesting-1/#selectordef-" id="ref-for-selectordef-⑦">&amp;</a> selectors.
(<a href="https://github.com/w3c/csswg-drafts/issues/8377">Issue 8377</a>)</p>
    <li data-md>
     <p>Removed <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②⑧">@scope</a> prelude from specificity calculation.
(<a href="https://github.com/w3c/csswg-drafts/issues/8500">Issue 8500</a>)</p>
    <li data-md>
     <p>Specified how name-defining <a data-link-type="dfn" href="https://drafts.csswg.org/css-syntax-3/#at-rule" id="ref-for-at-rule②">at-rules</a> behave in <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope②⑨">@scope</a>.
(<a href="https://github.com/w3c/csswg-drafts/issues/6895">Issue 6895</a>)</p>
    <li data-md>
     <p>Added implicit scopes by making <span class="css"><a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start①⑤">&lt;scope-start></a></span> optional.
(<a href="https://github.com/w3c/csswg-drafts/issues/6606">Issue 6606</a>)</p>
    <li data-md>
     <p>Disallowed <a data-link-type="dfn" href="https://www.w3.org/TR/CSS2/selector.html#x22" id="ref-for-x22①">pseudo-elements</a> in the <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope③⓪">@scope</a> prelude.
(<a href="https://github.com/w3c/csswg-drafts/issues/7382">Issue 7382</a>)</p>
    <li data-md>
     <p>Removed selector scoping notation.
(<a href="https://github.com/w3c/csswg-drafts/issues/7709">Issue 7709</a>)</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#scoping-limit" id="ref-for-scoping-limit①⓪">Scoping limit</a> elements are excluded from the resulting <a data-link-type="dfn" href="#scope" id="ref-for-scope⑦">scope</a>.
(<a href="https://github.com/w3c/csswg-drafts/issues/6577">Issue 6577</a>)</p>
   </ul>
   <h3 class="heading settled" data-level="4.3" id="additions-l5"><span class="secno">4.3. </span><span class="content">
Additions Since Level 5</span><a class="self-link" href="#additions-l5"></a></h3>
   <p>The following features have been added since
	<a href="https://www.w3.org/TR/css-cascade-5/">Level 5</a>:</p>
   <ul>
    <li data-md>
     <p>The definition of a <a data-link-type="dfn" href="#scope" id="ref-for-scope⑧">scope</a>,
as described by a combination of <a class="production css" data-link-type="type" href="#typedef-scope-start" id="ref-for-typedef-scope-start①⑥">&lt;scope-start></a> and <a class="production css" data-link-type="type" href="#typedef-scope-end" id="ref-for-typedef-scope-end⑧">&lt;scope-end></a> selectors.</p>
    <li data-md>
     <p>The in-scope (<span class="css">:in()</span>) pseudo-class for selecting with lower-boundaries</p>
    <li data-md>
     <p>The <a class="css" data-link-type="maybe" href="#at-ruledef-scope" id="ref-for-at-ruledef-scope③①">@scope</a> rule for creating scoped stylesheets</p>
    <li data-md>
     <p>The definition of <a data-link-type="dfn" href="#scope-proximity" id="ref-for-scope-proximity⑥">scope proximity</a> in the cascade</p>
   </ul>
   <h3 class="heading settled" data-level="4.4" id="additions-l4"><span class="secno">4.4. </span><span class="content">
Additions Since Level 4</span><a class="self-link" href="#additions-l4"></a></h3>
   <p>The following features have been added since
	<a href="https://www.w3.org/TR/css-cascade-4/">Level 4</a>:</p>
   <ul>
    <li data-md>
     <p>Added <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#cascade-layers" id="ref-for-cascade-layers③">cascade layers</a> to the <a data-link-type="dfn" href="#cascade" id="ref-for-cascade①">cascade</a> sort criteria
(and defined style attributes as a distinct step of the <span id="ref-for-cascade②">cascade</span> sort criteria
so that they interact appropriately).</p>
    <li data-md>
     <p>Introduced the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#at-ruledef-layer" id="ref-for-at-ruledef-layer②">@layer</a> rule for defining cascade layers.</p>
    <li data-md>
     <p>Added <span class="css">layer</span>/<span class="css">layer()</span> option to <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#at-ruledef-import" id="ref-for-at-ruledef-import②">@import</a> definition.</p>
    <li data-md>
     <p>Introduced the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#valdef-all-revert-layer" id="ref-for-valdef-all-revert-layer">revert-layer</a> keyword for rolling back values to previous layers.</p>
   </ul>
   <h3 class="heading settled" data-level="4.5" id="additions-l3"><span class="secno">4.5. </span><span class="content">
Additions Since Level 3</span><a class="self-link" href="#additions-l3"></a></h3>
   <p>The following features have been added since
	<a href="https://www.w3.org/TR/css-cascade-3/">Level 3</a>:</p>
   <ul>
    <li data-md>
     <p>Introduced <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#valdef-all-revert" id="ref-for-valdef-all-revert">revert</a> keyword, for rolling back the cascade.</p>
    <li data-md>
     <p>Introduced <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-conditional-5/#funcdef-supports" id="ref-for-funcdef-supports">supports()</a> syntax for supports-conditional <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#at-ruledef-import" id="ref-for-at-ruledef-import③">@import</a> rules.</p>
    <li data-md>
     <p>Added <a data-link-type="dfn" href="#encapsulation-contexts" id="ref-for-encapsulation-contexts④">encapsulation context</a> to the <a data-link-type="dfn" href="#cascade" id="ref-for-cascade③">cascade</a> sort criteria
to accommodate Shadow DOM. <a data-link-type="biblio" href="#biblio-dom" title="DOM Standard">[DOM]</a></p>
    <li data-md>
     <p>Defined the property two aliasing mechanisms CSS uses to support legacy syntaxes. See <a href="https://drafts.csswg.org/css-cascade-4/#aliasing"><cite>CSS Cascading 4</cite> § 3.1 Property Aliasing</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="4.6" id="changes-2"><span class="secno">4.6. </span><span class="content">
Additions Since Level 2</span><a class="self-link" href="#changes-2"></a></h3>
   <p>The following features have been added since
	<a href="http://www.w3.org/TR/CSS2/cascade.html">Level 2</a>:</p>
   <ul>
    <li>The <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-cascade-5/#propdef-all" id="ref-for-propdef-all">all</a> shorthand
		
    <li>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#valdef-all-initial" id="ref-for-valdef-all-initial">initial</a> keyword
		
    <li>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#valdef-all-unset" id="ref-for-valdef-all-unset">unset</a> keyword
		
    <li>Incorporation of animations and transitions into the <a data-link-type="dfn" href="#cascade" id="ref-for-cascade④">cascade</a>.
	
   </ul>
   <h2 class="no-num heading settled" id="acknowledgments"><span class="content">Acknowledgments</span><a class="self-link" href="#acknowledgments"></a></h2>
   <p>David Baron,
	Tantek Çelik,
	Keith Grant,
	Giuseppe Gurgone,
	Theresa O’Connor,
	Florian Rivoal,
	Noam Rosenthal,
	Simon Sapin,
	Jen Simmons,
	Nicole Sullivan,
	Lea Verou,
	and Boris Zbarsky
	contributed to this specification.</p>
   <h2 class="heading settled" data-level="5" id="privacy"><span class="secno">5. </span><span class="content">
Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
   <ul>
    <li data-md>
     <p>User preferences and UA defaults expressed via application of style rules
are exposed by the cascade process,
and can be inferred from the computed styles they apply to a document.</p>
   </ul>
   <h2 class="heading settled" data-level="6" id="security"><span class="secno">6. </span><span class="content">
Security Considerations</span><a class="self-link" href="#security"></a></h2>
   <ul>
    <li data-md>
     <p>The cascade process does not distinguish between same-origin and cross-origin stylesheets,
enabling the content of cross-origin stylesheets to be inferred
from the computed styles they apply to a document.</p>
    <li data-md>
     <p>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#at-ruledef-import" id="ref-for-at-ruledef-import④">@import</a> rule does not apply the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#cors-protocol" id="ref-for-cors-protocol">CORS protocol</a> to loading cross-origin stylesheets,
instead allowing them to be freely imported and applied.</p>
    <li data-md>
     <p>The <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#at-ruledef-import" id="ref-for-at-ruledef-import⑤">@import</a> rule assumes that resources without <a href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#content-type"><code>Content-Type</code> metadata</a>
(or any same-origin file if the host document is in quirks mode)
are <code>text/css</code>,
potentially allowing arbitrary files to be imported into the page
and interpreted as CSS,
potentially allowing sensitive data to be inferred from the computed styles they apply to a document.</p>
   </ul>
  </main>
  <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">
Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
  <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content">
Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    </p>
  <div class="example" id="w3c-example">
   <a class="self-link" href="#w3c-example"></a>
        
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <p>Advisements are normative sections styled to evoke special attention and are
    set apart from other normative text with <code>&lt;strong class="advisement"></code>, like
    this:

    <strong class="advisement">
        UAs MUST provide an accessible alternative.
    </strong></p>
  <details class="wpt-tests-block" dir="ltr" lang="en" open>
   <summary>Tests</summary>
   <p>Tests relating to the content of this specification
                     may be documented in “Tests” blocks like this one.
                     Any such block is non-normative.</p>
   <ul class="wpt-tests-list"></ul>
   <hr>
  </details>
  <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content">
Conformance classes</span><a class="self-link" href="#w3c-conformance-classes"></a></h3>
  <p>Conformance to this specification
    is defined for three conformance classes:
    </p>
  <dl>
   <dt>style sheet
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
            style sheet</a>.
        
   <dt>renderer
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
            that interprets the semantics of a style sheet and renders
            documents that use them.
        
   <dt>authoring tool
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
            that writes a style sheet.
    
  </dl>
  <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module.

    </p>
  <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.)

    </p>
  <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module.

</p>
  <h3 class="no-ref heading settled" id="w3c-partial"><span class="content">
Partial implementations</span><a class="self-link" href="#w3c-partial"></a></h3>
  <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong>
    treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>
  <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content">
Implementations of Unstable and Proprietary Features</span><a class="self-link" href="#w3c-conform-future-proofing"></a></h4>
  <p>To avoid clashes with future stable CSS features,
        the CSSWG recommends <a href="http://www.w3.org/TR/CSS/#future-proofing">following best practices</a> for the implementation of <a href="http://www.w3.org/TR/CSS/#unstable">unstable</a> features and <a href="http://www.w3.org/TR/CSS/#proprietary-extension">proprietary extensions</a> to CSS.

</p>
  <h3 class="no-ref heading settled" id="w3c-testing"><span class="content">
Non-experimental implementations</span><a class="self-link" href="#w3c-testing"></a></h3>
  <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec.

    </p>
  <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group.

    </p>
  <p>Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at
    <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the
    <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
    mailing list.</p>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#cascade">cascade</a><span>, in § 2</span>
   <li><a href="#origin">cascade origin</a><span>, in § 2.2</span>
   <li><a href="#encapsulation-contexts">context</a><span>, in § 2.1</span>
   <li><a href="#cssscoperule">CSSScopeRule</a><span>, in § 3.1</span>
   <li><a href="#encapsulation-contexts">encapsulation contexts</a><span>, in § 2.1</span>
   <li><a href="#dom-cssscoperule-end">end</a><span>, in § 3.1</span>
   <li><a href="#important">importance</a><span>, in § 2.3</span>
   <li><a href="#important">important</a><span>, in § 2.3</span>
   <li><a href="#in-scope">in scope</a><span>, in § 2.5</span>
   <li><a href="#normal">normal</a><span>, in § 2.3</span>
   <li><a href="#origin">origin</a><span>, in § 2.2</span>
   <li><a href="#output-of-the-cascade">output of the cascade</a><span>, in § 2.1</span>
   <li><a href="#at-ruledef-scope">@scope</a><span>, in § 2.5</span>
   <li><a href="#scope">scope</a><span>, in § 2.5</span>
   <li><a href="#scoped-style-rules">Scoped style rules</a><span>, in § 2.5.3</span>
   <li><a href="#typedef-scope-end">&lt;scope-end></a><span>, in § 2.5.2</span>
   <li><a href="#scope-proximity">Scope Proximity</a><span>, in § 2.1</span>
   <li><a href="#typedef-scope-start">&lt;scope-start></a><span>, in § 2.5.2</span>
   <li><a href="#scoping-limit">scoping limit</a><span>, in § 2.5</span>
   <li><a href="#dom-cssscoperule-start">start</a><span>, in § 3.1</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS-ANIMATIONS-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="fa19c68e">@keyframes</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CASCADE-5]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="4e55d7fb">@import</span>
     <li><span class="dfn-paneled" id="94b8f87c">@layer</span>
     <li><span class="dfn-paneled" id="d95397a7">all</span>
     <li><span class="dfn-paneled" id="39e92270">author origin</span>
     <li><span class="dfn-paneled" id="4a88f201">cascade layers</span>
     <li><span class="dfn-paneled" id="c665612f">cascaded value</span>
     <li><span class="dfn-paneled" id="7c8e67c1">declared value</span>
     <li><span class="dfn-paneled" id="4d7d3dcd">initial</span>
     <li><span class="dfn-paneled" id="bef88b2d">revert</span>
     <li><span class="dfn-paneled" id="8e92a2a0">revert-layer</span>
     <li><span class="dfn-paneled" id="9e004c39">unset</span>
     <li><span class="dfn-paneled" id="621960b6">user origin</span>
     <li><span class="dfn-paneled" id="63fe4250">user-agent origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CONDITIONAL-5]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a15951ea">supports()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-FONTS-5]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0497de86">@font-face</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-NESTING-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a5ad37b5">&amp;</span>
     <li><span class="dfn-paneled" id="5140976e">contain the nesting selector</span>
     <li><span class="dfn-paneled" id="f8cc2828">nested declarations rule</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-SCOPING-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ce2e3c84">shadow host</span>
     <li><span class="dfn-paneled" id="cfd2c803">tree context</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-SYNTAX-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b845e85c">&lt;block-contents></span>
     <li><span class="dfn-paneled" id="65c9f2cf">&lt;rule-list></span>
     <li><span class="dfn-paneled" id="762610c7">at-rule</span>
     <li><span class="dfn-paneled" id="0197874e">block at-rule</span>
     <li><span class="dfn-paneled" id="dfd120f7">declaration</span>
     <li><span class="dfn-paneled" id="47948caa">qualified rule</span>
     <li><span class="dfn-paneled" id="4fcdc12a">rule</span>
     <li><span class="dfn-paneled" id="5a58bbb0">style rule</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-VALUES-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8c1eb8d0">?</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7b82c9e5">pseudo-elements</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSSOM-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2485e0d1">CSSGroupingRule</span>
     <li><span class="dfn-paneled" id="5fced98b">CSSOMString</span>
     <li><span class="dfn-paneled" id="e4ffca7f">declarations</span>
     <li><span class="dfn-paneled" id="eab73120">owner node</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f9d909f7">inclusive descendant</span>
     <li><span class="dfn-paneled" id="d462b34f">node</span>
     <li><span class="dfn-paneled" id="c7d8d91b">node tree</span>
     <li><span class="dfn-paneled" id="5afeceea">parent element</span>
     <li><span class="dfn-paneled" id="f7960529">root</span>
     <li><span class="dfn-paneled" id="3fcc582f">shadow root</span>
     <li><span class="dfn-paneled" id="19f9e9df">shadow tree</span>
     <li><span class="dfn-paneled" id="fefa5851">shadow-including tree order</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a2a30ba8">CORS protocol</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f0811ff8">img</span>
     <li><span class="dfn-paneled" id="ba920583">style</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SELECTORS-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="dc55c3d9">:scope</span>
     <li><span class="dfn-paneled" id="ea722d19">&lt;relative-selector-list></span>
     <li><span class="dfn-paneled" id="71aed09f">&lt;selector-list></span>
     <li><span class="dfn-paneled" id="f4fc17d1">combinator</span>
     <li><span class="dfn-paneled" id="5f4f98ab">descendant combinator</span>
     <li><span class="dfn-paneled" id="3a1154bf">featureless</span>
     <li><span class="dfn-paneled" id="4cd9dfd7">relative selector</span>
     <li><span class="dfn-paneled" id="3814f164">scoped selector</span>
     <li><span class="dfn-paneled" id="34c941b4">scoping root</span>
     <li><span class="dfn-paneled" id="33cbcfca">selector</span>
     <li><span class="dfn-paneled" id="bb2056aa">specificity</span>
     <li><span class="dfn-paneled" id="b894d2f3">subject</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-animations-1">[CSS-ANIMATIONS-1]
   <dd>David Baron; et al. <a href="https://drafts.csswg.org/css-animations/"><cite>CSS Animations Level 1</cite></a>. URL: <a href="https://drafts.csswg.org/css-animations/">https://drafts.csswg.org/css-animations/</a>
   <dt id="biblio-css-cascade-4">[CSS-CASCADE-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-cascade-4/"><cite>CSS Cascading and Inheritance Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-cascade-4/">https://drafts.csswg.org/css-cascade-4/</a>
   <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
   <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-cascade-5/"><cite>CSS Cascading and Inheritance Level 5</cite></a>. URL: <a href="https://drafts.csswg.org/css-cascade-5/">https://drafts.csswg.org/css-cascade-5/</a>
   <dt id="biblio-css-conditional-5">[CSS-CONDITIONAL-5]
   <dd>Chris Lilley; et al. <a href="https://drafts.csswg.org/css-conditional-5/"><cite>CSS Conditional Rules Module Level 5</cite></a>. URL: <a href="https://drafts.csswg.org/css-conditional-5/">https://drafts.csswg.org/css-conditional-5/</a>
   <dt id="biblio-css-fonts-5">[CSS-FONTS-5]
   <dd>Chris Lilley. <a href="https://drafts.csswg.org/css-fonts-5/"><cite>CSS Fonts Module Level 5</cite></a>. URL: <a href="https://drafts.csswg.org/css-fonts-5/">https://drafts.csswg.org/css-fonts-5/</a>
   <dt id="biblio-css-nesting-1">[CSS-NESTING-1]
   <dd>Tab Atkins Jr.; Adam Argyle. <a href="https://drafts.csswg.org/css-nesting/"><cite>CSS Nesting Module</cite></a>. URL: <a href="https://drafts.csswg.org/css-nesting/">https://drafts.csswg.org/css-nesting/</a>
   <dt id="biblio-css-scoping-1">[CSS-SCOPING-1]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-scoping/"><cite>CSS Scoping Module Level 1</cite></a>. URL: <a href="https://drafts.csswg.org/css-scoping/">https://drafts.csswg.org/css-scoping/</a>
   <dt id="biblio-css-syntax-3">[CSS-SYNTAX-3]
   <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://drafts.csswg.org/css-syntax/"><cite>CSS Syntax Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-syntax/">https://drafts.csswg.org/css-syntax/</a>
   <dt id="biblio-css-transitions-1">[CSS-TRANSITIONS-1]
   <dd>David Baron; et al. <a href="https://drafts.csswg.org/css-transitions/"><cite>CSS Transitions</cite></a>. URL: <a href="https://drafts.csswg.org/css-transitions/">https://drafts.csswg.org/css-transitions/</a>
   <dt id="biblio-css-values-3">[CSS-VALUES-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-values-3/"><cite>CSS Values and Units Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-values-3/">https://drafts.csswg.org/css-values-3/</a>
   <dt id="biblio-css2">[CSS2]
   <dd>Bert Bos; et al. <a href="https://drafts.csswg.org/css2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</cite></a>. URL: <a href="https://drafts.csswg.org/css2/">https://drafts.csswg.org/css2/</a>
   <dt id="biblio-cssom-1">[CSSOM-1]
   <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://drafts.csswg.org/cssom/"><cite>CSS Object Model (CSSOM)</cite></a>. URL: <a href="https://drafts.csswg.org/cssom/">https://drafts.csswg.org/cssom/</a>
   <dt id="biblio-cssstyleattr">[CSSSTYLEATTR]
   <dd>Tantek Çelik; Elika Etemad. <a href="https://drafts.csswg.org/css-style-attr/"><cite>CSS Style Attributes</cite></a>. URL: <a href="https://drafts.csswg.org/css-style-attr/">https://drafts.csswg.org/css-style-attr/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-select">[SELECT]
   <dd>Tantek Çelik; et al. <a href="https://drafts.csswg.org/selectors-3/"><cite>Selectors Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/selectors-3/">https://drafts.csswg.org/selectors-3/</a>
   <dt id="biblio-selectors-4">[SELECTORS-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://drafts.csswg.org/selectors/"><cite>Selectors Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/selectors/">https://drafts.csswg.org/selectors/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#cssscoperule"><code><c- g>CSSScopeRule</c-></code></a> : <a data-link-type="idl-name" href="https://drafts.csswg.org/cssom-1/#cssgroupingrule"><c- n>CSSGroupingRule</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.csswg.org/cssom-1/#cssomstring"><c- n>CSSOMString</c-></a>? <a data-readonly data-type="CSSOMString?" href="#dom-cssscoperule-start"><code><c- g>start</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.csswg.org/cssom-1/#cssomstring"><c- n>CSSOMString</c-></a>? <a data-readonly data-type="CSSOMString?" href="#dom-cssscoperule-end"><code><c- g>end</c-></code></a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> This is a diff spec over <a href="https://www.w3.org/TR/css-cascade-5/">CSS Cascading and Inheritance Level 5</a>.
	It is currently an Exploratory Working Draft:
	if you are implementing anything, please use Level 5 as a reference.
	We will merge the Level 5 text into this draft once it reaches CR. <a class="issue-return" href="#issue-a783701e" title="Jump to section">↵</a></div>
   <div class="issue"> <a href="https://drafts.csswg.org/css-cascade-5/#cascading-origins"><cite>CSS Cascading 5</cite> § 6.2 Cascading Origins</a> <a class="issue-return" href="#issue-d41d8cd9" title="Jump to section">↵</a></div>
   <div class="issue"> <a href="https://drafts.csswg.org/css-cascade-5/#importance"><cite>CSS Cascading 5</cite> § 6.3 Important Declarations: the !important annotation</a> <a class="issue-return" href="#issue-d41d8cd9①" title="Jump to section">↵</a></div>
   <div class="issue"> <a href="https://drafts.csswg.org/css-cascade-5/#layering"><cite>CSS Cascading 5</cite> § 6.4 Cascade Layers</a> <a class="issue-return" href="#issue-d41d8cd9②" title="Jump to section">↵</a></div>
   <div class="issue"> <a href="https://drafts.csswg.org/css-cascade-5/#layer-ordering"><cite>CSS Cascading 5</cite> § 6.4.3 Layer Ordering</a> <a class="issue-return" href="#issue-d41d8cd9③" title="Jump to section">↵</a></div>
   <div class="issue"> Should scoping limits be added to the definition of <a data-link-type="dfn" href="https://drafts.csswg.org/selectors-4/#scoped-selector">scoped selectors</a>? <a class="issue-return" href="#issue-acd126a1" title="Jump to section">↵</a></div>
   <div class="issue"> Should the scope proximity calculation be impacted by nesting scopes? <a href="https://github.com/w3c/csswg-drafts/issues/10795">[Issue #10795]</a> <a class="issue-return" href="#issue-a2203bb7" title="Jump to section">↵</a></div>
   <div class="issue"> <a href="https://drafts.csswg.org/css-cascade-5/#layering"><cite>CSS Cascading 5</cite> § 6.4 Cascade Layers</a> <a class="issue-return" href="#issue-d41d8cd9④" title="Jump to section">↵</a></div>
  </div>
  <details class="mdn-anno unpositioned" data-anno-for="all-shorthand">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/all" title="The all shorthand CSS property resets all of an element&apos;s properties except unicode-bidi, direction, and CSS Custom Properties. It can set properties to their initial or inherited values, or to the values specified in another cascade layer or stylesheet origin.">all</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>27+</span></span><span class="safari yes"><span>Safari</span><span>9.1+</span></span><span class="chrome yes"><span>Chrome</span><span>37+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="inherit">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/inherit" title="The inherit CSS keyword causes the element to take the computed value of the property from its parent element. It can be applied to any CSS property, including the CSS shorthand property all.">inherit</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span>
     <hr>
     <span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>IE</span><span>8+</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="initial">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/initial" title="The initial CSS keyword applies the initial (or default) value of a property to an element. It can be applied to any CSS property, including the CSS shorthand property all. With all set to initial, all CSS properties can be restored to their respective initial values in one go instead of restoring each one separately.">initial</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>19+</span></span><span class="safari yes"><span>Safari</span><span>1.2+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>13+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="default">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/revert" title="The revert CSS keyword reverts the cascaded value of the property from its current value to the value the property would have had if no changes had been made by the current style origin to the current element. Thus, it resets the property either to user agent set value, to user set value, to its inherited value (if it is inheritable), or to initial value. It can be applied to any CSS property, including the CSS shorthand property all.">revert</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>67+</span></span><span class="safari yes"><span>Safari</span><span>9.1+</span></span><span class="chrome yes"><span>Chrome</span><span>84+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>84+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="inherit-initial">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/unset" title="The unset CSS keyword resets a property to its inherited value if the property naturally inherits from its parent, and to its initial value if not. In other words, it behaves like the inherit keyword in the first case, when the property is an inherited property, and like the initial keyword in the second case, when the property is a non-inherited property.">unset</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>27+</span></span><span class="safari yes"><span>Safari</span><span>9.1+</span></span><span class="chrome yes"><span>Chrome</span><span>41+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>13+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"0197874e": {"dfnID":"0197874e","dfnText":"block at-rule","external":true,"refSections":[{"refs":[{"id":"ref-for-block-at-rule"}],"title":"2.5. \nScoping Styles: the @scope rule"}],"url":"https://drafts.csswg.org/css-syntax-3/#block-at-rule"},
"0497de86": {"dfnID":"0497de86","dfnText":"@font-face","external":true,"refSections":[{"refs":[{"id":"ref-for-at-font-face-rule"}],"title":"2.5.5. \nScope Nesting"}],"url":"https://drafts.csswg.org/css-fonts-5/#at-font-face-rule"},
"19f9e9df": {"dfnID":"19f9e9df","dfnText":"shadow tree","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-shadow-tree"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-concept-shadow-tree\u2460"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-concept-shadow-tree\u2461"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"}],"url":"https://dom.spec.whatwg.org/#concept-shadow-tree"},
"2485e0d1": {"dfnID":"2485e0d1","dfnText":"CSSGroupingRule","external":true,"refSections":[{"refs":[{"id":"ref-for-cssgroupingrule"}],"title":"3.1. \nThe CSSScopeRule interface"}],"url":"https://drafts.csswg.org/cssom-1/#cssgroupingrule"},
"33cbcfca": {"dfnID":"33cbcfca","dfnText":"selector","external":true,"refSections":[{"refs":[{"id":"ref-for-selector"},{"id":"ref-for-selector\u2460"}],"title":"2.5.2. \nSyntax of @scope"}],"url":"https://drafts.csswg.org/selectors-4/#selector"},
"34c941b4": {"dfnID":"34c941b4","dfnText":"scoping root","external":true,"refSections":[{"refs":[{"id":"ref-for-scoping-root"},{"id":"ref-for-scoping-root\u2460"},{"id":"ref-for-scoping-root\u2461"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-scoping-root\u2462"},{"id":"ref-for-scoping-root\u2463"},{"id":"ref-for-scoping-root\u2464"},{"id":"ref-for-scoping-root\u2465"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-scoping-root\u2466"},{"id":"ref-for-scoping-root\u2467"},{"id":"ref-for-scoping-root\u2468"},{"id":"ref-for-scoping-root\u2460\u24ea"},{"id":"ref-for-scoping-root\u2460\u2460"},{"id":"ref-for-scoping-root\u2460\u2461"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-scoping-root\u2460\u2462"},{"id":"ref-for-scoping-root\u2460\u2463"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-scoping-root\u2460\u2464"},{"id":"ref-for-scoping-root\u2460\u2465"},{"id":"ref-for-scoping-root\u2460\u2466"},{"id":"ref-for-scoping-root\u2460\u2467"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-scoping-root\u2460\u2468"},{"id":"ref-for-scoping-root\u2461\u24ea"},{"id":"ref-for-scoping-root\u2461\u2460"},{"id":"ref-for-scoping-root\u2461\u2461"},{"id":"ref-for-scoping-root\u2461\u2462"},{"id":"ref-for-scoping-root\u2461\u2463"},{"id":"ref-for-scoping-root\u2461\u2464"},{"id":"ref-for-scoping-root\u2461\u2465"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-scoping-root\u2461\u2466"},{"id":"ref-for-scoping-root\u2461\u2467"},{"id":"ref-for-scoping-root\u2461\u2468"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-scoping-root\u2462\u24ea"}],"title":"2.5.6. \nScoped Declarations "},{"refs":[{"id":"ref-for-scoping-root\u2462\u2460"},{"id":"ref-for-scoping-root\u2462\u2461"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"https://drafts.csswg.org/selectors-4/#scoping-root"},
"3814f164": {"dfnID":"3814f164","dfnText":"scoped selector","external":true,"refSections":[{"refs":[{"id":"ref-for-scoped-selector"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-scoped-selector\u2460"}],"title":"2.5.5. \nScope Nesting"}],"url":"https://drafts.csswg.org/selectors-4/#scoped-selector"},
"39e92270": {"dfnID":"39e92270","dfnText":"author origin","external":true,"refSections":[{"refs":[{"id":"ref-for-cascade-origin-author"},{"id":"ref-for-cascade-origin-author\u2460"}],"title":"2.1. \nCascade Sorting Order"}],"url":"https://drafts.csswg.org/css-cascade-5/#cascade-origin-author"},
"3a1154bf": {"dfnID":"3a1154bf","dfnText":"featureless","external":true,"refSections":[{"refs":[{"id":"ref-for-featureless"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-featureless\u2460"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"https://drafts.csswg.org/selectors-4/#featureless"},
"3fcc582f": {"dfnID":"3fcc582f","dfnText":"shadow root","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-shadow-root"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"https://dom.spec.whatwg.org/#concept-shadow-root"},
"47948caa": {"dfnID":"47948caa","dfnText":"qualified rule","external":true,"refSections":[{"refs":[{"id":"ref-for-qualified-rule"}],"title":"2.5.2. \nSyntax of @scope"}],"url":"https://drafts.csswg.org/css-syntax-3/#qualified-rule"},
"4a88f201": {"dfnID":"4a88f201","dfnText":"cascade layers","external":true,"refSections":[{"refs":[{"id":"ref-for-cascade-layers"},{"id":"ref-for-cascade-layers\u2460"},{"id":"ref-for-cascade-layers\u2461"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-cascade-layers\u2462"}],"title":"4.4. \nAdditions Since Level 4"}],"url":"https://drafts.csswg.org/css-cascade-5/#cascade-layers"},
"4cd9dfd7": {"dfnID":"4cd9dfd7","dfnText":"relative selector","external":true,"refSections":[{"refs":[{"id":"ref-for-relative-selector"},{"id":"ref-for-relative-selector\u2460"},{"id":"ref-for-relative-selector\u2461"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-relative-selector\u2462"},{"id":"ref-for-relative-selector\u2463"}],"title":"2.5.5. \nScope Nesting"}],"url":"https://drafts.csswg.org/selectors-4/#relative-selector"},
"4d7d3dcd": {"dfnID":"4d7d3dcd","dfnText":"initial","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-all-initial"}],"title":"4.6. \nAdditions Since Level 2"}],"url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-initial"},
"4e55d7fb": {"dfnID":"4e55d7fb","dfnText":"@import","external":true,"refSections":[{"refs":[{"id":"ref-for-at-ruledef-import"},{"id":"ref-for-at-ruledef-import\u2460"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-at-ruledef-import\u2461"}],"title":"4.4. \nAdditions Since Level 4"},{"refs":[{"id":"ref-for-at-ruledef-import\u2462"}],"title":"4.5. \nAdditions Since Level 3"},{"refs":[{"id":"ref-for-at-ruledef-import\u2463"},{"id":"ref-for-at-ruledef-import\u2464"}],"title":"6. \nSecurity Considerations"}],"url":"https://drafts.csswg.org/css-cascade-5/#at-ruledef-import"},
"4fcdc12a": {"dfnID":"4fcdc12a","dfnText":"rule","external":true,"refSections":[{"refs":[{"id":"ref-for-css-rule"}],"title":"2.5.6. \nScoped Declarations "}],"url":"https://drafts.csswg.org/css-syntax-3/#css-rule"},
"5140976e": {"dfnID":"5140976e","dfnText":"contain the nesting selector","external":true,"refSections":[{"refs":[{"id":"ref-for-contain-the-nesting-selector"}],"title":"2.5.3. \nScoped Style Rules"}],"url":"https://drafts.csswg.org/css-nesting-1/#contain-the-nesting-selector"},
"5a58bbb0": {"dfnID":"5a58bbb0","dfnText":"style rule","external":true,"refSections":[{"refs":[{"id":"ref-for-style-rule"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-style-rule\u2460"},{"id":"ref-for-style-rule\u2461"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-style-rule\u2462"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-style-rule\u2463"}],"title":"2.5.6. \nScoped Declarations "}],"url":"https://drafts.csswg.org/css-syntax-3/#style-rule"},
"5afeceea": {"dfnID":"5afeceea","dfnText":"parent element","external":true,"refSections":[{"refs":[{"id":"ref-for-parent-element"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"}],"url":"https://dom.spec.whatwg.org/#parent-element"},
"5f4f98ab": {"dfnID":"5f4f98ab","dfnText":"descendant combinator","external":true,"refSections":[{"refs":[{"id":"ref-for-descendant-combinator"}],"title":"2.5.3. \nScoped Style Rules"}],"url":"https://drafts.csswg.org/selectors-4/#descendant-combinator"},
"5fced98b": {"dfnID":"5fced98b","dfnText":"CSSOMString","external":true,"refSections":[{"refs":[{"id":"ref-for-cssomstring"},{"id":"ref-for-cssomstring\u2460"}],"title":"3.1. \nThe CSSScopeRule interface"}],"url":"https://drafts.csswg.org/cssom-1/#cssomstring"},
"621960b6": {"dfnID":"621960b6","dfnText":"user origin","external":true,"refSections":[{"refs":[{"id":"ref-for-cascade-origin-user"},{"id":"ref-for-cascade-origin-user\u2460"}],"title":"2.1. \nCascade Sorting Order"}],"url":"https://drafts.csswg.org/css-cascade-5/#cascade-origin-user"},
"63fe4250": {"dfnID":"63fe4250","dfnText":"user-agent origin","external":true,"refSections":[{"refs":[{"id":"ref-for-cascade-origin-ua"},{"id":"ref-for-cascade-origin-ua\u2460"}],"title":"2.1. \nCascade Sorting Order"}],"url":"https://drafts.csswg.org/css-cascade-5/#cascade-origin-ua"},
"65c9f2cf": {"dfnID":"65c9f2cf","dfnText":"<rule-list>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-rule-list"}],"title":"2.5.1. \nEffects of @scope"}],"url":"https://drafts.csswg.org/css-syntax-3/#typedef-rule-list"},
"71aed09f": {"dfnID":"71aed09f","dfnText":"<selector-list>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-selector-list"},{"id":"ref-for-typedef-selector-list\u2460"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-typedef-selector-list\u2461"}],"title":"2.5.3. \nScoped Style Rules"}],"url":"https://drafts.csswg.org/selectors-4/#typedef-selector-list"},
"762610c7": {"dfnID":"762610c7","dfnText":"at-rule","external":true,"refSections":[{"refs":[{"id":"ref-for-at-rule"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-at-rule\u2460"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-at-rule\u2461"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"}],"url":"https://drafts.csswg.org/css-syntax-3/#at-rule"},
"7b82c9e5": {"dfnID":"7b82c9e5","dfnText":"pseudo-elements","external":true,"refSections":[{"refs":[{"id":"ref-for-x22"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-x22\u2460"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"}],"url":"https://www.w3.org/TR/CSS2/selector.html#x22"},
"7c8e67c1": {"dfnID":"7c8e67c1","dfnText":"declared value","external":true,"refSections":[{"refs":[{"id":"ref-for-declared-value"}],"title":"2. \nCascading"},{"refs":[{"id":"ref-for-declared-value\u2460"}],"title":"2.1. \nCascade Sorting Order"}],"url":"https://drafts.csswg.org/css-cascade-5/#declared-value"},
"889e932f": {"dfnID":"889e932f","dfnText":"Exposed","external":true,"refSections":[{"refs":[{"id":"ref-for-Exposed"}],"title":"3.1. \nThe CSSScopeRule interface"}],"url":"https://webidl.spec.whatwg.org/#Exposed"},
"8c1eb8d0": {"dfnID":"8c1eb8d0","dfnText":"?","external":true,"refSections":[{"refs":[{"id":"ref-for-mult-opt"},{"id":"ref-for-mult-opt\u2460"}],"title":"2.5.2. \nSyntax of @scope"}],"url":"https://drafts.csswg.org/css-values-3/#mult-opt"},
"8e92a2a0": {"dfnID":"8e92a2a0","dfnText":"revert-layer","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-all-revert-layer"}],"title":"4.4. \nAdditions Since Level 4"}],"url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-revert-layer"},
"94b8f87c": {"dfnID":"94b8f87c","dfnText":"@layer","external":true,"refSections":[{"refs":[{"id":"ref-for-at-ruledef-layer"},{"id":"ref-for-at-ruledef-layer\u2460"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-at-ruledef-layer\u2461"}],"title":"4.4. \nAdditions Since Level 4"}],"url":"https://drafts.csswg.org/css-cascade-5/#at-ruledef-layer"},
"9e004c39": {"dfnID":"9e004c39","dfnText":"unset","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-all-unset"}],"title":"4.6. \nAdditions Since Level 2"}],"url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-unset"},
"a15951ea": {"dfnID":"a15951ea","dfnText":"supports()","external":true,"refSections":[{"refs":[{"id":"ref-for-funcdef-supports"}],"title":"4.5. \nAdditions Since Level 3"}],"url":"https://drafts.csswg.org/css-conditional-5/#funcdef-supports"},
"a2a30ba8": {"dfnID":"a2a30ba8","dfnText":"CORS protocol","external":true,"refSections":[{"refs":[{"id":"ref-for-cors-protocol"}],"title":"6. \nSecurity Considerations"}],"url":"https://fetch.spec.whatwg.org/#cors-protocol"},
"a5ad37b5": {"dfnID":"a5ad37b5","dfnText":"&","external":true,"refSections":[{"refs":[{"id":"ref-for-selectordef-"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-selectordef-\u2460"},{"id":"ref-for-selectordef-\u2461"},{"id":"ref-for-selectordef-\u2462"},{"id":"ref-for-selectordef-\u2463"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-selectordef-\u2464"},{"id":"ref-for-selectordef-\u2465"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-selectordef-\u2466"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"}],"url":"https://drafts.csswg.org/css-nesting-1/#selectordef-"},
"at-ruledef-scope": {"dfnID":"at-ruledef-scope","dfnText":"@scope","external":false,"refSections":[{"refs":[{"id":"ref-for-at-ruledef-scope"},{"id":"ref-for-at-ruledef-scope\u2460"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2461"},{"id":"ref-for-at-ruledef-scope\u2462"},{"id":"ref-for-at-ruledef-scope\u2463"},{"id":"ref-for-at-ruledef-scope\u2464"},{"id":"ref-for-at-ruledef-scope\u2465"},{"id":"ref-for-at-ruledef-scope\u2466"},{"id":"ref-for-at-ruledef-scope\u2467"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2468"},{"id":"ref-for-at-ruledef-scope\u2460\u24ea"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2460\u2460"},{"id":"ref-for-at-ruledef-scope\u2460\u2461"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2460\u2462"},{"id":"ref-for-at-ruledef-scope\u2460\u2463"},{"id":"ref-for-at-ruledef-scope\u2460\u2464"},{"id":"ref-for-at-ruledef-scope\u2460\u2465"},{"id":"ref-for-at-ruledef-scope\u2460\u2466"},{"id":"ref-for-at-ruledef-scope\u2460\u2467"},{"id":"ref-for-at-ruledef-scope\u2460\u2468"},{"id":"ref-for-at-ruledef-scope\u2461\u24ea"},{"id":"ref-for-at-ruledef-scope\u2461\u2460"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2461\u2461"},{"id":"ref-for-at-ruledef-scope\u2461\u2462"}],"title":"2.5.6. \nScoped Declarations "},{"refs":[{"id":"ref-for-at-ruledef-scope\u2461\u2463"}],"title":"3.1. \nThe CSSScopeRule interface"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2461\u2464"},{"id":"ref-for-at-ruledef-scope\u2461\u2465"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2461\u2466"},{"id":"ref-for-at-ruledef-scope\u2461\u2467"},{"id":"ref-for-at-ruledef-scope\u2461\u2468"},{"id":"ref-for-at-ruledef-scope\u2462\u24ea"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"},{"refs":[{"id":"ref-for-at-ruledef-scope\u2462\u2460"}],"title":"4.3. \nAdditions Since Level 5"}],"url":"#at-ruledef-scope"},
"b845e85c": {"dfnID":"b845e85c","dfnText":"<block-contents>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-block-contents"},{"id":"ref-for-typedef-block-contents\u2460"}],"title":"2.5.2. \nSyntax of @scope"}],"url":"https://drafts.csswg.org/css-syntax-3/#typedef-block-contents"},
"b894d2f3": {"dfnID":"b894d2f3","dfnText":"subject","external":true,"refSections":[{"refs":[{"id":"ref-for-selector-subject"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-selector-subject\u2460"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-selector-subject\u2461"},{"id":"ref-for-selector-subject\u2462"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-selector-subject\u2463"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-selector-subject\u2464"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"https://drafts.csswg.org/selectors-4/#selector-subject"},
"ba920583": {"dfnID":"ba920583","dfnText":"style","external":true,"refSections":[{"refs":[{"id":"ref-for-the-style-element"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#the-style-element"},
"bb2056aa": {"dfnID":"bb2056aa","dfnText":"specificity","external":true,"refSections":[{"refs":[{"id":"ref-for-specificity"}],"title":"2.5.6. \nScoped Declarations "}],"url":"https://drafts.csswg.org/selectors-4/#specificity"},
"bef88b2d": {"dfnID":"bef88b2d","dfnText":"revert","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-all-revert"}],"title":"4.5. \nAdditions Since Level 3"}],"url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-revert"},
"c665612f": {"dfnID":"c665612f","dfnText":"cascaded value","external":true,"refSections":[{"refs":[{"id":"ref-for-cascaded-value"}],"title":"2. \nCascading"}],"url":"https://drafts.csswg.org/css-cascade-5/#cascaded-value"},
"c7d8d91b": {"dfnID":"c7d8d91b","dfnText":"node tree","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-node-tree"},{"id":"ref-for-concept-node-tree\u2460"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"}],"url":"https://dom.spec.whatwg.org/#concept-node-tree"},
"cascade": {"dfnID":"cascade","dfnText":"cascade","external":false,"refSections":[{"refs":[{"id":"ref-for-cascade"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-cascade\u2460"},{"id":"ref-for-cascade\u2461"}],"title":"4.4. \nAdditions Since Level 4"},{"refs":[{"id":"ref-for-cascade\u2462"}],"title":"4.5. \nAdditions Since Level 3"},{"refs":[{"id":"ref-for-cascade\u2463"}],"title":"4.6. \nAdditions Since Level 2"}],"url":"#cascade"},
"ce2e3c84": {"dfnID":"ce2e3c84","dfnText":"shadow host","external":true,"refSections":[{"refs":[{"id":"ref-for-shadow-host"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-shadow-host\u2460"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-shadow-host\u2461"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-shadow-host\u2462"},{"id":"ref-for-shadow-host\u2463"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"https://www.w3.org/TR/css-scoping-1/#shadow-host"},
"cfd2c803": {"dfnID":"cfd2c803","dfnText":"tree context","external":true,"refSections":[{"refs":[{"id":"ref-for-tree-context"},{"id":"ref-for-tree-context\u2460"}],"title":"2.1. \nCascade Sorting Order"}],"url":"https://drafts.csswg.org/css-scoping-1/#tree-context"},
"cssscoperule": {"dfnID":"cssscoperule","dfnText":"CSSScopeRule","external":false,"refSections":[{"refs":[{"id":"ref-for-cssscoperule"}],"title":"3.1. \nThe CSSScopeRule interface"},{"refs":[{"id":"ref-for-cssscoperule\u2460"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"#cssscoperule"},
"d462b34f": {"dfnID":"d462b34f","dfnText":"node","external":true,"refSections":[{"refs":[{"id":"ref-for-boundary-point-node"}],"title":"2.5. \nScoping Styles: the @scope rule"}],"url":"https://dom.spec.whatwg.org/#boundary-point-node"},
"d95397a7": {"dfnID":"d95397a7","dfnText":"all","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-all"}],"title":"4.6. \nAdditions Since Level 2"}],"url":"https://drafts.csswg.org/css-cascade-5/#propdef-all"},
"dc55c3d9": {"dfnID":"dc55c3d9","dfnText":":scope","external":true,"refSections":[{"refs":[{"id":"ref-for-scope-pseudo"},{"id":"ref-for-scope-pseudo\u2460"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-scope-pseudo\u2461"},{"id":"ref-for-scope-pseudo\u2462"},{"id":"ref-for-scope-pseudo\u2463"},{"id":"ref-for-scope-pseudo\u2464"},{"id":"ref-for-scope-pseudo\u2465"},{"id":"ref-for-scope-pseudo\u2466"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-scope-pseudo\u2467"},{"id":"ref-for-scope-pseudo\u2468"},{"id":"ref-for-scope-pseudo\u2460\u24ea"},{"id":"ref-for-scope-pseudo\u2460\u2460"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-scope-pseudo\u2460\u2461"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"},{"refs":[{"id":"ref-for-scope-pseudo\u2460\u2462"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"}],"url":"https://drafts.csswg.org/selectors-4/#scope-pseudo"},
"dfd120f7": {"dfnID":"dfd120f7","dfnText":"declaration","external":true,"refSections":[{"refs":[{"id":"ref-for-declaration"}],"title":"2. \nCascading"},{"refs":[{"id":"ref-for-declaration\u2460"}],"title":"2.1. \nCascade Sorting Order"}],"url":"https://drafts.csswg.org/css-syntax-3/#declaration"},
"dom-cssscoperule-end": {"dfnID":"dom-cssscoperule-end","dfnText":"end","external":false,"refSections":[],"url":"#dom-cssscoperule-end"},
"dom-cssscoperule-start": {"dfnID":"dom-cssscoperule-start","dfnText":"start","external":false,"refSections":[],"url":"#dom-cssscoperule-start"},
"e4ffca7f": {"dfnID":"e4ffca7f","dfnText":"declarations","external":true,"refSections":[{"refs":[{"id":"ref-for-cssstyledeclaration-declarations"},{"id":"ref-for-cssstyledeclaration-declarations\u2460"},{"id":"ref-for-cssstyledeclaration-declarations\u2461"},{"id":"ref-for-cssstyledeclaration-declarations\u2462"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-cssstyledeclaration-declarations\u2463"},{"id":"ref-for-cssstyledeclaration-declarations\u2464"},{"id":"ref-for-cssstyledeclaration-declarations\u2465"}],"title":"2.5.6. \nScoped Declarations "},{"refs":[{"id":"ref-for-cssstyledeclaration-declarations\u2466"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations"},
"ea722d19": {"dfnID":"ea722d19","dfnText":"<relative-selector-list>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-relative-selector-list"},{"id":"ref-for-typedef-relative-selector-list\u2460"}],"title":"2.5.3. \nScoped Style Rules"}],"url":"https://drafts.csswg.org/selectors-4/#typedef-relative-selector-list"},
"eab73120": {"dfnID":"eab73120","dfnText":"owner node","external":true,"refSections":[{"refs":[{"id":"ref-for-cssstyledeclaration-owner-node"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"}],"url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node"},
"encapsulation-contexts": {"dfnID":"encapsulation-contexts","dfnText":"encapsulation contexts","external":false,"refSections":[{"refs":[{"id":"ref-for-encapsulation-contexts"},{"id":"ref-for-encapsulation-contexts\u2460"},{"id":"ref-for-encapsulation-contexts\u2461"},{"id":"ref-for-encapsulation-contexts\u2462"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-encapsulation-contexts\u2463"}],"title":"4.5. \nAdditions Since Level 3"}],"url":"#encapsulation-contexts"},
"f0811ff8": {"dfnID":"f0811ff8","dfnText":"img","external":true,"refSections":[{"refs":[{"id":"ref-for-the-img-element"}],"title":"2.5.1. \nEffects of @scope"}],"url":"https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element"},
"f4fc17d1": {"dfnID":"f4fc17d1","dfnText":"combinator","external":true,"refSections":[{"refs":[{"id":"ref-for-selector-combinator"}],"title":"2.5.3. \nScoped Style Rules"}],"url":"https://drafts.csswg.org/selectors-4/#selector-combinator"},
"f7960529": {"dfnID":"f7960529","dfnText":"root","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-tree-root"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"}],"url":"https://dom.spec.whatwg.org/#concept-tree-root"},
"f8cc2828": {"dfnID":"f8cc2828","dfnText":"nested declarations rule","external":true,"refSections":[{"refs":[{"id":"ref-for-nested-declarations-rule%E2%91%A0"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-nested-declarations-rule%E2%91%A0\u2460"}],"title":"2.5.6. \nScoped Declarations "}],"url":"https://drafts.csswg.org/css-nesting-1/#nested-declarations-rule%E2%91%A0"},
"f9d909f7": {"dfnID":"f9d909f7","dfnText":"inclusive descendant","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-tree-inclusive-descendant"},{"id":"ref-for-concept-tree-inclusive-descendant\u2460"}],"title":"2.5. \nScoping Styles: the @scope rule"}],"url":"https://dom.spec.whatwg.org/#concept-tree-inclusive-descendant"},
"fa19c68e": {"dfnID":"fa19c68e","dfnText":"@keyframes","external":true,"refSections":[{"refs":[{"id":"ref-for-at-ruledef-keyframes"}],"title":"2.5.5. \nScope Nesting"}],"url":"https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes"},
"fefa5851": {"dfnID":"fefa5851","dfnText":"shadow-including tree order","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-shadow-including-tree-order"}],"title":"2.1. \nCascade Sorting Order"}],"url":"https://dom.spec.whatwg.org/#concept-shadow-including-tree-order"},
"important": {"dfnID":"important","dfnText":"important","external":false,"refSections":[{"refs":[{"id":"ref-for-important"},{"id":"ref-for-important\u2460"},{"id":"ref-for-important\u2461"},{"id":"ref-for-important\u2462"},{"id":"ref-for-important\u2463"},{"id":"ref-for-important\u2464"},{"id":"ref-for-important\u2465"},{"id":"ref-for-important\u2466"},{"id":"ref-for-important\u2467"},{"id":"ref-for-important\u2468"}],"title":"2.1. \nCascade Sorting Order"}],"url":"#important"},
"in-scope": {"dfnID":"in-scope","dfnText":"in scope","external":false,"refSections":[{"refs":[{"id":"ref-for-in-scope"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-in-scope\u2460"},{"id":"ref-for-in-scope\u2461"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-in-scope\u2462"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"}],"url":"#in-scope"},
"normal": {"dfnID":"normal","dfnText":"normal","external":false,"refSections":[{"refs":[{"id":"ref-for-normal"},{"id":"ref-for-normal\u2460"},{"id":"ref-for-normal\u2461"},{"id":"ref-for-normal\u2462"},{"id":"ref-for-normal\u2463"},{"id":"ref-for-normal\u2464"},{"id":"ref-for-normal\u2465"},{"id":"ref-for-normal\u2466"}],"title":"2.1. \nCascade Sorting Order"}],"url":"#normal"},
"origin": {"dfnID":"origin","dfnText":"cascade origin","external":false,"refSections":[{"refs":[{"id":"ref-for-origin"},{"id":"ref-for-origin\u2460"},{"id":"ref-for-origin\u2461"},{"id":"ref-for-origin\u2462"},{"id":"ref-for-origin\u2463"},{"id":"ref-for-origin\u2464"}],"title":"2.1. \nCascade Sorting Order"}],"url":"#origin"},
"output-of-the-cascade": {"dfnID":"output-of-the-cascade","dfnText":"output of the cascade","external":false,"refSections":[],"url":"#output-of-the-cascade"},
"scope": {"dfnID":"scope","dfnText":"scope","external":false,"refSections":[{"refs":[{"id":"ref-for-scope"},{"id":"ref-for-scope\u2460"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-scope\u2461"},{"id":"ref-for-scope\u2462"},{"id":"ref-for-scope\u2463"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-scope\u2464"},{"id":"ref-for-scope\u2465"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-scope\u2466"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"},{"refs":[{"id":"ref-for-scope\u2467"}],"title":"4.3. \nAdditions Since Level 5"}],"url":"#scope"},
"scope-proximity": {"dfnID":"scope-proximity","dfnText":"Scope Proximity","external":false,"refSections":[{"refs":[{"id":"ref-for-scope-proximity"},{"id":"ref-for-scope-proximity\u2460"},{"id":"ref-for-scope-proximity\u2461"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-scope-proximity\u2462"},{"id":"ref-for-scope-proximity\u2463"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-scope-proximity\u2464"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"},{"refs":[{"id":"ref-for-scope-proximity\u2465"}],"title":"4.3. \nAdditions Since Level 5"}],"url":"#scope-proximity"},
"scoped-style-rules": {"dfnID":"scoped-style-rules","dfnText":"Scoped style rules","external":false,"refSections":[{"refs":[{"id":"ref-for-scoped-style-rules"}],"title":"2.1. \nCascade Sorting Order"},{"refs":[{"id":"ref-for-scoped-style-rules\u2460"},{"id":"ref-for-scoped-style-rules\u2461"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-scoped-style-rules\u2462"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-scoped-style-rules\u2463"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-scoped-style-rules\u2464"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-scoped-style-rules\u2465"},{"id":"ref-for-scoped-style-rules\u2466"},{"id":"ref-for-scoped-style-rules\u2467"},{"id":"ref-for-scoped-style-rules\u2468"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-scoped-style-rules\u2460\u24ea"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"}],"url":"#scoped-style-rules"},
"scoping-limit": {"dfnID":"scoping-limit","dfnText":"scoping limit","external":false,"refSections":[{"refs":[{"id":"ref-for-scoping-limit"},{"id":"ref-for-scoping-limit\u2460"},{"id":"ref-for-scoping-limit\u2461"},{"id":"ref-for-scoping-limit\u2462"}],"title":"2.5. \nScoping Styles: the @scope rule"},{"refs":[{"id":"ref-for-scoping-limit\u2463"},{"id":"ref-for-scoping-limit\u2464"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-scoping-limit\u2465"},{"id":"ref-for-scoping-limit\u2466"},{"id":"ref-for-scoping-limit\u2467"},{"id":"ref-for-scoping-limit\u2468"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-scoping-limit\u2460\u24ea"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"}],"url":"#scoping-limit"},
"typedef-scope-end": {"dfnID":"typedef-scope-end","dfnText":"<scope-end>","external":false,"refSections":[{"refs":[{"id":"ref-for-typedef-scope-end"},{"id":"ref-for-typedef-scope-end\u2460"},{"id":"ref-for-typedef-scope-end\u2461"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-typedef-scope-end\u2462"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-typedef-scope-end\u2463"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-typedef-scope-end\u2464"},{"id":"ref-for-typedef-scope-end\u2465"}],"title":"3.1. \nThe CSSScopeRule interface"},{"refs":[{"id":"ref-for-typedef-scope-end\u2466"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"},{"refs":[{"id":"ref-for-typedef-scope-end\u2467"}],"title":"4.3. \nAdditions Since Level 5"}],"url":"#typedef-scope-end"},
"typedef-scope-start": {"dfnID":"typedef-scope-start","dfnText":"<scope-start>","external":false,"refSections":[{"refs":[{"id":"ref-for-typedef-scope-start"}],"title":"2.5.1. \nEffects of @scope"},{"refs":[{"id":"ref-for-typedef-scope-start\u2460"},{"id":"ref-for-typedef-scope-start\u2461"},{"id":"ref-for-typedef-scope-start\u2462"}],"title":"2.5.2. \nSyntax of @scope"},{"refs":[{"id":"ref-for-typedef-scope-start\u2463"},{"id":"ref-for-typedef-scope-start\u2464"}],"title":"2.5.3. \nScoped Style Rules"},{"refs":[{"id":"ref-for-typedef-scope-start\u2465"},{"id":"ref-for-typedef-scope-start\u2466"},{"id":"ref-for-typedef-scope-start\u2467"},{"id":"ref-for-typedef-scope-start\u2468"}],"title":"2.5.4. \nIdentifying Scoping Roots and Limits"},{"refs":[{"id":"ref-for-typedef-scope-start\u2460\u24ea"}],"title":"2.5.5. \nScope Nesting"},{"refs":[{"id":"ref-for-typedef-scope-start\u2460\u2460"},{"id":"ref-for-typedef-scope-start\u2460\u2461"}],"title":"3.1. \nThe CSSScopeRule interface"},{"refs":[{"id":"ref-for-typedef-scope-start\u2460\u2462"},{"id":"ref-for-typedef-scope-start\u2460\u2463"}],"title":"4.1. \nChanges since the 21 March 2023 Working Draft"},{"refs":[{"id":"ref-for-typedef-scope-start\u2460\u2464"}],"title":"4.2. \nChanges since the 21 December 2021 First Public Working Draft"},{"refs":[{"id":"ref-for-typedef-scope-start\u2460\u2465"}],"title":"4.3. \nAdditions Since Level 5"}],"url":"#typedef-scope-start"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-position-annos */
"use strict";
{
function repositionAnnoPanels(){
    const panels = [...document.querySelectorAll("[data-anno-for]")];
    hydratePanels(panels);
    let vSoFar = 0;
    for(const panel of panels.sort(cmpTops)) {
        if(panel.top < vSoFar) {
            panel.top = vSoFar;
            panel.style.top = vSoFar + "px";
        }
        vSoFar = panel.top + panel.height + 15;
    }
}
function hydratePanels(panels) {
    const main = document.querySelector("main");
    let mainRect;
    if(main) mainRect = main.getBoundingClientRect();
    // First display them all, if they're not already visible.
    for(const panel of panels) {
        panel.classList.remove("unpositioned");
    }
    // Measure them all
    for(const panel of panels) {
        const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
        if(!dfn) {
            console.log("Can't find the annotation panel target:", panel);
            continue;
        }
        panel.dfn = dfn;
        panel.top = window.scrollY + dfn.getBoundingClientRect().top;
        let panelRect = panel.getBoundingClientRect();
        panel.height = panelRect.height;
        if(main) {
            panel.overlappingMain = panelRect.left < mainRect.right;
        } else {
            panel.overlappingMain = false;
        }
    }
    // And finally position them
    for(const panel of panels) {
        const dfn = panel.dfn;
        if(!dfn) continue;
        panel.style.top = panel.top + "px";
        panel.classList.toggle("overlapping-main", panel.overlappingMain);
    }
}

function cmpTops(a,b) {
    return a.top - b.top;
}

window.addEventListener("load", repositionAnnoPanels);
window.addEventListener("resize", repositionAnnoPanels);
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#at-ruledef-scope": {"displayText":"@scope","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"@scope","type":"at-rule","url":"#at-ruledef-scope"},
"#cascade": {"displayText":"cascade","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"cascade","type":"dfn","url":"#cascade"},
"#cssscoperule": {"displayText":"CSSScopeRule","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"CSSScopeRule","type":"interface","url":"#cssscoperule"},
"#encapsulation-contexts": {"displayText":"encapsulation contexts","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"encapsulation contexts","type":"dfn","url":"#encapsulation-contexts"},
"#important": {"displayText":"important","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"important","type":"dfn","url":"#important"},
"#in-scope": {"displayText":"in scope","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"in scope","type":"dfn","url":"#in-scope"},
"#normal": {"displayText":"normal","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"normal","type":"dfn","url":"#normal"},
"#origin": {"displayText":"origin","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"origin","type":"dfn","url":"#origin"},
"#scope": {"displayText":"scope","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"scope","type":"dfn","url":"#scope"},
"#scope-proximity": {"displayText":"scope proximity","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"scope proximity","type":"dfn","url":"#scope-proximity"},
"#scoped-style-rules": {"displayText":"scoped style rules","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"scoped style rules","type":"dfn","url":"#scoped-style-rules"},
"#scoping-limit": {"displayText":"scoping limit","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"scoping limit","type":"dfn","url":"#scoping-limit"},
"#typedef-scope-end": {"displayText":"<scope-end>","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"<scope-end>","type":"type","url":"#typedef-scope-end"},
"#typedef-scope-start": {"displayText":"<scope-start>","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"local","text":"<scope-start>","type":"type","url":"#typedef-scope-start"},
"https://dom.spec.whatwg.org/#boundary-point-node": {"displayText":"node","export":true,"for_":["boundary point"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"node","type":"dfn","url":"https://dom.spec.whatwg.org/#boundary-point-node"},
"https://dom.spec.whatwg.org/#concept-node-tree": {"displayText":"node tree","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"node tree","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-node-tree"},
"https://dom.spec.whatwg.org/#concept-shadow-including-tree-order": {"displayText":"shadow-including tree order","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"shadow-including tree order","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-shadow-including-tree-order"},
"https://dom.spec.whatwg.org/#concept-shadow-root": {"displayText":"shadow root","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"shadow root","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-shadow-root"},
"https://dom.spec.whatwg.org/#concept-shadow-tree": {"displayText":"shadow tree","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"shadow tree","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-shadow-tree"},
"https://dom.spec.whatwg.org/#concept-tree-inclusive-descendant": {"displayText":"inclusive descendant","export":true,"for_":["tree"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"inclusive descendant","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-tree-inclusive-descendant"},
"https://dom.spec.whatwg.org/#concept-tree-root": {"displayText":"root","export":true,"for_":["tree"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"root","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-tree-root"},
"https://dom.spec.whatwg.org/#parent-element": {"displayText":"parent element","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"parent element","type":"dfn","url":"https://dom.spec.whatwg.org/#parent-element"},
"https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes": {"displayText":"@keyframes","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-animations","spec":"css-animations-1","status":"current","text":"@keyframes","type":"at-rule","url":"https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes"},
"https://drafts.csswg.org/css-cascade-5/#at-ruledef-import": {"displayText":"@import","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"@import","type":"at-rule","url":"https://drafts.csswg.org/css-cascade-5/#at-ruledef-import"},
"https://drafts.csswg.org/css-cascade-5/#at-ruledef-layer": {"displayText":"@layer","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"@layer","type":"at-rule","url":"https://drafts.csswg.org/css-cascade-5/#at-ruledef-layer"},
"https://drafts.csswg.org/css-cascade-5/#cascade-layers": {"displayText":"cascade layers","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"cascade layers","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#cascade-layers"},
"https://drafts.csswg.org/css-cascade-5/#cascade-origin-author": {"displayText":"author origin","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"author origin","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#cascade-origin-author"},
"https://drafts.csswg.org/css-cascade-5/#cascade-origin-ua": {"displayText":"user-agent origin","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"user-agent origin","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#cascade-origin-ua"},
"https://drafts.csswg.org/css-cascade-5/#cascade-origin-user": {"displayText":"user origin","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"user origin","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#cascade-origin-user"},
"https://drafts.csswg.org/css-cascade-5/#cascaded-value": {"displayText":"cascaded value","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"cascaded value","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#cascaded-value"},
"https://drafts.csswg.org/css-cascade-5/#declared-value": {"displayText":"declared value","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"declared value","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#declared-value"},
"https://drafts.csswg.org/css-cascade-5/#propdef-all": {"displayText":"all","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"all","type":"property","url":"https://drafts.csswg.org/css-cascade-5/#propdef-all"},
"https://drafts.csswg.org/css-cascade-5/#valdef-all-initial": {"displayText":"initial","export":true,"for_":["all"],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"initial","type":"value","url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-initial"},
"https://drafts.csswg.org/css-cascade-5/#valdef-all-revert": {"displayText":"revert","export":true,"for_":["all"],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"revert","type":"value","url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-revert"},
"https://drafts.csswg.org/css-cascade-5/#valdef-all-revert-layer": {"displayText":"revert-layer","export":true,"for_":["all"],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"revert-layer","type":"value","url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-revert-layer"},
"https://drafts.csswg.org/css-cascade-5/#valdef-all-unset": {"displayText":"unset","export":true,"for_":["all"],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"unset","type":"value","url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-unset"},
"https://drafts.csswg.org/css-conditional-5/#funcdef-supports": {"displayText":"supports()","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-conditional","spec":"css-conditional-5","status":"current","text":"supports()","type":"function","url":"https://drafts.csswg.org/css-conditional-5/#funcdef-supports"},
"https://drafts.csswg.org/css-fonts-5/#at-font-face-rule": {"displayText":"@font-face","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-fonts","spec":"css-fonts-5","status":"current","text":"@font-face","type":"at-rule","url":"https://drafts.csswg.org/css-fonts-5/#at-font-face-rule"},
"https://drafts.csswg.org/css-nesting-1/#contain-the-nesting-selector": {"displayText":"contain the nesting selector","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-nesting","spec":"css-nesting-1","status":"current","text":"contain the nesting selector","type":"dfn","url":"https://drafts.csswg.org/css-nesting-1/#contain-the-nesting-selector"},
"https://drafts.csswg.org/css-nesting-1/#nested-declarations-rule%E2%91%A0": {"displayText":"nested declarations rule","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-nesting","spec":"css-nesting-1","status":"current","text":"nested declarations rule","type":"dfn","url":"https://drafts.csswg.org/css-nesting-1/#nested-declarations-rule%E2%91%A0"},
"https://drafts.csswg.org/css-nesting-1/#selectordef-": {"displayText":"&","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-nesting","spec":"css-nesting-1","status":"current","text":"&","type":"selector","url":"https://drafts.csswg.org/css-nesting-1/#selectordef-"},
"https://drafts.csswg.org/css-scoping-1/#tree-context": {"displayText":"tree context","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-scoping","spec":"css-scoping-1","status":"current","text":"tree context","type":"dfn","url":"https://drafts.csswg.org/css-scoping-1/#tree-context"},
"https://drafts.csswg.org/css-syntax-3/#at-rule": {"displayText":"at-rule","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"at-rule","type":"dfn","url":"https://drafts.csswg.org/css-syntax-3/#at-rule"},
"https://drafts.csswg.org/css-syntax-3/#block-at-rule": {"displayText":"block at-rule","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"block at-rule","type":"dfn","url":"https://drafts.csswg.org/css-syntax-3/#block-at-rule"},
"https://drafts.csswg.org/css-syntax-3/#css-rule": {"displayText":"rule","export":true,"for_":["CSS"],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"rule","type":"dfn","url":"https://drafts.csswg.org/css-syntax-3/#css-rule"},
"https://drafts.csswg.org/css-syntax-3/#declaration": {"displayText":"declaration","export":true,"for_":["CSS"],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"declaration","type":"dfn","url":"https://drafts.csswg.org/css-syntax-3/#declaration"},
"https://drafts.csswg.org/css-syntax-3/#qualified-rule": {"displayText":"qualified rule","export":true,"for_":["CSS"],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"qualified rule","type":"dfn","url":"https://drafts.csswg.org/css-syntax-3/#qualified-rule"},
"https://drafts.csswg.org/css-syntax-3/#style-rule": {"displayText":"style rule","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"style rule","type":"dfn","url":"https://drafts.csswg.org/css-syntax-3/#style-rule"},
"https://drafts.csswg.org/css-syntax-3/#typedef-block-contents": {"displayText":"<block-contents>","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<block-contents>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#typedef-block-contents"},
"https://drafts.csswg.org/css-syntax-3/#typedef-rule-list": {"displayText":"<rule-list>","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<rule-list>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#typedef-rule-list"},
"https://drafts.csswg.org/css-values-3/#mult-opt": {"displayText":"?","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-values","spec":"css-values-3","status":"current","text":"?","type":"grammar","url":"https://drafts.csswg.org/css-values-3/#mult-opt"},
"https://drafts.csswg.org/cssom-1/#cssgroupingrule": {"displayText":"CSSGroupingRule","export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"CSSGroupingRule","type":"interface","url":"https://drafts.csswg.org/cssom-1/#cssgroupingrule"},
"https://drafts.csswg.org/cssom-1/#cssomstring": {"displayText":"CSSOMString","export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"CSSOMString","type":"interface","url":"https://drafts.csswg.org/cssom-1/#cssomstring"},
"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations": {"displayText":"declarations","export":true,"for_":["CSSStyleDeclaration"],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"declarations","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations"},
"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node": {"displayText":"owner node","export":true,"for_":["CSSStyleDeclaration"],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"owner node","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node"},
"https://drafts.csswg.org/selectors-4/#descendant-combinator": {"displayText":"descendant combinator","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"descendant combinator","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#descendant-combinator"},
"https://drafts.csswg.org/selectors-4/#featureless": {"displayText":"featureless","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"featureless","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#featureless"},
"https://drafts.csswg.org/selectors-4/#relative-selector": {"displayText":"relative selector","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"relative selector","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#relative-selector"},
"https://drafts.csswg.org/selectors-4/#scope-pseudo": {"displayText":":scope","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":":scope","type":"selector","url":"https://drafts.csswg.org/selectors-4/#scope-pseudo"},
"https://drafts.csswg.org/selectors-4/#scoped-selector": {"displayText":"scoped selector","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"scoped selector","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#scoped-selector"},
"https://drafts.csswg.org/selectors-4/#scoping-root": {"displayText":"scoping root","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"scoping root","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#scoping-root"},
"https://drafts.csswg.org/selectors-4/#selector": {"displayText":"selector","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"selector","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#selector"},
"https://drafts.csswg.org/selectors-4/#selector-combinator": {"displayText":"combinator","export":true,"for_":["selector"],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"combinator","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#selector-combinator"},
"https://drafts.csswg.org/selectors-4/#selector-subject": {"displayText":"subject","export":true,"for_":["selector"],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"subject","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#selector-subject"},
"https://drafts.csswg.org/selectors-4/#specificity": {"displayText":"specificity","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"specificity","type":"dfn","url":"https://drafts.csswg.org/selectors-4/#specificity"},
"https://drafts.csswg.org/selectors-4/#typedef-relative-selector-list": {"displayText":"<relative-selector-list>","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"<relative-selector-list>","type":"type","url":"https://drafts.csswg.org/selectors-4/#typedef-relative-selector-list"},
"https://drafts.csswg.org/selectors-4/#typedef-selector-list": {"displayText":"<selector-list>","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"<selector-list>","type":"type","url":"https://drafts.csswg.org/selectors-4/#typedef-selector-list"},
"https://fetch.spec.whatwg.org/#cors-protocol": {"displayText":"CORS protocol","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"cors protocol","type":"dfn","url":"https://fetch.spec.whatwg.org/#cors-protocol"},
"https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element": {"displayText":"img","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"img","type":"element","url":"https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element"},
"https://html.spec.whatwg.org/multipage/semantics.html#the-style-element": {"displayText":"style","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"style","type":"element","url":"https://html.spec.whatwg.org/multipage/semantics.html#the-style-element"},
"https://webidl.spec.whatwg.org/#Exposed": {"displayText":"Exposed","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Exposed","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Exposed"},
"https://www.w3.org/TR/CSS2/selector.html#x22": {"displayText":"pseudo-elements","export":true,"for_":[],"level":"2","normative":true,"shortname":"css","spec":"css2","status":"snapshot","text":"pseudo-elements","type":"dfn","url":"https://www.w3.org/TR/CSS2/selector.html#x22"},
"https://www.w3.org/TR/css-scoping-1/#shadow-host": {"displayText":"shadow host","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-scoping","spec":"css-scoping-1","status":"snapshot","text":"shadow host","type":"dfn","url":"https://www.w3.org/TR/css-scoping-1/#shadow-host"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const refHintKey = link.getAttribute("data-refhint-key");
    let key = url;
    if(refHintKey) {
        key = refHintKey + "_" + url;
    }
    const ref = refsData[key];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>