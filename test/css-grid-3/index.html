<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>CSS Grid Layout Module Level 3</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 618007319, updated Thu Jun 26 17:23:55 2025 -0700" name="generator">
  <link href="https://www.w3.org/TR/css-grid-3/" rel="canonical">
  <link href="https://drafts.csswg.org/csslogo.ico" rel="icon">
  <meta content="31df7a5eae949e22a2eca536d6373307b5f90fbb" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>
:is(section, p).option {
	border-right: 1em double;
	padding-right: 1em;
}
:is(section, p).option.grid {
	border-right-color: #be2596;
}
:is(section, p).option.masonry {
	border-right-color: #96be25;
}
:is(span, a).option {
	font-weight: bold;
}
:is(span, a).option * {
	color: inherit;
}
:is(span, a).option.grid {
	color: #be2596;
}
:is(span, a).option.masonry {
	color: #658118
}
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-mdn-anno */
:root {
	--mdn-bg: #EEE;
	--mdn-shadow: #999;
	--mdn-nosupport-text: #ccc;
	--mdn-pass: green;
	--mdn-fail: red;
}
@media (prefers-color-scheme: dark) {
	:root {
		--mdn-bg: #222;
		--mdn-shadow: #444;
		--mdn-nosupport-text: #666;
		--mdn-pass: #690;
		--mdn-fail: #d22;
	}
}
.mdn-anno {
	background: var(--mdn-bg, #EEE);
	border-radius: .25em;
	box-shadow: 0 0 3px var(--mdn-shadow, #999);
	color: var(--text, black);
	font: 1em sans-serif;
	hyphens: none;
	max-width: min-content;
	overflow: hidden;
	padding: 0.2em;
	position: absolute;
	right: 0.3em;
	top: auto;
	white-space: nowrap;
	word-wrap: normal;
	z-index: 8;
}
.mdn-anno.unpositioned {
	display: none;
}
.mdn-anno.overlapping-main {
	opacity: .2;
	transition: opacity .1s;
}
.mdn-anno[open] {
	opacity: 1;
	z-index: 9;
	min-width: 9em;
}
.mdn-anno:hover {
	opacity: 1;
	outline: var(--text, black) 1px solid;
}
.mdn-anno > summary {
	font-weight: normal;
	text-align: right;
	cursor: pointer;
	display: block;
}
.mdn-anno > summary > .less-than-two-engines-flag {
	color: var(--mdn-fail);
	padding-right: 2px;
}
.mdn-anno > summary > .all-engines-flag {
	color: var(--mdn-pass);
	padding-right: 2px;
}
.mdn-anno > summary > span {
	color: #fff;
	background-color: #000;
	font-weight: normal;
	font-family: zillaslab, Palatino, "Palatino Linotype", serif;
	padding: 2px 3px 0px 3px;
	line-height: 1.3em;
	vertical-align: top;
}
.mdn-anno > .feature {
	margin-top: 20px;
}
.mdn-anno > .feature:not(:first-of-type) {
	border-top: 1px solid #999;
	margin-top: 6px;
	padding-top: 2px;
}
.mdn-anno > .feature > .less-than-two-engines-text {
	color: var(--mdn-fail);
}
.mdn-anno > .feature > .all-engines-text {
	color: var(--mdn-pass);
}
.mdn-anno > .feature > p {
	font-size: .75em;
	margin-top: 6px;
	margin-bottom: 0;
}
.mdn-anno > .feature > p + p {
	margin-top: 3px;
}
.mdn-anno > .feature > .support {
	display: block;
	font-size: 0.6em;
	margin: 0;
	padding: 0;
	margin-top: 2px;
}
.mdn-anno > .feature > .support + div {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > hr {
	display: block;
	border: none;
	border-top: 1px dotted #999;
	padding: 3px 0px 0px 0px;
	margin: 2px 3px 0px 3px;
}
.mdn-anno > .feature > .support > hr::before {
	content: "";
}
.mdn-anno > .feature > .support > span {
	padding: 0.2em 0;
	display: block;
	display: table;
}
.mdn-anno > .feature > .support > span.no {
	color: var(--mdn-nosupport-text);
	filter: grayscale(100%);
}
.mdn-anno > .feature > .support > span.no::before {
	opacity: 0.5;
}
.mdn-anno > .feature > .support > span:first-of-type {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > span > span {
	padding: 0 0.5em;
	display: table-cell;
}
.mdn-anno > .feature > .support > span > span:first-child {
	width: 100%;
}
.mdn-anno > .feature > .support > span > span:last-child {
	width: 100%;
	white-space: pre;
	padding: 0;
}
.mdn-anno > .feature > .support > span::before {
	content: ' ';
	display: table-cell;
	min-width: 1.5em;
	height: 1.5em;
	background: no-repeat center center;
	background-size: contain;
	text-align: right;
	font-size: 0.75em;
	font-weight: bold;
}
.mdn-anno > .feature > .support > .chrome_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .firefox_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .chrome::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .edge_blink::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
}
.mdn-anno > .feature > .support > .edge::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
}
.mdn-anno > .feature > .support > .firefox::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .ie::before {
	background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
}
.mdn-anno > .feature > .support > .safari_ios::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
}
.mdn-anno > .feature > .support > .nodejs::before {
	background-image: url(https://nodejs.org/favicon.ico);
}
.mdn-anno > .feature > .support > .opera_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .opera::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .safari::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
}
.mdn-anno > .feature > .support > .samsunginternet_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
}
.mdn-anno > .feature > .support > .webview_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
}
.name-slug-mismatch {
	color: red;
}
.caniuse-status:hover {
	z-index: 9;
}
/* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */;
.h-entry:not(.status-LS) dt > .mdn-anno, .h-entry:not(.status-LS) li > .mdn-anno, .h-entry:not(.status-LS) .issue > .mdn-anno, .h-entry:not(.status-LS) .note > .mdn-anno, .h-entry:not(.status-LS) .example > .mdn-anno {
	right: -6.7em;
}
.h-entry p + .mdn-anno {
	margin-top: 0;
}
 h2 + .mdn-anno.after {
	margin: -48px 0 0 0;
}
 h3 + .mdn-anno.after {
	margin: -46px 0 0 0;
}
 h4 + .mdn-anno.after {
	margin: -42px 0 0 0;
}
 h5 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
 h6 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-wpt */
:root {
    --wpt-border: hsl(0, 0%, 60%);
    --wpt-bg: hsl(0, 0%, 95%);
    --wpt-text: var(--text);
    --wptheading-text: hsl(0, 0%, 30%);
}
@media (prefers-color-scheme: dark) {
    :root {
        --wpt-border: hsl(0, 0%, 30%);
        --wpt-bg: var(--borderedblock-bg);
        --wpt-text: var(--text);
        --wptheading-text: hsl(0, 0%, 60%);
    }
}
.wpt-tests-block {
    list-style: none;
    border-left: .5em solid var(--wpt-border);
    background: var(--wpt-bg);
    color: var(--wpt-text);
    margin: 1em auto;
    padding: .5em;
}
.wpt-tests-block summary {
    color: var(--wptheading-text);
    font-weight: normal;
    text-transform: uppercase;
}
.wpt-tests-block summary::marker{
    color: var(--wpt-border);
}
.wpt-tests-block summary:hover::marker{
    color: var(--wpt-text);
}
/*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
.wpt-tests-block:not([open]){
    padding: 0;
    border: none;
    background: none;
    font-size: 0.75em;
    line-height: 1;
    position: relative;
    margin: 1em 0 0;
}
.wpt-tests-block:not([open]) summary {
    position: absolute;
    right: 0;
    bottom: 0;
}
/*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
.wpt-tests-block:not([open]):last-child {
    padding-bottom: 1px;
    margin-bottom: -1px;
}
/*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
li:not(:last-child) > .wpt-tests-block:not([open]):last-child,
dd:not(:last-child) > .wpt-tests-block:not([open]):last-child {
    padding-bottom: 0;
    margin-bottom: 0;
}
.wpt-tests-block:not([open]):not(:hover){
    opacity: 0.5;
}
.wpt-tests-list {
    list-style: none;
    display: grid;
    margin: 0;
    padding: 0;
    grid-template-columns: 1fr max-content auto auto;
    grid-column-gap: .5em;
}
.wpt-tests-block hr:last-child {
    display: none;
}
.wpt-test {
    display: contents;
}
.wpt-test > a {
    text-decoration: underline;
    border: none;
}
.wpt-test > .wpt-name { grid-column: 1; }
.wpt-test > .wpt-results { grid-column: 2; }
.wpt-test > .wpt-live { grid-column: 3; }
.wpt-test > .wpt-source { grid-column: 4; }

.wpt-test > .wpt-results {
    display: flex;
    gap: .1em;
}
.wpt-test .wpt-result {
    display: inline-block;
    height: 1em;
    width: 1em;
    border-radius: 50%;
    position: relative;
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
</a>
</p>
   <h1 class="p-name no-ref" id="title">CSS Grid Layout Module Level 3</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>,
    <time class="dt-updated" datetime="2025-02-21">21 February 2025</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://drafts.csswg.org/css-grid-3/">https://drafts.csswg.org/css-grid-3/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/css-grid-3/">https://www.w3.org/TR/css-grid-3/</a>
      <dt>Feedback:
      <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-grid-3">CSSWG Issues Repository</a>
      <dd><a href="#issues-index">Inline In Spec</a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url" href="http://www.xanthir.com/contact/">Tab Atkins Jr.</a> (<span class="p-org org">Google</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="35400"><a class="p-name fn u-url url" href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a> (<span class="p-org org">Apple</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="52801"><a class="p-name fn u-url url" href="http://jensimmons.com/">Jen Simmons</a> (<span class="p-org org">Apple</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="138640"><a class="p-name fn u-url url" href="https://brandonstewart.net">Brandon Stewart</a> (<span class="p-org org">Apple</span>)
      <dt class="editor">Former Editor:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mailto:mats@mozilla.com">Mats Palmgren</a> (<span class="p-org org">Mozilla</span>)
      <dt>Suggest an Edit for this Spec:
      <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-grid-3/Overview.bs">GitHub Editor</a>
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply.
</p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This module introduces masonry layout as an additional layout mode for <a href="https://www.w3.org/TR/css-grid-2/">CSS Grid</a> containers.</p>
   


<a href="https://www.w3.org/TR/CSS/">CSS</a> is a language for describing the rendering of structured documents
(such as HTML and XML)
on screen, on paper, etc.


  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p>Please send feedback
	by <a href="https://github.com/w3c/csswg-drafts/issues">filing issues in GitHub</a> (preferred),
	including the spec code “css-grid” in the title, like this:
	“[css-grid] <i>…summary of comment…</i>”.
	All issues and comments are <a href="https://lists.w3.org/Archives/Public/public-css-archive/">archived</a>.
	Alternately, feedback can be sent to the (<a href="https://lists.w3.org/Archives/Public/www-style/">archived</a>) public mailing list
	<a href="mailto:www-style@w3.org?Subject=%5Bcss-grid%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>.

</p>
   <p>This document is governed by the
	<a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>.

</p>
   <p><strong>This specification represents two variations on the proposal for masonry layout. Feedback on the alternatives is welcome.</strong></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">
Introduction</span></a>
     <ol class="toc">
      <li>
       <a href="#background"><span class="secno">1.1</span> <span class="content">
Background and Motivation</span></a>
       <ol class="toc">
        <li><a href="#waterfall"><span class="secno">1.1.1</span> <span class="content">
Waterfall Layout with Auto-placed Items</span></a>
        <li><a href="#collapse"><span class="secno">1.1.2</span> <span class="content">
One-dimensional Grid Layout</span></a>
       </ol>
      <li><a href="#values"><span class="secno">1.2</span> <span class="content">
Value Definitions</span></a>
     </ol>
    <li>
     <a href="#masonry-model"><span class="secno">2</span> <span class="content">
Masonry Layout Model</span></a>
     <ol class="toc">
      <li><a href="#order-accessibility"><span class="secno">2.1</span> <span class="content">
Reordering and Accessibility</span></a>
      <li><a href="#masonry-switch"><span class="secno">2.2</span> <span class="content">
Establishing Masonry Layout</span></a>
     </ol>
    <li>
     <a href="#masonry-track-templates"><span class="secno">3</span> <span class="content">
Masonry Track Specification</span></a>
     <ol class="toc">
      <li>
       <a href="#masonry-track-grid-option"><span class="secno">3.1</span> <span class="content">
Declaring Masonry Track Templates: the <span class="css">grid-template-*</span> properties</span></a>
       <ol class="toc">
        <li><a href="#masonry-intrinsic-repeat"><span class="secno">3.1.1</span> <span class="content">
Intrinsic Tracks and repeat()</span></a>
       </ol>
      <li><a href="#subgrids"><span class="secno">3.2</span> <span class="content">
Subgrids</span></a>
      <li>
       <a href="#repeat-notation"><span class="secno">3.3</span> <span class="content">
Track Repetition: the <span class="css">repeat()</span> notation</span></a>
       <ol class="toc">
        <li><a href="#repeat-auto-areas"><span class="secno">3.3.1</span> <span class="content">
repeat(auto-areas)</span></a>
        <li><a href="#repeat-auto-fit"><span class="secno">3.3.2</span> <span class="content">
repeat(auto-fit)</span></a>
       </ol>
      <li>
       <a href="#track-sizing"><span class="secno">3.4</span> <span class="content">
Grid Axis Track Sizing</span></a>
       <ol class="toc">
        <li><a href="#track-sizing-subgrid"><span class="secno">3.4.1</span> <span class="content">
Subgrid Item Contributions</span></a>
        <li><a href="#track-sizing-performance"><span class="secno">3.4.2</span> <span class="content">
Optimized Track Sizing</span></a>
       </ol>
     </ol>
    <li>
     <a href="#masonry-track-placement"><span class="secno">4</span> <span class="content">
Masonry Placement</span></a>
     <ol class="toc">
      <li><a href="#masonry-placement-grid-option"><span class="secno">4.1</span> <span class="content">
Specifying Masonry Item Placement: the <span class="css">grid-column-*</span> and <span class="css">grid-row-*</span> properties</span></a>
      <li><a href="#item-slack"><span class="secno">4.2</span> <span class="content">
Placement Precision: the <span class="property">item-slack</span> property</span></a>
      <li>
       <a href="#masonry-layout-algorithm"><span class="secno">4.3</span> <span class="content">
Masonry Layout and Placement Algorithm</span></a>
       <ol class="toc">
        <li><a href="#containing-block"><span class="secno">4.3.1</span> <span class="content">
Containing Block</span></a>
        <li><a href="#rtl-example"><span class="secno">4.3.2</span> <span class="content">
Placement and Writing Modes</span></a>
       </ol>
     </ol>
    <li><a href="#intrinsic-sizes"><span class="secno">5</span> <span class="content">
Sizing Grid Containers</span></a>
    <li>
     <a href="#alignment"><span class="secno">6</span> <span class="content">
Alignment and Spacing</span></a>
     <ol class="toc">
      <li><a href="#masonry-axis-baseline-alignment"><span class="secno">6.1</span> <span class="content">
Baseline Alignment in the stacking axis</span></a>
     </ol>
    <li>
     <a href="#pagination"><span class="secno">7</span> <span class="content">
Fragmentation</span></a>
     <ol class="toc">
      <li><a href="#masonry-axis-pagination"><span class="secno">7.1</span> <span class="content">
Fragmentation in the stacking axis</span></a>
      <li><a href="#grid-axis-pagination"><span class="secno">7.2</span> <span class="content">
Fragmentation in the Grid Axis</span></a>
     </ol>
    <li><a href="#abspos"><span class="secno">8</span> <span class="content">
Absolute Positioning</span></a>
    <li><a href="#graceful-degradation"><span class="secno">9</span> <span class="content">
Graceful Degradation</span></a>
    <li>
     <a href="#flow-control"><span class="secno"></span> <span class="content">
Appendix A: Generic Layout Item Flow Controls: the <span class="css">item-*</span> properties</span></a>
     <ol class="toc">
      <li><a href="#item-primary-axis"><span class="secno"></span> <span class="content">
Item Flow Axis: <span class="property">item-track</span>/<span class="property">item-direction</span></span></a>
      <li><a href="#item-secondary-axis"><span class="secno"></span> <span class="content">
Item Cross Axis Placement Mode: <span class="property">item-cross</span>/<span class="property">item-wrap</span></span></a>
      <li><a href="#item-pack-options"><span class="secno"></span> <span class="content">
Item Placement Packing Mode: the <span class="property">item-pack</span> property</span></a>
      <li><a href="#item-flow"><span class="secno"></span> <span class="content">
Item Placement Shorthand: the <span class="property">item-flow</span> shorthand</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">10</span> <span class="content">
Acknowledgements</span></a>
    <li><a href="#security"><span class="secno">11</span> <span class="content">
Security Considerations</span></a>
    <li><a href="#privacy"><span class="secno">12</span> <span class="content">
Privacy Considerations</span></a>
    <li>
     <a href="#changes"><span class="secno"></span> <span class="content">
Changes</span></a>
     <ol class="toc">
      <li><a href="#changes-3"><span class="secno"></span> <span class="content">
Additions Since Level 2</span></a>
      <li><a href="#recent-changes"><span class="secno"></span> <span class="content">
Recent Changes</span></a>
     </ol>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">
Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">
Document conventions</span></a>
      <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
Conformance classes</span></a>
      <li>
       <a href="#w3c-partial"><span class="secno"></span> <span class="content">
Partial implementations</span></a>
       <ol class="toc">
        <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span class="content">
Implementations of Unstable and Proprietary Features</span></a>
       </ol>
      <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">
Non-experimental implementations</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#property-index"><span class="secno"></span> <span class="content">Property Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">
Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>Grid Layout is a layout model for CSS
	that has powerful abilities to control the sizing and positioning
	of boxes and their contents.
	Grid Layout is optimized for 2-dimensional layouts:
	those in which alignment of content is desired in both dimensions.</p>
   <figure>
    
		<img alt="An example of grid layout:
		     two rows of items,
		     the first being four items — the last of which spans both rows,
		     and the second being two items —
		     the first of which spans the first two columns —
		     plus the spanned item from the first row." height="70" src="images/grid-layout.png" width="486">
		
    <figcaption>Representative Grid layout example</figcaption>
   </figure>
   <p>Although many layouts can be expressed with regular Grid Layout,
	restricting items into a grid in both axes also makes it impossible
	to express some common layouts on the Web.</p>
   <p>This module defines a layout system that removes that restriction
	so that items can be placed into Grid-like tracks in just one of the axes,
	while stacking them one after another in the other axis.
	Items are placed into the column (or row) with the most remaining space
	based on the layout size of the items placed so far.
	This module also extends <a href="https://www.w3.org/TR/css-grid-2/">CSS Grid</a>
	with this new grid item placement strategy
	and <a href="https://drafts.csswg.org/css-align">CSS Box Alignment</a> with new alignment features.</p>
   <h3 class="heading settled" data-level="1.1" id="background"><span class="secno">1.1. </span><span class="content">
Background and Motivation</span><a class="self-link" href="#background"></a></h3>
   <h4 class="heading settled" data-level="1.1.1" id="waterfall"><span class="secno">1.1.1. </span><span class="content">
Waterfall Layout with Auto-placed Items</span><a class="self-link" href="#waterfall"></a></h4>
   <p><a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout">Masonry layout</a>, sometimes also called “waterfall layout”,
	is a common Web design pattern where a number of items—​commonly images or short article summaries—​are placed one by one into columns
	in a way that loosely resembles stone masonry.
	Unlike <a data-link-type="biblio" href="#biblio-css-multicol-1" title="CSS Multi-column Layout Module Level 1">multi-column layout</a>,
	where content is placed vertically in the first column
	until it must spills over to the second column,
	<span id="ref-for-masonry-layout①">masonry layout</span> selects a column for each new item
	such that it is generally closer to the top of the layout than items placed later.</p>
   <div class="example" id="example-38d5cc14">
    <a class="self-link" href="#example-38d5cc14"></a>
		The Pinterest search results page exemplifies this layout:

		
    <figure>
     
			<img alt="An example of masonry layout:
			          four columns of items,
			          each item is placed into the column with the smallest height so far." height="867" src="images/pinterest.png" width="1105">
			
     <figcaption>Representative masonry layout example</figcaption>
    </figure>
    <p>Here, each item has a different height
		(depending on the content and the width of the column),
		and inspecting the DOM reveals
		(as the visual content itself gives no indication of ordering)
		that each item has been placed into the column with the smallest height so far.</p>
   </div>
   <p>This layout superficially looks similar to multi-column layout;
	but it has the advantage that scrolling down
	will naturally lead to "later" items in the layout
	(that is, those less relevant in the search results).</p>
   <p>It’s not possible to achieve this layout using earlier CSS layout models,
	unless you know up-front how tall each item will be,
	or use JavaScript for content measurement or placement.</p>
   <p>Using a <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container">masonry container</a> together with <span class="css">auto</span>-positioned items
	yields this type of masonry layout.</p>
   <h4 class="heading settled" data-level="1.1.2" id="collapse"><span class="secno">1.1.2. </span><span class="content">
One-dimensional Grid Layout</span><a class="self-link" href="#collapse"></a></h4>
   <p><a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout">Grid layout</a> allows for powerful track sizing and explicit placement in two axes,
	but sometimes a layout only needs alignment of its items in one dimension.</p>
   <p>Using a <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①">masonry container</a> together with explicitly-positioned items
	allows for this type of one-dimensional grid layout.</p>
   <div class="example" id="example-a1b07c6f">
    <a class="self-link" href="#example-a1b07c6f"></a>
		This example <a href="https://github.com/w3c/csswg-drafts/issues/10233#issuecomment-2071279204">by Douglas Graham</a>
		uses explicit positioning to place each item into its assigned column;
		but there are no rows.
		Instead, items in each column stack one after the other.
		This layout can’t be duplicated in <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout①">grid layout</a>
		because the “spanning” relationships among the items in adjacent columns
		is not fixed: it depends on their relative heights
		and whether the optional banner or advertisement items are included.
		It also can’t be duplicated in <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout">flex layout</a>
		because the source order of the items
		(which is used for reading, sequential navigation, and one-column mobile phone layout)
		goes back and forth between the two columns.

		
    <figure>
     
			<img alt="In one-column layout:
			          the header, followed by an optional banner, the secondary navigation,
			          the main content area, an advertisement block, and finally the footer.
			          In two-column layout:
			          the header spanning both columns on top,
			          the footer spanning both columns at the bottom,
			          in the wider left column the optional banner followed by the main content area,
			          and in the narrow left column the secondary navigation followed by the advertisement block." height="492" src="images/masonry-page-layout.png" width="731">
			
     <figcaption>
				Comparison of one-column and two-column variants of a one-dimensional grid layout.
			</figcaption>
    </figure>
   </div>
   <h3 class="heading settled" data-level="1.2" id="values"><span class="secno">1.2. </span><span class="content">
Value Definitions</span><a class="self-link" href="#values"></a></h3>
   <p>This specification follows the <a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSS property definition conventions</a> from <a data-link-type="biblio" href="#biblio-css2" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>
	using the <a href="https://www.w3.org/TR/css-values-3/#value-defs">value definition syntax</a> from <a data-link-type="biblio" href="#biblio-css-values-3" title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</a>.
	Value types not defined in this specification are defined in CSS Values &amp; Units <span title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span>.
	Combination with other CSS modules may expand the definitions of these value types.</p>
   <p>In addition to the property-specific values listed in their definitions,
	all properties defined in this specification
	also accept the <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-4/#css-wide-keywords" id="ref-for-css-wide-keywords">CSS-wide keywords</a> as their property value.
	For readability they have not been repeated explicitly.</p>
   <h2 class="heading settled" data-level="2" id="masonry-model"><span class="secno">2. </span><span class="content">
Masonry Layout Model</span><a class="self-link" href="#masonry-model"></a></h2>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="masonry-layout">Masonry layout</dfn>
	lays out items into pre-defined tracks similar to <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout②">grid layout</a> in one axis
	(called the <dfn class="dfn-paneled" data-dfn-type="dfn" data-local-lt="grid-axis" data-noexport id="grid-axis">grid axis</dfn>),
	but flows them freely similar to <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout①">flex layout</a> in the other
	(called the <dfn class="dfn-paneled" data-dfn-type="dfn" data-local-lt="stacking-axis" data-noexport id="stacking-axis">stacking axis</dfn>).
	Similar to <span id="ref-for-grid-layout③">grid layout</span> and unlike <span id="ref-for-flex-layout②">flex layout</span>,
	<a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout②">masonry layout</a>’s auto-placement
	distributes items across the tracks  to keep the lengths of those tracks
	as similar as possible.</p>
   <p><a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item">Grid items</a> are formed and <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-4/#blockify" id="ref-for-blockify">blockified</a>
	exactly the same as in a regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container">grid container</a>.</p>
   <p>(For clarity, <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item①">grid items</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-track" id="ref-for-grid-track">grid tracks</a> of a <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container②">masonry container</a>
	can be referred to as <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="masonry item" id="masonry-item">masonry items</dfn>
	and <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="masonry track" id="masonry-track">masonry tracks</dfn>.)</p>
   <p>All CSS properties work the same as in a regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container①">grid container</a>
	unless otherwise specified by this specification.
	For example, <a class="property css" data-link-type="property" href="https://www.w3.org/TR/css-flexbox-1/#propdef-order" id="ref-for-propdef-order">order</a> can be used to specify a different layout order for the items.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Subgrid items are supported,
	but subgridding only occurs in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis">grid axis</a>;
	see <a href="#subgrids">§ 3.2 Subgrids</a> for details.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="masonry-container">masonry container</dfn> is a box whose contents participate in <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout③">masonry layout</a>.
	A <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container③">masonry container</a> is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="column-masonry-container">column masonry container</dfn>
	if its <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis">stacking axis</a> is the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis">block axis</a>,
	or a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="row-masonry-container">row masonry container</dfn>
	if its <span id="ref-for-stacking-axis①">stacking axis</span> is the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-axis" id="ref-for-inline-axis">inline axis</a>.</p>
   <table class="data">
    <caption>Comparing Masonry Containers</caption>
    <tbody>
     <tr>
      <th style="writing-mode: vertical-rl; writing-mode: sideways-lr">
				Column Masonry
			
      <td>
<pre>grid-template-columns: 1fr 2fr 3fr;
</pre>
      <td>
				<img alt="Column masonry lays out items in columns,
					     but ordered across the columns,
					     placing each item in the then-shortest column." height="146" src="images/masonry-columns.png" width="216">
		
     <tr>
      <th style="writing-mode: vertical-rl; writing-mode: sideways-lr">
				Row Masonry
			
      <td>
<pre>grid-template-rows: 1fr 2fr 3fr;
</pre>
      <td>
				<img alt="Row masonry lays out items in rows,
					     but ordered down across the rows,
					     placing each item in the then-shortest row." height="214" src="images/masonry-rows.png" width="143">
	
   </table>
   <h3 class="heading settled" data-level="2.1" id="order-accessibility"><span class="secno">2.1. </span><span class="content">
Reordering and Accessibility</span><a class="self-link" href="#order-accessibility"></a></h3>
   <p>Although <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout④">masonry layout</a> generally progresses in a forwards fashion
	(placing the next item down or endward of the current item,
	matching the natural "reading order"),
	it can switch between these two in a seemingly arbitrary manner.
	In simple cases, the <a class="property css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack">item-slack</a> property can help reduce
	the feeling of backtracking due to small sizing differences in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis①">block axis</a>
	when laying out auto-placed items.
	But when <a href="#masonry-layout-algorithm">auto-placement</a> is mixed with <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#definite-grid-position" id="ref-for-definite-grid-position">explicit placement</a> or spanning items,
	some amount of backtracking may occur.</p>
   <div class="example" id="example-6f3951ba">
    <a class="self-link" href="#example-6f3951ba"></a>
		For example, in the following markup sample,
		the fourth item is a spanner that doesn’t fit
		in the remaining empty column on the first line.
		It ends up positioned into the into the first column,
		which is the highest available space into which it will fit.
		The next few items, which have a span of 1,
		end up laying out “above” it in the empty column,
		violating the natural reading order.

		
<pre class="highlight"><c- p>&lt;</c-><c- f>section</c-> <c- e>class</c-><c- o>=</c-><c- s>masonry</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>item</c-><c- p>></c->1<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>item</c-><c- p>></c->2<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"item tall"</c-><c- p>></c->3<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"item wide"</c-><c- p>></c->4<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>item</c-><c- p>></c->5<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>item</c-><c- p>></c->6<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>item</c-><c- p>></c->7<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>section</c-><c- p>></c->
<c- p>&lt;</c-><c- f>style</c-><c- p>></c->
<c- p>.</c-><c- nc>masonry</c-> <c- p>{</c->
  //FIXME <c- k>display</c-><c- p>:</c-><c- n>masonry</c-> <c- n>or</c-> <c- n>something</c->
  <c- k>grid-template-columns</c-><c- o>:</c-> <c- nf>repeat</c-><c- p>(</c-><c- mi>5</c-><c- p>,</c-> <c- kc>auto</c-><c- p>);</c->
<c- p>}</c->
<c- p>.</c-><c- nc>item</c-> <c- p>{</c-> <c- k>height</c-><c- p>:</c-> <c- mi>50</c-><c- b>px</c-><c- p>;</c-> <c- p>}</c->
<c- p>.</c-><c- nc>item</c-><c- p>.</c-><c- nc>wide</c-> <c- p>{</c-> <c- k>grid-column</c-><c- p>:</c-> <c- n>span</c-> <c- mi>3</c-><c- p>;</c-> <c- p>}</c->
<c- p>.</c-><c- nc>item</c-><c- p>.</c-><c- nc>tall</c-> <c- p>{</c-> <c- k>height</c-><c- p>:</c-> <c- mi>90</c-><c- b>px</c-><c- p>;</c-> <c- p>}</c->
<c- p>&lt;/</c-><c- f>style</c-><c- p>></c->
</pre>
    <figure>
     
			<img alt="In this example, the first row is items 1, 2, 3, 5, 6,
			          with item 3 slightly taller than the others.
			          Item 4 spans the first three columns, and is placed
			          just below item 3, while item 7 is tucked under item 5." height="214" src="images/masonry-reorder-span.png" width="514">
			
     <figcaption>Auto-placed masonry layout with mixed-height items and mixed span sizes</figcaption>
    </figure>
    
		Similarly, items explicitly placed into specific tracks can leave gaps behind them,
		into which subsequent auto-placed items can be placed visually out-of-order.
	
   </div>
   <p>Authors should be aware of these possibilities
	and design layouts where such backtracking is minimized
	so that focus and reading order can be more easily followed.
	Alternatively, if the items do not have an inherent order,
	use the <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-display-4/#propdef-reading-flow" id="ref-for-propdef-reading-flow">reading-flow</a> property to allow the UA to re-order the items
	for reading and linear navigation.</p>
   <p class="issue" id="issue-f3901e05"><a class="self-link" href="#issue-f3901e05"></a> Or should reordering be the default behavior for auto-placed items here?</p>
   <div class="note" role="note">
    
		Techniques for reducing backtracking include:

    <ul>
     <li data-md>
      <p>Using appropriate values for <a class="property css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack①">item-slack</a>,
i.e. values large enough to avoid gratuitous differentiation among similarly-sized tracks,
but not so large that meaningful differences get ignored.</p>
     <li data-md>
      <p>Using explicit placement in ways that help group related items together,
rather than ways that disrupt the natural order of items</p>
     <li data-md>
      <p>Avoiding the combination of mixed span sizes in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①">grid axis</a>
and disparate item sizes in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis②">stacking axis</a>,
which can cause items to get pulled out of order (see example above).</p>
    </ul>
   </div>
   <p>As with <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout④">grid layout</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout③">flex layout</a>
	authors can use the <a class="property css" data-link-type="property" href="https://www.w3.org/TR/css-flexbox-1/#propdef-order" id="ref-for-propdef-order①">order</a> property to re-order items;
	the same caveats apply.
	See <a href="https://drafts.csswg.org/css-grid-2/#order-accessibility"><cite>CSS Grid Layout 2</cite> § 4 Reordering and Accessibility</a>
	and <a href="https://www.w3.org/TR/css-flexbox-1/#order-accessibility"><cite>CSS Flexbox 1</cite> § 5.4.1 Reordering and Accessibility</a>.</p>
   <h3 class="heading settled" data-level="2.2" id="masonry-switch"><span class="secno">2.2. </span><span class="content">
Establishing Masonry Layout</span><a class="self-link" href="#masonry-switch"></a></h3>
   <div class="issue" id="issue-65868180">
    <a class="self-link" href="#issue-65868180"></a>
	ISSUE(11593): We are still debating what syntactic switch establishes a <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout⑤">masonry layout</a>.
		Proposals so far include:

    <ul>
     <li data-md>
      <p><a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-display-4/#propdef-display" id="ref-for-propdef-display">display: masonry</a> (or a synonym, such as <span class="css" id="ref-for-propdef-display①">display: stack</span>)</p>
     <li data-md>
      <p><a class="css" data-link-type="propdesc" href="#propdef-item-pack" id="ref-for-propdef-item-pack">item-pack: collapse</a> (see <span class="property" id="ref-for-propdef-item-pack①">item-pack</span>)</p>
     <li data-md>
      <p>a <span class="css">collapse</span> value for <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-rows" id="ref-for-propdef-grid-template-rows">grid-template-rows</a>/<a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-columns" id="ref-for-propdef-grid-template-columns">grid-template-columns</a>,
indicating that axis as the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis③">stacking axis</a> of a <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②">grid container</a></p>
    </ul>
   </div>
   <h2 class="heading settled" data-level="3" id="masonry-track-templates"><span class="secno">3. </span><span class="content">
Masonry Track Specification</span><a class="self-link" href="#masonry-track-templates"></a></h2>
   <p>In the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②">grid axis</a>,
	the full power of <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout⑤">grid layout</a> is available for track specification:</p>
   <ul>
    <li data-md>
     <p>Track sizes, line names, and areas can be specified on the <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container④">masonry container</a>’s <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis③">grid axis</a>,
just like in <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout⑥">grid layout</a>.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#explicit-grid" id="ref-for-explicit-grid">explicit grid</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#implicit-grid" id="ref-for-implicit-grid">implicit grid</a> are formed in the same way as for a regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container③">grid container</a>.</p>
    <li data-md>
     <p>Items can be <a href="#masonry-track-placement">placed</a> against these grid templates just as in <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout⑦">grid layout</a>.</p>
   </ul>
   <p>However,
	auto-placed items contribute sizing to all tracks,
	not just the track into which they are ultimately placed;
	see <a href="#track-sizing">§ 3.4 Grid Axis Track Sizing</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> This is because auto-placed items must be laid out <em>as</em> they are placed,
	so that each track knows how “full” it is
	(and therefore which track should receive the next auto-placed item);
	thus, the tracks themselves must already have a definite size
	so that the items know their <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#available" id="ref-for-available">available space</a> during layout.</p>
   <h3 class="heading settled" data-level="3.1" id="masonry-track-grid-option"><span class="secno">3.1. </span><span class="content">
Declaring Masonry Track Templates: the <span class="css">grid-template-*</span> properties</span><a class="self-link" href="#masonry-track-grid-option"></a></h3>
   <p>The <span class="css">grid-template-*</span> and <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-rows" id="ref-for-propdef-grid-auto-rows">grid-auto-rows</a>/<a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-columns" id="ref-for-propdef-grid-auto-columns">grid-auto-columns</a> properties
	(and their shorthands)
	apply in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis④">grid axis</a> of the <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container⑤">masonry container</a>
	and establish tracks just as on regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container④">grid containers</a>.
	(They are ignored in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis④">stacking axis</a>.)</p>
   <p class="issue" id="issue-f0b2f95f"><a class="self-link" href="#issue-f0b2f95f"></a> What should be the initial track listing? <a href="https://github.com/w3c/csswg-drafts/issues/10869">[Issue #10869]</a></p>
   <h4 class="heading settled" data-level="3.1.1" id="masonry-intrinsic-repeat"><span class="secno">3.1.1. </span><span class="content">
Intrinsic Tracks and repeat()</span><a class="self-link" href="#masonry-intrinsic-repeat"></a></h4>
   <p class="issue" id="issue-b1e94dcd"><a class="self-link" href="#issue-b1e94dcd"></a> Should we allow auto-repeated content-based tracks?
	Is this a reasonable definition for them?
	Should they work also in Grid Layout somehow? <a href="https://github.com/w3c/csswg-drafts/issues/10915">[Issue #10915]</a></p>
   <p>In Grid Layout,
	all <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item②">grid items</a> are placed in the grid
	<em>before</em> the grid tracks are sized.
	This implies that <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fill" id="ref-for-valdef-repeat-auto-fill">auto-fill</a>/<a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit" id="ref-for-valdef-repeat-auto-fit">auto-fit</a> repetition
	can’t include intrinsically sized tracks such as <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-auto" id="ref-for-valdef-grid-template-columns-auto">auto</a>
	(either in the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat" id="ref-for-funcdef-repeat-line-color-repeat">repeat()</a> function <em>or</em> alongside it
	in the fixed portion of the track list),
	as that would require the layout algorithm
	to have already determined which items would go in those tracks,
	to determine how large the tracks are,
	to determine how many repetitions fit in the available space.</p>
   <p>In Masonry Layout,
	as <a data-link-type="dfn" href="#masonry-item" id="ref-for-masonry-item">masonry item</a> placement and layout are intertwined and somewhat simplified,
	this restriction is no longer strictly required.
	It requires a slightly heuristic definition of sizing,
	but auto repetition <em>can</em> include intrinsically-sized tracks
	in a <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container⑥">masonry container</a>
	(and the initial value of <u class="property link-error" data-lt="masonry-template-tracks" title="LINK ERROR: No &apos;property&apos; refs found for &apos;masonry-template-tracks&apos;.">masonry-template-tracks</u> uses this!).</p>
   <div class="algorithm" data-algorithm="determine intrinsic repetitions">
    
		To determine the number of repetitions
		that a <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat" id="ref-for-funcdef-repeat-line-color-repeat①">repeat()</a> function resolves to,
		run layout as defined in <a href="#track-sizing-performance">§ 3.4.2 Optimized Track Sizing</a>,
		with the following changes:


    <ul>
     <li data-md>
      <p>Expand <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fill" id="ref-for-valdef-repeat-auto-fill①">auto-fill</a>/<a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit" id="ref-for-valdef-repeat-auto-fit①">auto-fit</a> repeat functions once.</p>
     <li data-md>
      <p>Ignore item placement.
(That is, assume all items have <u class="css link-error" data-lt="masonry-track" title="LINK ERROR: No &apos;propdesc&apos; refs found for &apos;masonry-track&apos;.">masonry-track: auto</u>.)</p>
     <li data-md>
      <p>If a <a data-link-type="dfn" href="#masonry-item" id="ref-for-masonry-item①">masonry item</a> has a span larger than 1,
then for each of its intrinsic sizes
that it would contribute to the <a data-link-type="dfn" href="#virtual-masonry-item" id="ref-for-virtual-masonry-item">virtual masonry item</a>,
first subtract the combined size of the gaps it would span,
and divide by its span.
Then treat it as being a span-1 item with those sizes.</p>
    </ul>
    <p>Any intrinsically-sized tracks are then treated as having the size
		calculated by this simplified layout
		(including those in <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat" id="ref-for-funcdef-repeat-line-color-repeat②">repeat()</a> arguments,
		taking from their corresponding single repetition)
		for the purpose of determining how many repetitions
		the <span class="css" id="ref-for-funcdef-repeat-line-color-repeat③">repeat()</span> functions resolve to.</p>
   </div>
   <details class="note">
    <summary>Motivation</summary>
    <p>This simplified layout heuristic is defined to be "good enough",
		while remaining fast and consistent.</p>
    <p>Ignoring placement is required just to make the concept coherent;
		before you know how many repetitions you need,
		you can’t tell what track an item with a definite placement
		will end up in.</p>
    <p>By chopping spanning items into span-1 items,
		this avoids the possible need to expand a repeat() multiple times,
		and the incoherent possibility of getting different sizes
		for the same keyword across the repetitions.</p>
    <p>It also makes the layout as a whole significantly cheaper,
		as you only need to consider each unique track size;
		you don’t even <em>really</em> need to do any repeat() expansion.
		That is, in <span class="css">auto repeat(auto-fill, min-content auto)</span>,
		both of the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-auto" id="ref-for-valdef-grid-template-columns-auto①">auto</a> keywords
		will resolve to the same size under this heuristic layout;
		you can just figure out what
		a <u class="css link-error" data-lt="masonry-template-tracks" title="LINK ERROR: No &apos;propdesc&apos; refs found for &apos;masonry-template-tracks&apos;.">masonry-template-tracks: auto</u>
		and <u class="css link-error" data-lt="masonry-template-tracks" title="LINK ERROR: No &apos;propdesc&apos; refs found for &apos;masonry-template-tracks&apos;.">masonry-template-tracks: min-content</u>
		would each result in,
		and use those sizes.</p>
   </details>
   <h3 class="heading settled" data-level="3.2" id="subgrids"><span class="secno">3.2. </span><span class="content">
Subgrids</span><a class="self-link" href="#subgrids"></a></h3>
   <p><a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#subgrid" id="ref-for-subgrid">Subgridding</a> allows nested <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container⑦">masonry containers</a> (and <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container⑤">grid containers</a>)
	to share track sizes.
	If the parent’s corresponding axis is a <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis⑤">grid axis</a>,
	the subgridded axis is taken from the parent container
	<a href="https://drafts.csswg.org/css-grid-2/#subgrids">as specified for grid containers</a>;
	if the parent’s corresponding axis is a <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis⑤">stacking axis</a>,
	the subgridded axis acts like <span class="css">masonry</span>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> If this results in <span class="css">masonry</span> in both axes,
	it is resolved as normal for <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container⑧">masonry containers</a> with double-axis <span class="css">masonry</span> templates,
	i.e. it acts like <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-columns" id="ref-for-propdef-grid-template-columns①">grid-template-columns: none; grid-template-rows: masonry</a>.</p>
   <p>In <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout⑥">masonry layout</a>, auto-placed <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#subgrid" id="ref-for-subgrid①">subgrids</a>
	don’t inherit any line names from their parent grid,
	because that would make the placement of the item
	dependent on layout results;
	but the subgrid’s tracks are still aligned to the parent’s tracks as usual.</p>
   <div class="example" id="example-1cdd55da">
    <a class="self-link" href="#example-1cdd55da"></a>
		Here’s a subgrid <a href="examples/subgrid-example-1.html">example</a>:

		
<pre class="language-css highlight">&lt;style>
.grid <c- p>{</c->
  //FIXME: display: inline-grid<c- p>;</c-> or something
  grid-template-rows: auto auto <c- m>100</c-><c- k>px</c-><c- p>;</c->
  <c- k>align-content</c-><c- p>:</c-> center<c- p>;</c->
  <c- k>height</c-><c- p>:</c-> <c- m>300</c-><c- k>px</c-><c- p>;</c->
  <c- k>border</c-><c- p>:</c-> <c- m>1</c-><c- k>px</c-> solid<c- p>;</c->
<c- p>}</c->

.grid > * <c- p>{</c->
  <c- k>margin</c-><c- p>:</c-> <c- m>5</c-><c- k>px</c-><c- p>;</c->
  <c- k>background</c-><c- p>:</c-> silver<c- p>;</c->
<c- p>}</c->
.grid > <c- nf>:nth-child</c-><c- p>(</c-><c- m>2</c-><c- k>n</c-><c- p>)</c-> <c- p>{</c->
  <c- k>background</c-><c- p>:</c-> pink<c- p>;</c->
<c- p>}</c->

.grid subgrid <c- p>{</c->
  <c- k>display</c-><c- p>:</c-> grid<c- p>;</c->
  <c- k>grid</c-><c- p>:</c-> subgrid / subgrid<c- p>;</c->
  <c- k>grid-row</c-><c- p>:</c-> <c- m>2</c-> / span <c- m>2</c-><c- p>;</c->
  <c- k>grid-gap</c-><c- p>:</c-> <c- m>30</c-><c- k>px</c-><c- p>;</c->
<c- p>}</c->
.grid subgrid > * <c- p>{</c-> <c- k>background</c-><c- p>:</c-> cyan<c- p>;</c-> <c- p>}</c->
&lt;/style>
</pre>
<pre class="language-html highlight"><c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"grid"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->1<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->2<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->3<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>subgrid</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>item</c-> <c- e>style</c-><c- o>=</c-><c- s>"height:100px"</c-><c- p>></c->subgrid.1<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>item</c-><c- p>></c->sub.2<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>item</c-><c- p>></c->s.3<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>subgrid</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->4<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->5<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-> <c- e>style</c-><c- o>=</c-><c- s>"width: 80px"</c-><c- p>></c->6<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->7<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
</pre>
    <figure>
     
			<img height="315" src="images/subgrid-example-1.png" width="162">
			
     <figcaption>
				The rendering of the subgrid example above.
			</figcaption>
    </figure>
    <p>Note how the subgrid’s first item ("subgrid.1") contributes
		to the intrinsic size of the 2nd row in the parent grid.
		This is possible since the subgrid specified a definite position
		so we know which tracks it will occupy.
		Note also that trying to subgrid the parent’s <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis⑥">stacking axis</a>
		results in the subgrid getting <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout⑦">masonry layout</a> in its <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-axis" id="ref-for-inline-axis①">inline axis</a>.</p>
   </div>
   <p>A <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#subgrid" id="ref-for-subgrid②">subgrid</a> that is a <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container⑨">masonry container</a>
	can be referred to as a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="submasonry">submasonry</dfn>.</p>
   <h3 class="heading settled" data-level="3.3" id="repeat-notation"><span class="secno">3.3. </span><span class="content">
Track Repetition: the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat" id="ref-for-funcdef-repeat-line-color-repeat④">repeat()</a> notation</span><a class="self-link" href="#repeat-notation"></a></h3>
   <p>This specification introduces new keywords and masonry-specific behavior
	for the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat" id="ref-for-funcdef-repeat-line-color-repeat⑤">repeat()</a> notation.</p>
   <h4 class="heading settled" data-level="3.3.1" id="repeat-auto-areas"><span class="secno">3.3.1. </span><span class="content">
repeat(auto-areas)</span><a class="self-link" href="#repeat-auto-areas"></a></h4>
   <p>The new <dfn class="dfn-paneled css" data-dfn-for="repeat()" data-dfn-type="value" data-export id="valdef-repeat-auto-areas">auto-areas</dfn> value for the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat" id="ref-for-funcdef-repeat-line-color-repeat⑥">repeat()</a> notation
	represents the number of repetitions necessary
	for the total number of explicit tracks to match
	the <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-areas" id="ref-for-propdef-grid-template-areas">grid-template-areas</a> / <u class="property link-error" data-lt="masonry-template-areas" title="LINK ERROR: No &apos;property&apos; refs found for &apos;masonry-template-areas&apos;.">masonry-template-areas</u> value
	in effect in the corresponding axis.
	If multiple tracks are listed for the repetition,
	the final repetition is truncated as necessary
	to produce the correct number of tracks.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Unlike <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit" id="ref-for-valdef-repeat-auto-fit②">auto-fit</a>—​which always repeats at least once and always repeats the track listing entirely—​the number of repetitions for <a class="css" data-link-type="maybe" href="#valdef-repeat-auto-areas" id="ref-for-valdef-repeat-auto-areas">auto-areas</a> can be zero
	(if there are already enough explicit tracks),
	and the final repetition can be partial.</p>
   <p>If <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-areas" id="ref-for-propdef-grid-template-areas①">grid-template-areas</a> / <u class="property link-error" data-lt="masonry-template-areas" title="LINK ERROR: No &apos;property&apos; refs found for &apos;masonry-template-areas&apos;.">masonry-template-areas</u> is <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-grid-template-areas-none" id="ref-for-valdef-grid-template-areas-none">none</a>,
	this value behaves as <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit" id="ref-for-valdef-repeat-auto-fit③">auto-fit</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> This value applies both to regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container⑥">grid containers</a> and to <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①⓪">masonry containers</a>.</p>
   <p class="issue" id="issue-33a96346"><a class="self-link" href="#issue-33a96346"></a> It’s unclear if we actually need this value.
	Note that the explicit grid already takes values from <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-columns" id="ref-for-propdef-grid-auto-columns①">grid-auto-columns</a>/<a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-rows" id="ref-for-propdef-grid-auto-rows①">grid-auto-rows</a>/<u class="property link-error" data-lt="masonry-auto-tracks" title="LINK ERROR: No &apos;property&apos; refs found for &apos;masonry-auto-tracks&apos;.">masonry-auto-tracks</u>
	as needed to match the number of template areas. <a href="https://github.com/w3c/csswg-drafts/issues/10854">[Issue #10854]</a></p>
   <h4 class="heading settled" data-level="3.3.2" id="repeat-auto-fit"><span class="secno">3.3.2. </span><span class="content">
repeat(auto-fit)</span><a class="self-link" href="#repeat-auto-fit"></a></h4>
   <p>In <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①①">masonry containers</a> (as in regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container⑦">grid containers</a>)
	<a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit" id="ref-for-valdef-repeat-auto-fit④">auto-fit</a> acts like <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fill" id="ref-for-valdef-repeat-auto-fill②">auto-fill</a>,
	but with empty tracks <u class="link-error" data-lt="collapsed tracks" title="LINK ERROR: No &apos;dfn&apos; refs found for &apos;collapsed tracks&apos;.">collapsed</u>.
	However, because placement occurs after track sizing,
	<span id="ref-for-masonry-container①②">masonry containers</span> use a heuristic
	to determine if a track will be occupied:</p>
   <ul>
    <li data-md>
     <p>All tracks occupied by explicitly placed items are considered occupied.</p>
    <li data-md>
     <p>With the sum of the spans of all auto-placed items as <var>N</var>,
all unoccupied tracks up to the <var>N</var>th such track
are considered occupied.</p>
   </ul>
   <p>All tracks produced by the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit" id="ref-for-valdef-repeat-auto-fit⑤">auto-fit</a> repetition and considered unoccupied by this heuristic
	are assumed “empty” and are <u class="link-error" data-lt="collapsed tracks" title="LINK ERROR: No &apos;dfn&apos; refs found for &apos;collapsed tracks&apos;.">collapsed</u>.
	A <u class="link-error" data-lt="collapsed track" title="LINK ERROR: No &apos;dfn&apos; refs found for &apos;collapsed track&apos;.">collapsed track</u> cannot accept placement of auto-placed items.</p>
   <p class="note" role="note"><span class="marker">Note:</span> It is possible for an auto-placed item to be placed in a track when <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fill" id="ref-for-valdef-repeat-auto-fill③">auto-fill</a> is used
	that would be collapsed if <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit" id="ref-for-valdef-repeat-auto-fit⑥">auto-fit</a> is used
	if there are auto-placed items with a span greater than 1
	mixed with explicitly-placed items that leave gaps too small for the auto-placed items.</p>
   <h3 class="heading settled" data-level="3.4" id="track-sizing"><span class="secno">3.4. </span><span class="content">
Grid Axis Track Sizing</span><a class="self-link" href="#track-sizing"></a></h3>
   <p>Track sizing works the same as in <a href="https://drafts.csswg.org/css-grid-2/#algo-track-sizing">CSS Grid</a>,
	except that when considering which items contribute to intrinsic sizes:</p>
   <ul>
    <li data-md>
     <p>All items explicitly placed in that track contribute, and</p>
    <li data-md>
     <p>All items with an <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#automatic-grid-position" id="ref-for-automatic-grid-position">automatic grid position</a> contribute
(regardless of whether they are ultimately placed in that track).</p>
   </ul>
   <div class="example" id="example-6d22f73d">
    <a class="self-link" href="#example-6d22f73d"></a>
		For example, suppose there are two columns in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis⑥">grid axis</a>
		and that

    <ul>
     <li data-md>
      <p>Items A, B, and C have no explicit position.</p>
     <li data-md>
      <p>Item D is explicitly placed into the first column.</p>
    </ul>
    <p>In this case, items A, B, C, and D all contribute to sizing the first column,
		while only A, B, and C (and not D) contribute to the second column.</p>
   </div>
   <p>In the case of spanning items with an <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#automatic-grid-position" id="ref-for-automatic-grid-position①">automatic grid position</a>,
	they are assumed to be placed at every possible start position,
	and contribute accordingly.</p>
   <div class="example" id="example-f3e866aa">
    <a class="self-link" href="#example-f3e866aa"></a>
		For example, suppose there are 5 columns in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis⑦">grid axis</a>,
		with the middle having a fixed size of <span class="css">100px</span>
		and the other two being <span class="css">auto</span>-sized.
		For the purpose of track sizing,
		an item that spans 2 tracks
		and has an intrinsic contribution of 220px
		is essentially copied and assumed to exist:


    <ul>
     <li data-md>
      <p>At grid line 1,
contributing 110px to each of the first two tracks.</p>
     <li data-md>
      <p>At grid line 2,
contributing 120px to the second track.</p>
     <li data-md>
      <p>At grid line 3,
contributing 120px to the fourth track.</p>
     <li data-md>
      <p>At grid line 4,
contributing 110px to the fourth and fifth tracks.</p>
    </ul>
   </div>
   <p class="note" role="note"><span class="marker">Note:</span> This algorithm ensures that each track is at least big enough
	to accommodate every item that is ultimately placed in it,
	and does not create dependency cycles between placement and track sizing.
	However, depending on the variation in sizes,
	tracks could be larger than necessary:
	an exact fit is only guaranteed if
	all items are explicitly placed in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis⑧">grid axis</a>
	or all items are the same size
	(or matching multiples of that size, in the case of spanning items).</p>
   <h4 class="heading settled" data-level="3.4.1" id="track-sizing-subgrid"><span class="secno">3.4.1. </span><span class="content">
Subgrid Item Contributions</span><a class="self-link" href="#track-sizing-subgrid"></a></h4>
   <p>When sizing the tracks of either a regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container⑧">grid container</a> or a <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①③">masonry container</a>,
	a <a data-link-type="dfn" href="#submasonry" id="ref-for-submasonry">submasonry</a> has special handling of items that have an <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#automatic-grid-position" id="ref-for-automatic-grid-position②">automatic grid position</a>:</p>
   <ul>
    <li data-md>
     <p>Any such item is placed into every possible grid track
that could be spanned by the <a data-link-type="dfn" href="#submasonry" id="ref-for-submasonry①">submasonry</a>.
(If the submasonry has a <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#definite-grid-position" id="ref-for-definite-grid-position①">definite grid position</a>, thus only the spanned tracks;
if it has an <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#automatic-grid-position" id="ref-for-automatic-grid-position③">automatic grid position</a>, then all tracks in the parent grid.)</p>
    <li data-md>
     <p>Any such item receives the largest margin/border/padding contribution
of each edge at which it could hypothetically be placed.
If the item spans the entire subgrid, it receives both.
(See <a href="https://www.w3.org/TR/css-grid-2/#subgrid-item-contribution">CSS Grid Layout §9</a>.)</p>
   </ul>
   <h4 class="heading settled" data-level="3.4.2" id="track-sizing-performance"><span class="secno">3.4.2. </span><span class="content">
Optimized Track Sizing</span><a class="self-link" href="#track-sizing-performance"></a></h4>
   <p>Track sizing can be optimized by aggregating items
	that have the same span size and placement
	into a single virtual item
	as follows:</p>
   <ol>
    <li>
     
			Separate all the <a data-link-type="dfn" href="#masonry-item" id="ref-for-masonry-item②">masonry items</a> into <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="item-groups">item groups</dfn>, according to the following properties:


     <ul>
      <li data-md>
       <p>the span of the item</p>
      <li data-md>
       <p>the placement of the item,
i.e. which tracks it is allowed to be placed in</p>
      <li data-md>
       <p>the item’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#baseline-sharing-group" id="ref-for-baseline-sharing-group">baseline-sharing group</a></p>
     </ul>
     <p class="note" role="note"><span class="marker">Note:</span> For example, an item with span 2 placed in the second track
			will be in a different group than an item with span 2 that has an <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#automatic-grid-position" id="ref-for-automatic-grid-position④">automatic grid position</a>.</p>
    <li>
     
			For each <a data-link-type="dfn" href="#item-groups" id="ref-for-item-groups">item group</a>, synthesize a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="virtual-masonry-item">virtual masonry item</dfn>
			that has the maximum of every intrinsic size contribution
			among the items in that group.


     <p>If the items apply <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#baseline-alignment" id="ref-for-baseline-alignment">baseline alignment</a>,
			determine the baselines of the <a data-link-type="dfn" href="#virtual-masonry-item" id="ref-for-virtual-masonry-item①">virtual masonry item</a>
			by placing all of its items into a single hypothetical grid track
			and finding their shared baseline(s) and shims.
			Increase the group’s intrinsic size contributions accordingly.</p>
    <li>
			Place hypothetical copies of each <a data-link-type="dfn" href="#virtual-masonry-item" id="ref-for-virtual-masonry-item②">virtual masonry item</a> into the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis⑨">grid axis</a> tracks
			in every position that the item could potentially occupy,
			and run the <a href="https://drafts.csswg.org/css-grid-2/#algo-track-sizing">track sizing algorithm</a> with those items.
			The resulting track sizes are the <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①④">masonry container’s</a> track sizes.
	
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> This optimization should give the same results
	as the track sizing description <a href="#track-sizing">above</a>;
	if not this is an error, please
	<a href="https://github.com/w3c/csswg-drafts/issues">report it to the CSSWG</a>.</p>
   <h2 class="heading settled" data-level="4" id="masonry-track-placement"><span class="secno">4. </span><span class="content">
Masonry Placement</span><a class="self-link" href="#masonry-track-placement"></a></h2>
   <p>In the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①⓪">grid axis</a>,
	items can be <em>explicitly placed</em> into tracks and span them using the familiar <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-placement-property" id="ref-for-grid-placement-property">grid-placement properties</a>’ syntax.
	Auto-placement, however, uses the <a href="#masonry-layout-algorithm">§ 4.3 Masonry Layout and Placement Algorithm</a>,
	placing each item with an <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#automatic-grid-position" id="ref-for-automatic-grid-position⑤">automatic grid position</a>
	into the “shortest” masonry track available.</p>
   <div class="example" id="example-26ddc5f7">
    <a class="self-link" href="#example-26ddc5f7"></a>
		Here’s a masonry layout <a href="examples/pinterest-with-span.html">example</a>
		demonstrating placed and spanning items:

		
    <figure>
     
			<img height="885" src="images/example-pinterest-with-span.png" width="902">
			
     <figcaption>Rendering of the example above.</figcaption>
    </figure>
    <p class="issue" id="issue-33788d66"><a class="self-link" href="#issue-33788d66"></a> Need a better example!!!</p>
   </div>
   <h3 class="heading settled" data-level="4.1" id="masonry-placement-grid-option"><span class="secno">4.1. </span><span class="content">
Specifying Masonry Item Placement: the <span class="css">grid-column-*</span> and <span class="css">grid-row-*</span> properties</span><a class="self-link" href="#masonry-placement-grid-option"></a></h3>
   <p>The <span class="css">grid-column-*</span> and <span class="css">grid-row-*</span> properties
	(and their shorthands)
	apply in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①①">grid axis</a> of the items
	and establish placement just as in regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout⑧">grid layout</a>.</p>
   <h3 class="heading settled" data-level="4.2" id="item-slack"><span class="secno">4.2. </span><span class="content">
Placement Precision: the <a class="property css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack②">item-slack</a> property</span><a class="self-link" href="#item-slack"></a></h3>
   <table class="def propdef" data-link-for-hint="item-slack">
    <tbody>
     <tr>
      <th>Name:
      <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-item-slack">item-slack</dfn>
     <tr class="value">
      <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
      <td class="prod"><a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-values-4/#typedef-length-percentage" id="ref-for-typedef-length-percentage">&lt;length-percentage></a> <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-one" id="ref-for-comb-one">|</a> infinite	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
      <td>1em	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
      <td><a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①⑤">masonry containers</a>	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
      <td>no	
     <tr>
      <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
      <td>relative to the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①②">grid-axis</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-box-4/#content-box" id="ref-for-content-box">content box</a> size of the <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①⑥">masonry container</a>	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
      <td>a computed <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-values-4/#typedef-length-percentage" id="ref-for-typedef-length-percentage①">&lt;length-percentage></a> value	
     <tr>
      <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
      <td>per grammar	
     <tr>
      <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
      <td>as length	
   </table>
   <p><a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①⑦">Masonry containers</a> are filled
	by placing each <a data-link-type="dfn" href="#masonry-item" id="ref-for-masonry-item③">masonry item</a>
	in whichever <a data-link-type="dfn" href="#masonry-track" id="ref-for-masonry-track">masonry track</a> is currently the least filled.
	When multiple tracks are tied for least-filled,
	placing the items in order looks good.
	But if tracks are only <em>very slightly</em> different heights,
	it can look strange to have them not fill in order,
	as the height differences aren’t perceived as <em>meaningfully</em> different.</p>
   <p>The <a class="property css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack③">item-slack</a> property specifies what the threshold is
	for considering tracks to be “the same height”,
	causing them to fill in order.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-slack" data-dfn-type="value" data-export id="valdef-item-slack-length-percentage"><a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-values-4/#typedef-length-percentage" id="ref-for-typedef-length-percentage②">&lt;length-percentage></a></dfn>
    <dd data-md>
     <p>Specifies the <dfn class="dfn-paneled" data-dfn-for="masonry" data-dfn-type="dfn" data-noexport id="masonry-tie-threshold">tie threshold</dfn>
for the <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①⑧">masonry container</a>.
Placement positions are considered to be equally good (“tied”)
if they are within the specified distance
from the shortest position.</p>
     <p class="note" role="note"><span class="marker">Note:</span> The initial value is a “small” distance (<span class="css">1em</span>)
that is probably appropriate to represent “close enough”.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-slack" data-dfn-type="value" data-export id="valdef-item-slack-infinite">infinite</dfn>
    <dd data-md>
     <p>Specifies an infinite <a data-link-type="dfn" href="#masonry-tie-threshold" id="ref-for-masonry-tie-threshold">tie threshold</a>.
This makes items distribute themselves strictly in order,
without considering the length of the tracks at all.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This value can result in consecutive items being placed
in dramatically different positions in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis⑦">stacking axis</a>,
which can be confusing to readers.
If the initial value (`1em`) is too small,
consider a larger value (such as `10em` or `50vh`)
instead of `infinite`.</p>
   </dl>
   <p class="issue" id="issue-7bbfe9d5"><a class="self-link" href="#issue-7bbfe9d5"></a> Is <span class="css">1em</span> the right default?</p>
   <h3 class="heading settled" data-level="4.3" id="masonry-layout-algorithm"><span class="secno">4.3. </span><span class="content">
Masonry Layout and Placement Algorithm</span><a class="self-link" href="#masonry-layout-algorithm"></a></h3>
   <p>For each of the tracks in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①③">grid axis</a>,
	keep a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="running-position">running position</dfn> initialized to zero.
	Maintain also a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="auto-placement-cursor">auto-placement cursor</dfn>,
	initially pointing to the first line.</p>
   <p>For each item in <a data-link-type="dfn" href="https://www.w3.org/TR/css-flexbox-1/#order-modified-document-order" id="ref-for-order-modified-document-order">order-modified document order</a>:</p>
   <ol>
    <li>
     
			If the item has a <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#definite-grid-position" id="ref-for-definite-grid-position②">definite grid position</a> in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①④">grid axis</a>,
			use that placement.


     <p class="issue" id="issue-9c647ef6"><a class="self-link" href="#issue-9c647ef6"></a> Should this also update the placement cursor?</p>
     <p>Otherwise, resolve its <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①⑤">grid axis</a> placement using these substeps:</p>
     <ol>
      <li>Starting at the first <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①⑥">grid axis</a> line in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#implicit-grid" id="ref-for-implicit-grid①">implicit grid</a>,
					find the largest <a data-link-type="dfn" href="#running-position" id="ref-for-running-position">running position</a> of the <span id="ref-for-grid-axis①⑦">grid axis</span> tracks
					that the item would span if it were placed at this line,
					and call this position <var>max_pos</var>.
				
      <li>Repeat the previous step for each successive line number
					until the item would no longer fit inside the grid.
				
      <li>Let <var>possible lines</var> be the line that resulted in the smallest <var>max_pos</var>,
					and all lines that result in a <var>max_pos</var> within the <a data-link-type="dfn" href="#masonry-tie-threshold" id="ref-for-masonry-tie-threshold①">tie threshold</a> of this <var>max_pos</var>.
				
      <li>Choose the first line in <var>possible lines</var> greater than or equal to the <a data-link-type="dfn" href="#auto-placement-cursor" id="ref-for-auto-placement-cursor">auto-placement cursor</a>
					as the item’s position in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①⑧">grid axis</a>;
					or if there are none such, choose the first one.
				
      <li>Update the <a data-link-type="dfn" href="#auto-placement-cursor" id="ref-for-auto-placement-cursor①">auto-placement cursor</a> to point to item’s last line.
			
     </ol>
    <li>
			Place the item in its <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis①⑨">grid axis</a> tracks
			at the maximum of the <a data-link-type="dfn" href="#running-position" id="ref-for-running-position①">running position</a>s
			of the tracks it spans.

		
    <li>
			Calculate the size of the item’s <a href="#containing-block">containing block</a>
			and then layout the item.
			Set the <a data-link-type="dfn" href="#running-position" id="ref-for-running-position②">running position</a> of the spanned  <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②⓪">grid axis</a> tracks
			to <code><var>max_pos</var> + <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#outer-size" id="ref-for-outer-size">outer size</a> + <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-align-3/#propdef-grid-gap" id="ref-for-propdef-grid-gap">grid-gap</a></code>.
	
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> This algorithm chooses the track
	that would result in the item being placed as highly as possible.
	If there are ties, it chooses the earliest such track,
	<em>after</em> the most recently placed item if possible
	(ensuring that it always “moves forward” even in the presence of ties).</p>
   <h4 class="heading settled" data-level="4.3.1" id="containing-block"><span class="secno">4.3.1. </span><span class="content">
Containing Block</span><a class="self-link" href="#containing-block"></a></h4>
   <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-4/#containing-block" id="ref-for-containing-block">containing block</a> for a <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item③">grid item</a> participating in <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout⑧">masonry layout</a>
	is formed by its <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-area" id="ref-for-grid-area">grid area</a> in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②①">grid axis</a>
	and the <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container⑨">grid container</a>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-box-4/#content-box" id="ref-for-content-box①">content box</a> in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis⑧">stacking axis</a>.</p>
   <h4 class="heading settled" data-level="4.3.2" id="rtl-example"><span class="secno">4.3.2. </span><span class="content">
Placement and Writing Modes</span><a class="self-link" href="#rtl-example"></a></h4>
   <p class="note" role="note"><span class="marker">Note:</span> Like all of <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout⑨">grid layout</a>,
	masonry layout and placement is sensitive to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#writing-mode" id="ref-for-writing-mode">writing mode</a>.
	For example, for <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-writing-modes-3/#propdef-direction" id="ref-for-propdef-direction">direction: rtl</a>,
	items are placed right-to-left rather than left-to-right,
	whether the inline axis is a <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②②">grid axis</a> or a <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis⑨">stacking axis</a>.</p>
   <div class="example" id="example-f7337db7">
    <a class="self-link" href="#example-f7337db7"></a>
		Here’s a simple <a href="examples/rtl-grid-axis.html">example</a> using <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-writing-modes-3/#propdef-direction" id="ref-for-propdef-direction①">direction: rtl</a> in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②③">grid axis</a>:

		
<pre class="language-css highlight">&lt;style>
  .grid <c- p>{</c->
    //FIXME display: inline-grid<c- p>;</c-> or something
    direction: rtl<c- p>;</c->
    <c- k>grid-template-columns</c-><c- p>:</c-> <c- nf>repeat</c-><c- p>(</c-><c- m>4</c-><c- p>,</c-> <c- m>2</c-><c- k>ch</c-><c- p>);</c->
    <c- k>border</c-><c- p>:</c-> <c- m>1</c-><c- k>px</c-> solid<c- p>;</c->
  <c- p>}</c->

  item <c- p>{</c-> <c- k>background</c-><c- p>:</c-> silver <c- p>}</c->
  item<c- nf>:nth-child</c-><c- p>(</c-><c- m>2</c-><c- k>n</c-><c- m>+1</c-><c- p>)</c-> <c- p>{</c->
    <c- k>background</c-><c- p>:</c-> pink<c- p>;</c->
    <c- k>height</c-><c- p>:</c-> <c- m>4</c-><c- k>em</c-><c- p>;</c->
  <c- p>}</c->
  &lt;/style>
</pre>
<pre class="language-html highlight"><c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"grid"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->1<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-> <c- e>style</c-><c- o>=</c-><c- s>"grid-column:span 2"</c-><c- p>></c->2<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->3<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->4<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
</pre>
    <figure>
     
			<img height="107" src="images/rtl-grid-axis.png" width="128">
			
     <figcaption>Rendering of the <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-writing-modes-3/#propdef-direction" id="ref-for-propdef-direction②">direction: rtl</a> example above.</figcaption>
    </figure>
   </div>
   <div class="example" id="example-e0fb18a7">
    <a class="self-link" href="#example-e0fb18a7"></a>
		Here’s a simple <a href="examples/rtl-masonry-axis.html">example</a>
		using <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-writing-modes-3/#propdef-direction" id="ref-for-propdef-direction③">direction: rtl</a> in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①⓪">stacking axis</a>:

		
<pre class="language-css highlight">&lt;style>
.grid <c- p>{</c->
  //FIXME display: inline-grid<c- p>;</c-> or something
  direction: rtl<c- p>;</c->
  <c- k>width</c-><c- p>:</c-> <c- m>10</c-><c- k>ch</c-><c- p>;</c->
  <c- k>column-gap</c-><c- p>:</c-> <c- m>1</c-><c- k>ch</c-><c- p>;</c->
  <c- k>grid-template-rows</c-><c- p>:</c-> <c- nf>repeat</c-><c- p>(</c-><c- m>4</c-><c- p>,</c-> <c- m>2</c-><c- k>em</c-><c- p>);</c->
  <c- k>border</c-><c- p>:</c-> <c- m>1</c-><c- k>px</c-> solid<c- p>;</c->
<c- p>}</c->

item <c- p>{</c-> <c- k>background</c-><c- p>:</c-> silver <c- p>}</c->
item<c- nf>:nth-child</c-><c- p>(</c-><c- m>2</c-><c- k>n</c-><c- m>+1</c-><c- p>)</c-> <c- p>{</c->
  <c- k>background</c-><c- p>:</c-> pink<c- p>;</c->
  <c- k>width</c-><c- p>:</c-> <c- m>4</c-><c- k>ch</c-><c- p>;</c->
<c- p>}</c->
&lt;/style>
</pre>
<pre class="language-html highlight"><c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"grid"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->1<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-> <c- e>style</c-><c- o>=</c-><c- s>"grid-row:span 2"</c-><c- p>></c->2<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->3<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->4<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
</pre>
    <figure>
     
			<img height="203" src="images/rtl-masonry-axis.png" width="161">
			
     <figcaption>Rendering of the <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-writing-modes-3/#propdef-direction" id="ref-for-propdef-direction④">direction: rtl</a> example above.</figcaption>
    </figure>
   </div>
   <h2 class="heading settled" data-level="5" id="intrinsic-sizes"><span class="secno">5. </span><span class="content">
Sizing Grid Containers</span><a class="self-link" href="#intrinsic-sizes"></a></h2>
   <p><a href="https://drafts.csswg.org/css-grid-2/#intrinsic-sizes">Sizing Grid Containers</a> works the same as for regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container①⓪">grid containers</a>
	but with the following addendum for the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①①">stacking axis</a>:
	The <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#max-content" id="ref-for-max-content">max-content size</a> (<a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#min-content" id="ref-for-min-content">min-content size</a>) of a <span id="ref-for-grid-container①①">grid container</span> in the <span id="ref-for-stacking-axis①②">stacking axis</span>
	is the size of the <a data-link-type="dfn" href="#masonry-box" id="ref-for-masonry-box">masonry box</a> in that axis
	when sized under a <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#max-content-constraint" id="ref-for-max-content-constraint">max-content constraint</a> (<a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#min-content-constraint" id="ref-for-min-content-constraint">min-content constraint</a>).</p>
   <div class="example" id="example-867932d9">
    <a class="self-link" href="#example-867932d9"></a>
		Here’s a simple <a href="examples/grid-intrinsic-sizing-example-1.html">example</a>:

		
<pre class="language-css highlight">&lt;style>
.grid <c- p>{</c->
  //FIXME display: inline-grid<c- p>;</c-> or something
  grid-template-columns: <c- m>50</c-><c- k>px</c-> <c- m>100</c-><c- k>px</c-> auto<c- p>;</c->
  <c- k>grid-gap</c-><c- p>:</c-> <c- m>10</c-><c- k>px</c-><c- p>;</c->
  <c- k>border</c-><c- p>:</c-> <c- m>1</c-><c- k>px</c-> solid<c- p>;</c->
<c- p>}</c->
item <c- p>{</c-> <c- k>background</c-><c- p>:</c-> silver<c- p>;</c-> <c- k>margin</c-><c- p>:</c-> <c- m>5</c-><c- k>px</c-><c- p>;</c-> <c- p>}</c->
&lt;/style>
</pre>
<pre class="language-html highlight"><c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"grid"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-> <c- e>style</c-><c- o>=</c-><c- s>"border:10px solid"</c-><c- p>></c->1<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->2<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->3<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-> <c- e>style</c-><c- o>=</c-><c- s>"height:50px"</c-><c- p>></c->4<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->5<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>item</c-><c- p>></c->6<c- p>&lt;/</c-><c- f>item</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
</pre>
    <figure>
     
			<img height="158" src="images/grid-intrinsic-sizing-example-1.png" width="294">
			
     <figcaption>Rendering of the <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container①②">grid container</a> intrinsic sizing example above.</figcaption>
    </figure>
   </div>
   <h2 class="heading settled" data-level="6" id="alignment"><span class="secno">6. </span><span class="content">
Alignment and Spacing</span><a class="self-link" href="#alignment"></a></h2>
   <p><a href="https://drafts.csswg.org/css-grid-2/#gutters">Gutters</a> are supported in both axes.
	In the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①③">stacking axis</a>,
	the gap is applied between the margin boxes of each pair of adjacent items.
	Margins do not collapse in either axis.</p>
   <p>In the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②④">grid axis</a>,
	<a href="https://drafts.csswg.org/css-grid-2/#alignment">alignment</a>
	works the same as in a regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container①③">grid container</a>.</p>
   <p>In the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①④">stacking axis</a>,
	<a href="https://drafts.csswg.org/css-align-3/#content-distribution">content-distribution</a> is applied
	to the content as a whole, similarly to how it behaves in block containers.
	More specifically, the <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#alignment-subject" id="ref-for-alignment-subject">alignment subject</a> is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="masonry-box">masonry box</dfn>,
	which is the smallest rectangle bounding
	the <a data-link-type="dfn" href="https://drafts.csswg.org/css-box-4/#margin-box" id="ref-for-margin-box">margin boxes</a> of all the <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item④">grid items</a>.</p>
   <figure>
    
		<img height="136" src="images/masonry-box.png" width="166">
		
    <figcaption>
			The extent of the <a data-link-type="dfn" href="#masonry-box" id="ref-for-masonry-box①">masonry box</a> is indicated by the dashed border.
			(Note that item 1 has a 5px bottom margin here.)
		</figcaption>
   </figure>
   <p class="note" role="note"><span class="marker">Note:</span> There is only ever one <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#alignment-subject" id="ref-for-alignment-subject①">alignment subject</a>
	for these properties in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①⑤">stacking axis</a>,
	so the unique <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-align-3/#propdef-align-content" id="ref-for-propdef-align-content">align-content</a> / <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-align-3/#propdef-justify-content" id="ref-for-propdef-justify-content">justify-content</a> values boil down to
	<a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-align-3/#valdef-self-position-start" id="ref-for-valdef-self-position-start">start</a>,
	<a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-align-3/#valdef-self-position-center" id="ref-for-valdef-self-position-center">center</a>,
	<a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-align-3/#valdef-self-position-end" id="ref-for-valdef-self-position-end">end</a>,
	and <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#baseline-alignment" id="ref-for-baseline-alignment①">baseline alignment</a>.
	(The behavior of <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-align-3/#valdef-justify-content-normal" id="ref-for-valdef-justify-content-normal">normal</a> and <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-align-3/#valdef-align-content-stretch" id="ref-for-valdef-align-content-stretch">stretch</a>
	is identical to <span class="css" id="ref-for-valdef-self-position-start①">start</span>,
	and the <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#distributed-alignment" id="ref-for-distributed-alignment">distributed alignment</a> values behave as their <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#fallback-alignment" id="ref-for-fallback-alignment">fallback alignments</a>.)
	If the <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item⑤">grid items</a> overflow
	the <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container①④">grid container</a>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-box-4/#content-box" id="ref-for-content-box②">content box</a> in the <span id="ref-for-stacking-axis①⑥">stacking axis</span>,
	then the <a data-link-type="dfn" href="#masonry-box" id="ref-for-masonry-box②">masonry box</a> will be larger than the <span id="ref-for-grid-container①⑤">grid container</span>’s <span id="ref-for-content-box③">content box</span>.</p>
   <p class="issue" id="issue-491b71c9"><a class="self-link" href="#issue-491b71c9"></a> Should alignment in the stacking axis do something more sophisticated?
	What should that be?</p>
   <h3 class="heading settled" data-level="6.1" id="masonry-axis-baseline-alignment"><span class="secno">6.1. </span><span class="content">
Baseline Alignment in the stacking axis</span><a class="self-link" href="#masonry-axis-baseline-alignment"></a></h3>
   <p>Item <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#baseline-alignment" id="ref-for-baseline-alignment②">baseline alignment</a> inside the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②⑤">grid axis</a> tracks
	works as usual for a regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container①⑥">grid container</a>,
	and the <span id="ref-for-grid-container①⑦">grid container</span>’s baseline is determined
	the same as for a regular <span id="ref-for-grid-container①⑧">grid container</span> in that axis.</p>
   <p><a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#baseline-alignment" id="ref-for-baseline-alignment③">Baseline alignment</a> is not supported in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①⑦">stacking axis</a>.
	The first baseline set of the <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container①⑨">grid container</a> in this axis
	is generated from the <a data-link-type="dfn" href="https://drafts.csswg.org/css-align-3/#alignment-baseline" id="ref-for-alignment-baseline">alignment baseline</a> of
	the first <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item⑥">grid item</a> in the first occupied track,
	and the last baseline set from the last <span id="ref-for-grid-item⑦">grid item</span> placed.</p>
   <p class="issue" id="issue-4a2d589c"><a class="self-link" href="#issue-4a2d589c"></a> We could support baseline alignment in the first row. Do we want to?</p>
   <p class="issue" id="issue-f1320409"><a class="self-link" href="#issue-f1320409"></a> Should the last baseline come from the last lowest item placed instead?</p>
   <h2 class="heading settled" data-level="7" id="pagination"><span class="secno">7. </span><span class="content">
Fragmentation</span><a class="self-link" href="#pagination"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="masonry-axis-pagination"><span class="secno">7.1. </span><span class="content">
Fragmentation in the stacking axis</span><a class="self-link" href="#masonry-axis-pagination"></a></h3>
   <p>Each <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②⑥">grid axis</a> track is fragmented independently in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①⑧">stacking axis</a>.
	If a <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-item" id="ref-for-grid-item⑧">grid item</a> is fragmented,
	or has a <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-4/#forced-break" id="ref-for-forced-break">forced break</a> before/after it,
	then the <a data-link-type="dfn" href="#running-position" id="ref-for-running-position③">running position</a> for the tracks that it spans in the <span id="ref-for-grid-axis②⑦">grid axis</span>
	are set to the size of the <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-4/#fragmentainer" id="ref-for-fragmentainer">fragmentainer</a>
	so that no further items will be placed in those tracks.
	An item that is split into multiple fragments
	retains its placement in the <span id="ref-for-grid-axis②⑧">grid axis</span> for all its fragments.
	A grid item that is pushed, however,
	is placed again by the next <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②⓪">grid container</a> fragment.
	Placement continues until all items are placed or pushed to a new fragment.</p>
   <div class="example" id="example-d9ac598c">
    <a class="self-link" href="#example-d9ac598c"></a>
		Here’s an <a href="examples/fragmentation-block-axis-example.html">example</a>
		illustrating fragmentation of a grid with masonry layout in its <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis②">block axis</a>.
		It renders like this:
		
    <figure style="max-width:100%">
     <video controls src="images/fragmentation-block-axis-example.mp4" style="max-width:100%"></video>
     <figcaption>
				Visualization of fragmentation in a <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis③">block-axis</a> <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout⑨">masonry layout</a>.
			</figcaption>
    </figure>
   </div>
   <h3 class="heading settled" data-level="7.2" id="grid-axis-pagination"><span class="secno">7.2. </span><span class="content">
Fragmentation in the Grid Axis</span><a class="self-link" href="#grid-axis-pagination"></a></h3>
   <p>Fragmentation in the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis②⑨">grid axis</a> with <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①⓪">masonry layout</a> in the other axis
	is also supported.
	In this case the fragmentation behaves more like in a regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②①">grid container</a>;
	however, there’s a separate step to determine which <span id="ref-for-grid-axis③⓪">grid-axis</span> track
	each item is placed into,
	before fragmentation occurs.</p>
   <div class="example" id="example-62d55948">
    <a class="self-link" href="#example-62d55948"></a>
		Here’s an <a href="examples/fragmentation-inline-axis-example.html">example</a>
		illustrating fragmentation of a grid with <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①①">masonry layout</a> in its <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-axis" id="ref-for-inline-axis②">inline axis</a>.
		In this case the breaks occurs between the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis③①">grid-axis</a> rows.
		It renders like this:
		
    <figure style="max-width:100%">
     <video controls src="images/fragmentation-inline-axis-example.mp4" style="max-width:100%"></video>
     <figcaption>
				Visualization of fragmentation in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis④">block axis</a> with <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-axis" id="ref-for-inline-axis③">inline-axis</a> <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①②">masonry layout</a>.
			</figcaption>
    </figure>
   </div>
   <h2 class="heading settled" data-level="8" id="abspos"><span class="secno">8. </span><span class="content">
Absolute Positioning</span><a class="self-link" href="#abspos"></a></h2>
   <p><a href="https://drafts.csswg.org/css-grid-1/#abspos-items">Grid-aligned absolute-positioned descendants</a> are supported
	in <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container①⑨">masonry containers</a> just as for regular <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②②">grid containers</a>;
	however, in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis①⑨">stacking axis</a> there exist only two lines (in addition to the <span class="css">auto</span> lines) for placement:</p>
   <ul>
    <li data-md>
     <p>line 1 (line -2) corresponds to the start edge of the <a data-link-type="dfn" href="#masonry-box" id="ref-for-masonry-box③">masonry box</a></p>
    <li data-md>
     <p>line 2 (line -1) corresponds to the end edge of the <a data-link-type="dfn" href="#masonry-box" id="ref-for-masonry-box④">masonry box</a></p>
   </ul>
   <p class="issue" id="issue-4007c2e6"><a class="self-link" href="#issue-4007c2e6"></a> It might be useful to define a static position in the <a data-link-type="dfn" href="#stacking-axis" id="ref-for-stacking-axis②⓪">stacking axis</a>.
	Maybe it could defined as the max (or min?) current <a data-link-type="dfn" href="#running-position" id="ref-for-running-position④">running position</a>
	of the <a data-link-type="dfn" href="#grid-axis" id="ref-for-grid-axis③②">grid-axis</a> tracks at that point?  Or the end of the item before it?</p>
   <h2 class="heading settled" data-level="9" id="graceful-degradation"><span class="secno">9. </span><span class="content">
Graceful Degradation</span><a class="self-link" href="#graceful-degradation"></a></h2>
   <p>Typically, a masonry design can be expected to degrade quite nicely
	in a UA that supports Grid layout but not masonry layout.</p>
   <div class="example" id="example-51b24037">
    <a class="self-link" href="#example-51b24037"></a>


    <p>Here’s an <a href="examples/graceful-degradation-example.html">example</a>
		to illustrate this.</p>
<pre class="language-css highlight"><c- k>display</c-><c- p>:</c-> grid<c- p>;</c->
//FIXME item-flow: collapse<c- p>;</c-> <c- c>/* ignored in UAs that don't support masonry layout */</c->
grid-template-columns: <c- m>150</c-><c- k>px</c-> <c- m>100</c-><c- k>px</c-> <c- m>50</c-><c- k>px</c-><c- p>;</c->
</pre>
    <p>This creates a layout with three columns,
		but will have "more gaps" in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis⑤">block axis</a> if the UA doesn’t support masonry layout.
		Here’s what it looks like with Masonry support for comparison:</p>
    <figure>
     <video controls src="images/graceful-degradation-example.mp4"></video>
     <figcaption>
				Rendering of the example in a UA with Masonry support.
			</figcaption>
    </figure>
   </div>
   <h2 class="heading settled" id="flow-control"><span class="content">
Appendix A: Generic Layout Item Flow Controls: the <span class="css">item-*</span> properties</span><a class="self-link" href="#flow-control"></a></h2>
   <p class="issue" id="issue-fd53eff2"><a class="self-link" href="#issue-fd53eff2"></a> This section is likely to move to another spec,
	such as <a data-link-type="biblio" href="#biblio-css-display-4" title="CSS Display Module Level 4">[css-display-4]</a>,
	since it affects multiple display types.</p>
   <p>Multiple layout modes in CSS place their children
	as atomic "items" organized into rows and/or colummns in their container,
	and allow the author to configure their ordering and placement.
	The <span class="css">item-*</span> properties provide generic controls for
	these ordering and placement options,
	encapsulating the layout-specific <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-flexbox-1/#propdef-flex-flow" id="ref-for-propdef-flex-flow">flex-flow</a> and <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-flow" id="ref-for-propdef-grid-auto-flow">grid-auto-flow</a> properties.</p>
   <table class="data">
    <caption>Overview of Item Flow Controls</caption>
    <thead>
     <tr>
      <th>Flow-oriented Proposal
			
      <th>Track-oriented Proposal
			
      <th>Value Space
			
      <th>Description
			
      <th>Existing flex property
			
      <th>Existing grid property
	
    <tbody>
     <tr>
      <td><a class="property css" data-link-type="property" href="#propdef-item-direction" id="ref-for-propdef-item-direction">item-direction</a>
			
      <td><a class="property css" data-link-type="property" href="#propdef-item-track" id="ref-for-propdef-item-track">item-track</a>
			
      <td>auto | row | column | row-reverse | column-reverse
			
      <td>
				Controls whether items are placed into rows or columns,
				and whether within those tracks they are ordered
				start-to-end or end-to-start.
			
      <td>flex-direction
			
      <td>grid-auto-flow
		
     <tr>
      <td><a class="property css" data-link-type="property" href="#propdef-item-wrap" id="ref-for-propdef-item-wrap">item-wrap</a>
			
      <td><a class="property css" data-link-type="property" href="#propdef-item-cross" id="ref-for-propdef-item-cross">item-cross</a>
			
      <td>[ auto | nowrap | wrap ] || [ normal | reverse ] | wrap-reverse
			
      <td>
				Controls whether items are wrapped
				in the axis opposite to that controled by the row/column property,
				and if so if they are placed in start-to-end or end-to-start order.
			
      <td>flex-wrap
			
      <td>Introduced into <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-flow" id="ref-for-propdef-grid-auto-flow①">grid-auto-flow</a> in this level.
		
     <tr>
      <td><a class="property css" data-link-type="property" href="#propdef-item-pack" id="ref-for-propdef-item-pack②">item-pack</a>
			
      <td><a class="property css" data-link-type="property" href="#propdef-item-pack" id="ref-for-propdef-item-pack③">item-pack</a>
			
      <td>normal | dense || balance
			
      <td>
				Configures how items are packed into their tracks.
			
      <td>
      <td><a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-flow" id="ref-for-propdef-grid-auto-flow②">grid-auto-flow</a>
		
     <tr>
      <td><a class="property css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack④">item-slack</a>
			
      <td><a class="property css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack⑤">item-slack</a>
			
      <td>normal | <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-values-4/#typedef-length-percentage" id="ref-for-typedef-length-percentage③">&lt;length-percentage></a> | infinite
			
      <td>
				Defines a layout-specific amount of "slack" in placement decisions.
			
      <td>
      <td>
   </table>
   <p class="issue" id="issue-c971c9c1"><a class="self-link" href="#issue-c971c9c1"></a> The CSSWG is still figuring out how these properties should be named and fit together. <a href="https://github.com/w3c/csswg-drafts/issues/11480">[Issue #11480]</a></p>
   <h3 class="heading settled" id="item-primary-axis"><span class="content">
Item Flow Axis: <a class="property css" data-link-type="property" href="#propdef-item-track" id="ref-for-propdef-item-track①">item-track</a>/<a class="property css" data-link-type="property" href="#propdef-item-direction" id="ref-for-propdef-item-direction①">item-direction</a></span><a class="self-link" href="#item-primary-axis"></a></h3>
   <table class="def propdef" data-link-for-hint="item-direction">
    <tbody>
     <tr>
      <th>Name:
      <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-item-direction">item-direction</dfn>, <dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-item-track">item-track</dfn>
     <tr class="value">
      <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
      <td class="prod">auto <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-one" id="ref-for-comb-one①">|</a> row <span id="ref-for-comb-one②">|</span> column <span id="ref-for-comb-one③">|</span> row-reverse <span id="ref-for-comb-one④">|</span> column-reverse	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
      <td>auto	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
      <td><a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-container" id="ref-for-flex-container">flex containers</a>, <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②③">grid containers</a>, <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container②⓪">masonry containers</a>	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
      <td>no	
     <tr>
      <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
      <td>N/A	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
      <td>as specified	
     <tr>
      <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
      <td>per grammar	
     <tr>
      <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
      <td>discrete	
   </table>
   <p>This property controls whether items are placed as rows or columns,
	and whether within those tracks they are ordered
	start-to-end or end-to-start.</p>
   <p class="issue" id="issue-80d7796e"><a class="self-link" href="#issue-80d7796e"></a> There two open debates on this property:
	a) what should it be called and
	b) does it describe the primary direction of placement,
		or the orientation of the tracks into which items are placed;
		in other words, is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="primary-axis">primary axis</dfn> defined by this property
		the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="primary-placement-axis">primary placement axis</dfn> or the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="primary-track-axis">primary track axis</dfn>.
	These are identical for <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout④">flex layout</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout①⓪">grid layout</a>,
	but differ for <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①③">masonry layout</a> whose primary placement direction
	is across its tracks. <a href="https://github.com/w3c/csswg-drafts/issues/11480">[Issue #11480]</a></p>
   <dl>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-direction, item-track" data-dfn-type="value" data-export id="valdef-item-direction-auto">auto</dfn>
    <dd data-md>
     <p>Computes to either <a class="css" data-link-type="maybe" href="#valdef-item-direction-row" id="ref-for-valdef-item-direction-row">row</a> or <a class="css" data-link-type="maybe" href="#valdef-item-direction-column" id="ref-for-valdef-item-direction-column">column</a>
depending on the layout mode:</p>
     <ul>
      <li data-md>
       <p>On <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-container" id="ref-for-flex-container①">flex containers</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②④">grid containers</a>,
computes to <a class="css" data-link-type="maybe" href="#valdef-item-direction-row" id="ref-for-valdef-item-direction-row①">row</a>.</p>
      <li data-md>
       <p>On <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container②①">masonry containers</a>,
if <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-rows" id="ref-for-propdef-grid-template-rows①">grid-template-rows</a> is not <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-grid-2/#valdef-grid-template-rows-none" id="ref-for-valdef-grid-template-rows-none">none</a>
and <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-columns" id="ref-for-propdef-grid-template-columns②">grid-template-columns</a> is <span class="css" id="ref-for-valdef-grid-template-rows-none①">none</span>,
computes to the value representing row tracks;
otherwise computes to the value representing column tracks.</p>
     </ul>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-direction, item-track" data-dfn-type="value" data-export id="valdef-item-direction-row">row</dfn>
    <dd data-md>
     <p><span class="option masonry">Track-oriented Option</span>
Represents placement into rows,
i.e. tracks or lines parallel to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-axis" id="ref-for-inline-axis④">inline axis</a>.
Items fill those rows in start-to-end order.</p>
     <p><span class="option grid">Flow-oriented Option</span>
Represents row-primary item placement,
i.e. placing items start-to-end in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-axis" id="ref-for-inline-axis⑤">inline axis</a>,
producing flex row lines in <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout⑤">flex layout</a>,
and column grid tracks in <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①④">masonry layout</a>.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-direction, item-track" data-dfn-type="value" data-export id="valdef-item-direction-column">column</dfn>
    <dd data-md>
     <p><span class="option masonry">Track-oriented Option</span>
Represents placement into columns,
i.e. tracks or lines parallel to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis⑥">block axis</a>.
Items fill those columns in start-to-end order.</p>
     <p><span class="option grid">Flow-oriented Option</span>
Represents column-primary item placement,
i.e. placing items start-to-end in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-axis" id="ref-for-block-axis⑦">block axis</a>,
producing flex column lines in <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout⑥">flex layout</a>,
and row grid tracks in <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①⑤">masonry layout</a>.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-direction, item-track" data-dfn-type="value" data-export id="valdef-item-direction-row-reverse">row-reverse</dfn>
    <dd data-md>
     <p>Same as <a class="css" data-link-type="maybe" href="#valdef-item-direction-row" id="ref-for-valdef-item-direction-row②">row</a>,
but using end-to-start placement order.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-direction, item-track" data-dfn-type="value" data-export id="valdef-item-direction-column-reverse">column-reverse</dfn>
    <dd data-md>
     <p>Same as <a class="css" data-link-type="maybe" href="#valdef-item-direction-column" id="ref-for-valdef-item-direction-column①">column</a>,
but using end-to-start placement order.</p>
   </dl>
   <h3 class="heading settled" id="item-secondary-axis"><span class="content">
Item Cross Axis Placement Mode: <a class="property css" data-link-type="property" href="#propdef-item-cross" id="ref-for-propdef-item-cross①">item-cross</a>/<a class="property css" data-link-type="property" href="#propdef-item-wrap" id="ref-for-propdef-item-wrap①">item-wrap</a></span><a class="self-link" href="#item-secondary-axis"></a></h3>
   <table class="def propdef" data-link-for-hint="item-wrap">
    <tbody>
     <tr>
      <th>Name:
      <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-item-wrap">item-wrap</dfn>, <dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-item-cross">item-cross</dfn>
     <tr class="value">
      <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
      <td class="prod">[ auto <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-one" id="ref-for-comb-one⑤">|</a> nowrap <span id="ref-for-comb-one⑥">|</span> wrap ] <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-any" id="ref-for-comb-any">||</a> [ normal <span id="ref-for-comb-one⑦">|</span> reverse ] <span id="ref-for-comb-one⑧">|</span> wrap-reverse	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
      <td>auto	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
      <td><a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-container" id="ref-for-flex-container②">flex containers</a>, <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②⑤">grid containers</a>, <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container②②">masonry containers</a>	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
      <td>no	
     <tr>
      <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
      <td>N/A	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
      <td>as specified	
     <tr>
      <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
      <td>per grammar	
     <tr>
      <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
      <td>discrete	
   </table>
   <p>Controls placement in the axis opposite to the <a data-link-type="dfn" href="#primary-axis" id="ref-for-primary-axis">primary axis</a>.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-wrap,item-cross" data-dfn-type="value" data-export id="valdef-item-wrap-auto">auto</dfn>
    <dd data-md>
     <p>Computes to <a class="css" data-link-type="maybe" href="#valdef-item-wrap-nowrap" id="ref-for-valdef-item-wrap-nowrap">nowrap</a> on <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-container" id="ref-for-flex-container③">flex containers</a>,
and <a class="css" data-link-type="maybe" href="#valdef-item-wrap-wrap" id="ref-for-valdef-item-wrap-wrap">wrap</a> on everything else.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-wrap,item-cross" data-dfn-type="value" data-export id="valdef-item-wrap-nowrap">nowrap</dfn>
    <dd data-md>
     <p>Items are placed in the <a data-link-type="dfn" href="#primary-placement-axis" id="ref-for-primary-placement-axis">primary placement axis</a> forever,
even if they run out of room.
In <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout⑦">flex layout</a> this creates a <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#single-line-flex-container" id="ref-for-single-line-flex-container">single-line flex container</a>;
in <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout①①">grid layout</a> this creates <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#implicit-grid-track" id="ref-for-implicit-grid-track">implicit tracks</a> in the <span id="ref-for-primary-placement-axis①">primary placement axis</span> as necessary.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-wrap,item-cross" data-dfn-type="value" data-export id="valdef-item-wrap-wrap">wrap</dfn>
    <dd data-md>
     <p>Items wrap when the <a data-link-type="dfn" href="#primary-placement-axis" id="ref-for-primary-placement-axis②">primary placement axis</a> runs out of space.
In <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout⑧">flex layout</a> this creates a <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#multi-line-flex-container" id="ref-for-multi-line-flex-container">multi-line flex container</a>;
in <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout①②">grid layout</a> auto-placement algorithm moves to the next
row/column when it runs out of explicit tracks in the <span id="ref-for-primary-placement-axis③">primary placement axis</span>.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-wrap,item-cross" data-dfn-type="value" data-export id="valdef-item-wrap-normal">normal</dfn>
    <dd data-md>
     <p>Items are placed in start-to-end order
in the axis opposite to the <a data-link-type="dfn" href="#primary-track-axis" id="ref-for-primary-track-axis">primary track axis</a>.</p>
     <p>In <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout⑨">flex layout</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout" id="ref-for-grid-layout①③">grid layout</a>,
this controls the direction that new tracks
(flex lines or grid tracks)
are placed in.</p>
     <p>In <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①⑥">masonry layout</a>,
<span class="option masonry">for track-oriented syntax this controls which track is selected
when several are tied for equal height</span>;
<span class="option grid">for flow-oriented syntax this controls which direction
items fill their track in.</span></p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-wrap,item-cross" data-dfn-type="value" data-export id="valdef-item-wrap-reverse">reverse</dfn>
    <dd data-md>
     <p>Items are placed in end-to-start order
in the axis opposite to the <a data-link-type="dfn" href="#primary-track-axis" id="ref-for-primary-track-axis①">primary track axis</a>.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-wrap,item-cross" data-dfn-type="value" data-export id="valdef-item-wrap-wrap-reverse">wrap-reverse</dfn>
    <dd data-md>
     <p>Computes to <span class="css">wrap reverse</span>.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This value exists for consistency with the existing <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-flexbox-1/#propdef-flex-wrap" id="ref-for-propdef-flex-wrap">flex-wrap</a> value.</p>
   </dl>
   <p class="issue" id="issue-b3c639a9"><a class="self-link" href="#issue-b3c639a9"></a> The interpretation and naming of this property depends on
	the interpretation of axes for <a class="property css" data-link-type="property" href="#propdef-item-direction" id="ref-for-propdef-item-direction②">item-direction</a>/<a class="property css" data-link-type="property" href="#propdef-item-track" id="ref-for-propdef-item-track②">item-track</a>. <a href="https://github.com/w3c/csswg-drafts/issues/11480">[Issue #11480]</a></p>
   <h3 class="heading settled" id="item-pack-options"><span class="content">
Item Placement Packing Mode: the <a class="property css" data-link-type="property" href="#propdef-item-pack" id="ref-for-propdef-item-pack④">item-pack</a> property</span><a class="self-link" href="#item-pack-options"></a></h3>
   <table class="def propdef" data-link-for-hint="item-pack">
    <tbody>
     <tr>
      <th>Name:
      <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-item-pack">item-pack</dfn>
     <tr class="value">
      <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
      <td class="prod">normal <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-one" id="ref-for-comb-one⑨">|</a> dense <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-any" id="ref-for-comb-any①">||</a> balance	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
      <td>normal	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
      <td><a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-container" id="ref-for-flex-container④">flex containers</a>, <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container" id="ref-for-grid-container②⑥">grid containers</a>, <a data-link-type="dfn" href="#masonry-container" id="ref-for-masonry-container②③">masonry containers</a>	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
      <td>no	
     <tr>
      <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
      <td>N/A	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
      <td>as specified	
     <tr>
      <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
      <td>per grammar	
     <tr>
      <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
      <td>discrete	
   </table>
   <p>This property controls how items are distributed among the tracks
	in a layout-specific way.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-pack" data-dfn-type="value" data-export id="valdef-item-pack-normal">normal</dfn>
    <dd data-md>
     <p>Uses the default packing strategy for the layout mode.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-pack" data-dfn-type="value" data-export id="valdef-item-pack-dense">dense</dfn>
    <dd data-md>
     <p>Allows backtracking to place items in earlier spaces that were skipped.
(Such spaces can exist because earlier items were too big for those spaces.)</p>
     <p>For example,
in <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout①⓪">flex layout</a> this allows placing items on earlier lines
that still have enough empty space left over.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="item-pack" data-dfn-type="value" data-export id="valdef-item-pack-balance">balance</dfn>
    <dd data-md>
     <p>In <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout" id="ref-for-flex-layout①①">flex layout</a>,
this value balances the amount of content on each line
(including the last line),
similar to <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-text-4/#propdef-text-wrap-style" id="ref-for-propdef-text-wrap-style">text-wrap-style: balance</a>.</p>
   </dl>
   <p class="issue" id="issue-1efcc181"><a class="self-link" href="#issue-1efcc181"></a> One of the proposals for switching into <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①⑦">masonry layout</a>
	is to add a <dfn class="dfn-paneled css" data-dfn-for="item-pack" data-dfn-type="value" data-export id="valdef-item-pack-collapse">collapse</dfn> value
	to this <a class="property css" data-link-type="property" href="#propdef-item-pack" id="ref-for-propdef-item-pack⑤">item-pack</a> property. <a href="https://github.com/w3c/csswg-drafts/issues/11243">[Issue #11243]</a></p>
   <p class="issue" id="issue-152d283d"><a class="self-link" href="#issue-152d283d"></a>
	Should <span class="css">dense</span> packing apply to masonry?
	It’s much more expensive in masonry,
	as you have to lay out the element in every possible gap spot
	to see if it’s short enough to fit;
	Grid gets to just juggle some integers. <a href="https://github.com/w3c/csswg-drafts/issues/9326">[Issue #9326]</a></p>
   <h3 class="heading settled" id="item-flow"><span class="content">
Item Placement Shorthand: the <a class="property css" data-link-type="property" href="#propdef-item-flow" id="ref-for-propdef-item-flow">item-flow</a> shorthand</span><a class="self-link" href="#item-flow"></a></h3>
   <table class="def propdef" data-link-for-hint="item-flow">
    <tbody>
     <tr>
      <th>Name:
      <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-item-flow">item-flow</dfn>
     <tr class="value">
      <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
      <td class="prod"><a class="production css" data-link-type="property" href="#propdef-item-direction" id="ref-for-propdef-item-direction③">&lt;'item-direction'></a> <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-any" id="ref-for-comb-any②">||</a> <a class="production css" data-link-type="property" href="#propdef-item-wrap" id="ref-for-propdef-item-wrap②">&lt;'item-wrap'></a> <span id="ref-for-comb-any③">||</span> <a class="production css" data-link-type="property" href="#propdef-item-pack" id="ref-for-propdef-item-pack⑥">&lt;'item-pack'></a> <span id="ref-for-comb-any④">||</span> <a class="production css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack⑥">&lt;'item-slack'></a>	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
      <td>see individual properties	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
      <td>see individual properties	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
      <td>see individual properties	
     <tr>
      <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
      <td>see individual properties	
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
      <td>see individual properties	
     <tr>
      <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
      <td>see individual properties	
     <tr>
      <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
      <td>per grammar	
   </table>
   <p>This <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#shorthand-property" id="ref-for-shorthand-property">shorthand property</a> sets all its <span class="css">item-*</span> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#longhand" id="ref-for-longhand">longhand properties</a>
	in a single declaration.</p>
   <h2 class="heading settled" data-level="10" id="acknowledgements"><span class="secno">10. </span><span class="content">
Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
   <p>Thanks goes to Cameron McCormack who wrote a masonry layout explainer document
	(from which was lifted the Background chapter) and presented it to the CSSWG,
	and to Mats Palmgren who developed the original version of this specification.
	Thanks also to everyone who provided feedback on the <a href="https://github.com/w3c/csswg-drafts/issues/4650">initial proposal</a> for this feature.</p>
   <h2 class="heading settled" data-level="11" id="security"><span class="secno">11. </span><span class="content">
Security Considerations</span><a class="self-link" href="#security"></a></h2>
   <p>As a layout specification,
	this spec introduces no new security considerations
	beyond that exposed by CSS layout in general.</p>
   <h2 class="heading settled" data-level="12" id="privacy"><span class="secno">12. </span><span class="content">
Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
   <p>As a layout specification,
	this spec introduces no new privacy considerations
	beyond that exposed by CSS layout in general.</p>
   <h2 class="no-num heading settled" id="changes"><span class="content">
Changes</span><a class="self-link" href="#changes"></a></h2>
   <h3 class="heading settled" id="changes-3"><span class="content">
Additions Since Level 2</span><a class="self-link" href="#changes-3"></a></h3>
   <p>The following features have been added since
	<a href="http://www.w3.org/TR/css-grid-2/">Level 2</a>:</p>
   <ul>
    <li>Added <a data-link-type="dfn" href="#masonry-layout" id="ref-for-masonry-layout①⑧">masonry layout</a>.
		
    <li>Added the <a class="property css" data-link-type="property" href="#propdef-item-flow" id="ref-for-propdef-item-flow①">item-flow</a> property and its longhands,
			as generic controls for item ordering and placement.
			See <a href="#flow-control">Appendix A: Generic Layout Item Flow Controls: the item-* properties</a>.
			(<a href="https://github.com/w3c/csswg-drafts/issues/11480">Issue 11480</a>)
	
   </ul>
   <h3 class="no-num heading settled" id="recent-changes"><span class="content">
Recent Changes</span><a class="self-link" href="#recent-changes"></a></h3>
   <p>The following changes have been made since the
	<a href="https://www.w3.org/TR/2024/WD-css-grid-3-20241003/">3 October Working Draft</a>:</p>
   <ul>
    <li data-md>
     <p>Dropped the masonry-specific track template and placement properties.
(<a href="https://github.com/w3c/csswg-drafts/issues/11243">Issue 11243</a>)</p>
    <li data-md>
     <p>Introduced <a class="property css" data-link-type="property" href="#propdef-item-flow" id="ref-for-propdef-item-flow②">item-flow</a> and the <span class="css">item-*</span> longhands,
replacing <span class="css">masonry-flow</span> and related properties.
(<a href="https://github.com/w3c/csswg-drafts/issues/11480">Issue 11480</a>)</p>
    <li data-md>
     <p>Renamed <span class="css">masonry-slack</span> to <a class="property css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack⑦">item-slack</a>.</p>
   </ul>
  </main>
  <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">
Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
  <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content">
Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    </p>
  <div class="example" id="w3c-example">
   <a class="self-link" href="#w3c-example"></a>
        
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <p>Advisements are normative sections styled to evoke special attention and are
    set apart from other normative text with <code>&lt;strong class="advisement"></code>, like
    this:

    <strong class="advisement">
        UAs MUST provide an accessible alternative.
    </strong></p>
  <details class="wpt-tests-block" dir="ltr" lang="en" open>
   <summary>Tests</summary>
   <p>Tests relating to the content of this specification
                     may be documented in “Tests” blocks like this one.
                     Any such block is non-normative.</p>
   <ul class="wpt-tests-list"></ul>
   <hr>
  </details>
  <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content">
Conformance classes</span><a class="self-link" href="#w3c-conformance-classes"></a></h3>
  <p>Conformance to this specification
    is defined for three conformance classes:
    </p>
  <dl>
   <dt>style sheet
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
            style sheet</a>.
        
   <dt>renderer
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
            that interprets the semantics of a style sheet and renders
            documents that use them.
        
   <dt>authoring tool
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
            that writes a style sheet.
    
  </dl>
  <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module.

    </p>
  <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.)

    </p>
  <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module.

</p>
  <h3 class="no-ref heading settled" id="w3c-partial"><span class="content">
Partial implementations</span><a class="self-link" href="#w3c-partial"></a></h3>
  <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong>
    treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>
  <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content">
Implementations of Unstable and Proprietary Features</span><a class="self-link" href="#w3c-conform-future-proofing"></a></h4>
  <p>To avoid clashes with future stable CSS features,
        the CSSWG recommends <a href="http://www.w3.org/TR/CSS/#future-proofing">following best practices</a> for the implementation of <a href="http://www.w3.org/TR/CSS/#unstable">unstable</a> features and <a href="http://www.w3.org/TR/CSS/#proprietary-extension">proprietary extensions</a> to CSS.

</p>
  <h3 class="no-ref heading settled" id="w3c-testing"><span class="content">
Non-experimental implementations</span><a class="self-link" href="#w3c-testing"></a></h3>
  <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec.

    </p>
  <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group.

    </p>
  <p>Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at
    <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the
    <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
    mailing list.</p>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li>
    auto
    <ul>
     <li><a href="#valdef-item-direction-auto">value for item-direction, item-track</a><span>, in § Unnumbered section</span>
     <li><a href="#valdef-item-wrap-auto">value for item-wrap, item-cross</a><span>, in § Unnumbered section</span>
    </ul>
   <li><a href="#valdef-repeat-auto-areas">auto-areas</a><span>, in § 3.3.1</span>
   <li><a href="#auto-placement-cursor">auto-placement cursor</a><span>, in § 4.3</span>
   <li><a href="#valdef-item-pack-balance">balance</a><span>, in § Unnumbered section</span>
   <li><a href="#valdef-item-pack-collapse">collapse</a><span>, in § Unnumbered section</span>
   <li><a href="#valdef-item-direction-column">column</a><span>, in § Unnumbered section</span>
   <li><a href="#column-masonry-container">column masonry container</a><span>, in § 2</span>
   <li><a href="#valdef-item-direction-column-reverse">column-reverse</a><span>, in § Unnumbered section</span>
   <li><a href="#valdef-item-pack-dense">dense</a><span>, in § Unnumbered section</span>
   <li><a href="#grid-axis">grid axis</a><span>, in § 2</span>
   <li><a href="#grid-axis">grid-axis</a><span>, in § 2</span>
   <li><a href="#valdef-item-slack-infinite">infinite</a><span>, in § 4.2</span>
   <li><a href="#propdef-item-cross">item-cross</a><span>, in § Unnumbered section</span>
   <li><a href="#propdef-item-direction">item-direction</a><span>, in § Unnumbered section</span>
   <li><a href="#propdef-item-flow">item-flow</a><span>, in § Unnumbered section</span>
   <li><a href="#item-groups">item groups</a><span>, in § 3.4.2</span>
   <li><a href="#propdef-item-pack">item-pack</a><span>, in § Unnumbered section</span>
   <li><a href="#propdef-item-slack">item-slack</a><span>, in § 4.2</span>
   <li><a href="#propdef-item-track">item-track</a><span>, in § Unnumbered section</span>
   <li><a href="#propdef-item-wrap">item-wrap</a><span>, in § Unnumbered section</span>
   <li><a href="#valdef-item-slack-length-percentage">&lt;length-percentage></a><span>, in § 4.2</span>
   <li><a href="#masonry-box">masonry box</a><span>, in § 6</span>
   <li><a href="#masonry-container">masonry container</a><span>, in § 2</span>
   <li><a href="#masonry-item">masonry item</a><span>, in § 2</span>
   <li><a href="#masonry-layout">Masonry layout</a><span>, in § 2</span>
   <li><a href="#masonry-track">masonry track</a><span>, in § 2</span>
   <li>
    normal
    <ul>
     <li><a href="#valdef-item-pack-normal">value for item-pack</a><span>, in § Unnumbered section</span>
     <li><a href="#valdef-item-wrap-normal">value for item-wrap, item-cross</a><span>, in § Unnumbered section</span>
    </ul>
   <li><a href="#valdef-item-wrap-nowrap">nowrap</a><span>, in § Unnumbered section</span>
   <li><a href="#primary-axis">primary axis</a><span>, in § Unnumbered section</span>
   <li><a href="#primary-placement-axis">primary placement axis</a><span>, in § Unnumbered section</span>
   <li><a href="#primary-track-axis">primary track axis</a><span>, in § Unnumbered section</span>
   <li><a href="#valdef-item-wrap-reverse">reverse</a><span>, in § Unnumbered section</span>
   <li><a href="#valdef-item-direction-row">row</a><span>, in § Unnumbered section</span>
   <li><a href="#row-masonry-container">row masonry container</a><span>, in § 2</span>
   <li><a href="#valdef-item-direction-row-reverse">row-reverse</a><span>, in § Unnumbered section</span>
   <li><a href="#running-position">running position</a><span>, in § 4.3</span>
   <li><a href="#stacking-axis">stacking axis</a><span>, in § 2</span>
   <li><a href="#stacking-axis">stacking-axis</a><span>, in § 2</span>
   <li><a href="#submasonry">submasonry</a><span>, in § 3.2</span>
   <li><a href="#masonry-tie-threshold">tie threshold</a><span>, in § 4.2</span>
   <li><a href="#virtual-masonry-item">virtual masonry item</a><span>, in § 3.4.2</span>
   <li><a href="#valdef-item-wrap-wrap">wrap</a><span>, in § Unnumbered section</span>
   <li><a href="#valdef-item-wrap-wrap-reverse">wrap-reverse</a><span>, in § Unnumbered section</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS-ALIGN-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ce1c3a64">align-content</span>
     <li><span class="dfn-paneled" id="9cb30ff4">alignment baseline</span>
     <li><span class="dfn-paneled" id="d15331bf">alignment subject</span>
     <li><span class="dfn-paneled" id="8e662436">baseline alignment</span>
     <li><span class="dfn-paneled" id="80175c82">baseline-sharing group</span>
     <li><span class="dfn-paneled" id="4bc11993">center</span>
     <li><span class="dfn-paneled" id="ca4fcf76">distributed alignment</span>
     <li><span class="dfn-paneled" id="2acd09de">end</span>
     <li><span class="dfn-paneled" id="bdadecb4">fallback alignment</span>
     <li><span class="dfn-paneled" id="0bf6e64a">grid-gap</span>
     <li><span class="dfn-paneled" id="75f6cfb6">justify-content</span>
     <li><span class="dfn-paneled" id="eb309e21">normal</span>
     <li><span class="dfn-paneled" id="b8850feb">start</span>
     <li><span class="dfn-paneled" id="9fe435f5">stretch</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-BOX-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="46c6a718">content box</span>
     <li><span class="dfn-paneled" id="154375a0">margin box</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-BREAK-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b8c7a216">forced break</span>
     <li><span class="dfn-paneled" id="5d82066a">fragmentainer</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CASCADE-5]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="31ccd1a9">longhand property</span>
     <li><span class="dfn-paneled" id="8ca0c013">shorthand property</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-DISPLAY-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="1a548a6a">blockify</span>
     <li><span class="dfn-paneled" id="ea663a43">containing block</span>
     <li><span class="dfn-paneled" id="e7f0dd6c">display</span>
     <li><span class="dfn-paneled" id="ecf777ac">reading-flow</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-FLEXBOX-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="24285d87">flex container</span>
     <li><span class="dfn-paneled" id="73a98e20">flex layout</span>
     <li><span class="dfn-paneled" id="3a74ed0c">flex-flow</span>
     <li><span class="dfn-paneled" id="dda6df97">flex-wrap</span>
     <li><span class="dfn-paneled" id="d6d433c0">multi-line flex container</span>
     <li><span class="dfn-paneled" id="7a8d5db2">order</span>
     <li><span class="dfn-paneled" id="11b7dd33">order-modified document order</span>
     <li><span class="dfn-paneled" id="1b3fde05">single-line flex container</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-GAPS-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f776fb8b">repeat()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-GRID-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f83b5bfc">auto</span>
     <li><span class="dfn-paneled" id="d5412931">auto-fill</span>
     <li><span class="dfn-paneled" id="a079e809">auto-fit</span>
     <li><span class="dfn-paneled" id="62c91816">automatic grid position</span>
     <li><span class="dfn-paneled" id="53deb49f">definite grid position</span>
     <li><span class="dfn-paneled" id="f9ab2883">definite position</span>
     <li><span class="dfn-paneled" id="f6ac6c55">explicit grid</span>
     <li><span class="dfn-paneled" id="e3ccce60">grid area</span>
     <li><span class="dfn-paneled" id="f005b2f6">grid container</span>
     <li><span class="dfn-paneled" id="1044d688">grid item</span>
     <li><span class="dfn-paneled" id="a27e1637">grid layout</span>
     <li><span class="dfn-paneled" id="79b8b44f">grid track</span>
     <li><span class="dfn-paneled" id="e8bb041c">grid-auto-columns</span>
     <li><span class="dfn-paneled" id="72d5680b">grid-auto-flow</span>
     <li><span class="dfn-paneled" id="a28c0f38">grid-auto-rows</span>
     <li><span class="dfn-paneled" id="ef47d3e4">grid-placement property</span>
     <li><span class="dfn-paneled" id="6276ac24">grid-template-areas</span>
     <li><span class="dfn-paneled" id="e0f38f8e">grid-template-columns</span>
     <li><span class="dfn-paneled" id="b47c7071">grid-template-rows</span>
     <li><span class="dfn-paneled" id="fdb725d6">implicit grid</span>
     <li><span class="dfn-paneled" id="31e4f4d0">implicit grid track</span>
     <li><span class="dfn-paneled" id="73e3a653">none <small>(for grid-template-areas)</small></span>
     <li><span class="dfn-paneled" id="842c0376">none <small>(for grid-template-rows)</small></span>
     <li><span class="dfn-paneled" id="c6c2ab78">subgrid</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-SIZING-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="11ee6625">available space</span>
     <li><span class="dfn-paneled" id="0bd2791e">max-content constraint</span>
     <li><span class="dfn-paneled" id="26a40c98">max-content size</span>
     <li><span class="dfn-paneled" id="6dc3914f">min-content constraint</span>
     <li><span class="dfn-paneled" id="3f0db204">min-content size</span>
     <li><span class="dfn-paneled" id="d0e23e1f">outer size</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-TEXT-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f9a0b0f1">text-wrap-style</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-VALUES-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="18222566">&lt;length-percentage></span>
     <li><span class="dfn-paneled" id="358fd6ff">CSS-wide keywords</span>
     <li><span class="dfn-paneled" id="6ec67710">|</span>
     <li><span class="dfn-paneled" id="8a82fda1">||</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-WRITING-MODES-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5bc8bd12">direction</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-WRITING-MODES-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="e1ab41b7">block axis</span>
     <li><span class="dfn-paneled" id="32995ff0">block-axis</span>
     <li><span class="dfn-paneled" id="43667deb">inline axis</span>
     <li><span class="dfn-paneled" id="8f96f376">inline-axis</span>
     <li><span class="dfn-paneled" id="a73617e0">writing mode</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-align-3">[CSS-ALIGN-3]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-align/"><cite>CSS Box Alignment Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-align/">https://drafts.csswg.org/css-align/</a>
   <dt id="biblio-css-box-4">[CSS-BOX-4]
   <dd>Elika Etemad. <a href="https://drafts.csswg.org/css-box-4/"><cite>CSS Box Model Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-box-4/">https://drafts.csswg.org/css-box-4/</a>
   <dt id="biblio-css-break-4">[CSS-BREAK-4]
   <dd>Rossen Atanassov; Elika Etemad. <a href="https://drafts.csswg.org/css-break-4/"><cite>CSS Fragmentation Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-break-4/">https://drafts.csswg.org/css-break-4/</a>
   <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
   <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-cascade-5/"><cite>CSS Cascading and Inheritance Level 5</cite></a>. URL: <a href="https://drafts.csswg.org/css-cascade-5/">https://drafts.csswg.org/css-cascade-5/</a>
   <dt id="biblio-css-display-4">[CSS-DISPLAY-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-display/"><cite>CSS Display Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-display/">https://drafts.csswg.org/css-display/</a>
   <dt id="biblio-css-flexbox-1">[CSS-FLEXBOX-1]
   <dd>Tab Atkins Jr.; et al. <a href="https://drafts.csswg.org/css-flexbox-1/"><cite>CSS Flexible Box Layout Module Level 1</cite></a>. URL: <a href="https://drafts.csswg.org/css-flexbox-1/">https://drafts.csswg.org/css-flexbox-1/</a>
   <dt id="biblio-css-gaps-1">[CSS-GAPS-1]
   <dd>Kevin Babbitt. <a href="https://drafts.csswg.org/css-gaps-1/"><cite>CSS Gap Decorations Module Level 1</cite></a>. URL: <a href="https://drafts.csswg.org/css-gaps-1/">https://drafts.csswg.org/css-gaps-1/</a>
   <dt id="biblio-css-grid-1">[CSS-GRID-1]
   <dd>Tab Atkins Jr.; et al. <a href="https://drafts.csswg.org/css-grid-1/"><cite>CSS Grid Layout Module Level 1</cite></a>. URL: <a href="https://drafts.csswg.org/css-grid-1/">https://drafts.csswg.org/css-grid-1/</a>
   <dt id="biblio-css-grid-2">[CSS-GRID-2]
   <dd>Tab Atkins Jr.; et al. <a href="https://drafts.csswg.org/css-grid-2/"><cite>CSS Grid Layout Module Level 2</cite></a>. URL: <a href="https://drafts.csswg.org/css-grid-2/">https://drafts.csswg.org/css-grid-2/</a>
   <dt id="biblio-css-sizing-3">[CSS-SIZING-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-sizing-3/"><cite>CSS Box Sizing Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-sizing-3/">https://drafts.csswg.org/css-sizing-3/</a>
   <dt id="biblio-css-text-4">[CSS-TEXT-4]
   <dd>Elika Etemad; et al. <a href="https://drafts.csswg.org/css-text-4/"><cite>CSS Text Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-text-4/">https://drafts.csswg.org/css-text-4/</a>
   <dt id="biblio-css-values-3">[CSS-VALUES-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-values-3/"><cite>CSS Values and Units Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-values-3/">https://drafts.csswg.org/css-values-3/</a>
   <dt id="biblio-css-values-4">[CSS-VALUES-4]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-values-4/"><cite>CSS Values and Units Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-values-4/">https://drafts.csswg.org/css-values-4/</a>
   <dt id="biblio-css-writing-modes-4">[CSS-WRITING-MODES-4]
   <dd>Elika Etemad; Koji Ishii. <a href="https://drafts.csswg.org/css-writing-modes-4/"><cite>CSS Writing Modes Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-writing-modes-4/">https://drafts.csswg.org/css-writing-modes-4/</a>
   <dt id="biblio-css2">[CSS2]
   <dd>Bert Bos; et al. <a href="https://drafts.csswg.org/css2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</cite></a>. URL: <a href="https://drafts.csswg.org/css2/">https://drafts.csswg.org/css2/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-css-multicol-1">[CSS-MULTICOL-1]
   <dd>Florian Rivoal; Rachel Andrew. <a href="https://drafts.csswg.org/css-multicol/"><cite>CSS Multi-column Layout Module Level 1</cite></a>. URL: <a href="https://drafts.csswg.org/css-multicol/">https://drafts.csswg.org/css-multicol/</a>
   <dt id="biblio-css-writing-modes-3">[CSS-WRITING-MODES-3]
   <dd>Elika Etemad; Koji Ishii. <a href="https://drafts.csswg.org/css-writing-modes-3/"><cite>CSS Writing Modes Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-writing-modes-3/">https://drafts.csswg.org/css-writing-modes-3/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">Property Index</span><a class="self-link" href="#property-index"></a></h2>
  <div class="big-element-wrapper">
   <table class="index">
    <thead>
     <tr>
      <th scope="col">Name
      <th scope="col">Value
      <th scope="col">Initial
      <th scope="col">Applies to
      <th scope="col">Inh.
      <th scope="col">%ages
      <th scope="col">Anim­ation type
      <th scope="col">Canonical order
      <th scope="col">Com­puted value
    <tbody>
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-item-cross" id="ref-for-propdef-item-cross②">item-cross</a>
      <td>[ auto | nowrap | wrap ] || [ normal | reverse ] | wrap-reverse
      <td>auto
      <td>flex containers, grid containers, masonry containers
      <td>no
      <td>N/A
      <td>discrete
      <td>per grammar
      <td>as specified
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-item-direction" id="ref-for-propdef-item-direction④">item-direction</a>
      <td>auto | row | column | row-reverse | column-reverse
      <td>auto
      <td>flex containers, grid containers, masonry containers
      <td>no
      <td>N/A
      <td>discrete
      <td>per grammar
      <td>as specified
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-item-flow" id="ref-for-propdef-item-flow③">item-flow</a>
      <td>&lt;'item-direction'> || &lt;'item-wrap'> || &lt;'item-pack'> || &lt;'item-slack'>
      <td>see individual properties
      <td>see individual properties
      <td>see individual properties
      <td>see individual properties
      <td>see individual properties
      <td>per grammar
      <td>see individual properties
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-item-pack" id="ref-for-propdef-item-pack⑦">item-pack</a>
      <td>normal | dense || balance
      <td>normal
      <td>flex containers, grid containers, masonry containers
      <td>no
      <td>N/A
      <td>discrete
      <td>per grammar
      <td>as specified
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-item-slack" id="ref-for-propdef-item-slack⑧">item-slack</a>
      <td>&lt;length-percentage> | infinite
      <td>1em
      <td>masonry containers
      <td>no
      <td>relative to the grid-axis content box size of the masonry container
      <td>as length
      <td>per grammar
      <td>a computed &lt;length-percentage> value
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-item-track" id="ref-for-propdef-item-track③">item-track</a>
      <td>auto | row | column | row-reverse | column-reverse
      <td>auto
      <td>flex containers, grid containers, masonry containers
      <td>no
      <td>N/A
      <td>discrete
      <td>per grammar
      <td>as specified
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-item-wrap" id="ref-for-propdef-item-wrap③">item-wrap</a>
      <td>[ auto | nowrap | wrap ] || [ normal | reverse ] | wrap-reverse
      <td>auto
      <td>flex containers, grid containers, masonry containers
      <td>no
      <td>N/A
      <td>discrete
      <td>per grammar
      <td>as specified
   </table>
  </div>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Or should reordering be the default behavior for auto-placed items here? <a class="issue-return" href="#issue-f3901e05" title="Jump to section">↵</a></div>
   <div class="issue">
    
	ISSUE(11593): We are still debating what syntactic switch establishes a <a data-link-type="dfn" href="#masonry-layout">masonry layout</a>.
		Proposals so far include:

    <ul>
     <li data-md>
      <p><a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-display-4/#propdef-display">display: masonry</a> (or a synonym, such as <span class="css">display: stack</span>)</p>
     <li data-md>
      <p><a class="css" data-link-type="propdesc" href="#propdef-item-pack">item-pack: collapse</a> (see <span class="property">item-pack</span>)</p>
     <li data-md>
      <p>a <span class="css">collapse</span> value for <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-rows">grid-template-rows</a>/<a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-template-columns">grid-template-columns</a>,
indicating that axis as the <a data-link-type="dfn" href="#stacking-axis">stacking axis</a> of a <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-container">grid container</a></p>
    </ul>
    	 <a class="issue-return" href="#issue-65868180" title="Jump to section">↵</a>
   </div>
   <div class="issue"> What should be the initial track listing? <a href="https://github.com/w3c/csswg-drafts/issues/10869">[Issue #10869]</a> <a class="issue-return" href="#issue-f0b2f95f" title="Jump to section">↵</a></div>
   <div class="issue"> Should we allow auto-repeated content-based tracks?
	Is this a reasonable definition for them?
	Should they work also in Grid Layout somehow? <a href="https://github.com/w3c/csswg-drafts/issues/10915">[Issue #10915]</a> <a class="issue-return" href="#issue-b1e94dcd" title="Jump to section">↵</a></div>
   <div class="issue"> It’s unclear if we actually need this value.
	Note that the explicit grid already takes values from <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-columns">grid-auto-columns</a>/<a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-rows">grid-auto-rows</a>/<u class="property link-error" data-lt="masonry-auto-tracks" title="LINK ERROR: No &apos;property&apos; refs found for &apos;masonry-auto-tracks&apos;.">masonry-auto-tracks</u>
	as needed to match the number of template areas. <a href="https://github.com/w3c/csswg-drafts/issues/10854">[Issue #10854]</a> <a class="issue-return" href="#issue-33a96346" title="Jump to section">↵</a></div>
   <div class="issue"> Need a better example!!! <a class="issue-return" href="#issue-33788d66" title="Jump to section">↵</a></div>
   <div class="issue"> Is <span class="css">1em</span> the right default? <a class="issue-return" href="#issue-7bbfe9d5" title="Jump to section">↵</a></div>
   <div class="issue"> Should this also update the placement cursor? <a class="issue-return" href="#issue-9c647ef6" title="Jump to section">↵</a></div>
   <div class="issue"> Should alignment in the stacking axis do something more sophisticated?
	What should that be? <a class="issue-return" href="#issue-491b71c9" title="Jump to section">↵</a></div>
   <div class="issue"> We could support baseline alignment in the first row. Do we want to? <a class="issue-return" href="#issue-4a2d589c" title="Jump to section">↵</a></div>
   <div class="issue"> Should the last baseline come from the last lowest item placed instead? <a class="issue-return" href="#issue-f1320409" title="Jump to section">↵</a></div>
   <div class="issue"> It might be useful to define a static position in the <a data-link-type="dfn" href="#stacking-axis">stacking axis</a>.
	Maybe it could defined as the max (or min?) current <a data-link-type="dfn" href="#running-position">running position</a>
	of the <a data-link-type="dfn" href="#grid-axis">grid-axis</a> tracks at that point?  Or the end of the item before it? <a class="issue-return" href="#issue-4007c2e6" title="Jump to section">↵</a></div>
   <div class="issue"> This section is likely to move to another spec,
	such as <a data-link-type="biblio" href="#biblio-css-display-4" title="CSS Display Module Level 4">[css-display-4]</a>,
	since it affects multiple display types. <a class="issue-return" href="#issue-fd53eff2" title="Jump to section">↵</a></div>
   <div class="issue"> The CSSWG is still figuring out how these properties should be named and fit together. <a href="https://github.com/w3c/csswg-drafts/issues/11480">[Issue #11480]</a> <a class="issue-return" href="#issue-c971c9c1" title="Jump to section">↵</a></div>
   <div class="issue"> There two open debates on this property:
	a) what should it be called and
	b) does it describe the primary direction of placement,
		or the orientation of the tracks into which items are placed;
		in other words, is the <span>primary axis</span> defined by this property
		the <span>primary placement axis</span> or the <span>primary track axis</span>.
	These are identical for <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-layout">flex layout</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-2/#grid-layout">grid layout</a>,
	but differ for <a data-link-type="dfn" href="#masonry-layout">masonry layout</a> whose primary placement direction
	is across its tracks. <a href="https://github.com/w3c/csswg-drafts/issues/11480">[Issue #11480]</a> <a class="issue-return" href="#issue-80d7796e" title="Jump to section">↵</a></div>
   <div class="issue"> The interpretation and naming of this property depends on
	the interpretation of axes for <a class="property css" data-link-type="property" href="#propdef-item-direction">item-direction</a>/<a class="property css" data-link-type="property" href="#propdef-item-track">item-track</a>. <a href="https://github.com/w3c/csswg-drafts/issues/11480">[Issue #11480]</a> <a class="issue-return" href="#issue-b3c639a9" title="Jump to section">↵</a></div>
   <div class="issue"> One of the proposals for switching into <a data-link-type="dfn" href="#masonry-layout">masonry layout</a>
	is to add a <span>collapse</span> value
	to this <a class="property css" data-link-type="property" href="#propdef-item-pack">item-pack</a> property. <a href="https://github.com/w3c/csswg-drafts/issues/11243">[Issue #11243]</a> <a class="issue-return" href="#issue-1efcc181" title="Jump to section">↵</a></div>
   <div class="issue">
	Should <span class="css">dense</span> packing apply to masonry?
	It’s much more expensive in masonry,
	as you have to lay out the element in every possible gap spot
	to see if it’s short enough to fit;
	Grid gets to just juggle some integers. <a href="https://github.com/w3c/csswg-drafts/issues/9326">[Issue #9326]</a> <a class="issue-return" href="#issue-152d283d" title="Jump to section">↵</a></div>
  </div>
  <details class="mdn-anno unpositioned" data-anno-for="tracks-alignment">
   <summary><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/align-tracks" title="The align-tracks CSS property sets the alignment in the masonry axis for grid containers that have masonry in their block axis.">align-tracks</a></p>
    <p class="less-than-two-engines-text">In only one current engine.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span title="Requires setting a user preference or runtime flag.">🔰 77+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/justify-tracks" title="The justify-tracks CSS property sets the alignment in the masonry axis for grid containers that have masonry in their inline axis.">justify-tracks</a></p>
    <p class="less-than-two-engines-text">In only one current engine.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span title="Requires setting a user preference or runtime flag.">🔰 77+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="masonry-layout">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/grid-template-columns" title="The grid-template-columns CSS property defines the line names and track sizing functions of the grid columns.">grid-template-columns</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>52+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>57+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>6.0+</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout/Masonry_Layout" title="Level 3 of the CSS grid layout specification includes a masonry value for grid-template-columns and grid-template-rows. This guide details what masonry layout is and how to use it.">CSS_Grid_Layout/Masonry_Layout</a></p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span title="Requires setting a user preference or runtime flag.">🔰 77+</span></span><span class="safari yes"><span>Safari</span><span>preview+</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/grid-template-rows" title="The grid-template-rows CSS property defines the line names and track sizing functions of the grid rows.">grid-template-rows</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>52+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>57+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>6.0+</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="masonry-auto-flow">
   <summary><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/masonry-auto-flow" title="The masonry-auto-flow CSS property modifies how items are placed when using masonry in CSS Grid Layout.">masonry-auto-flow</a></p>
    <p class="less-than-two-engines-text">In only one current engine.</p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>preview+</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"0bd2791e": {"dfnID":"0bd2791e","dfnText":"max-content constraint","external":true,"refSections":[{"refs":[{"id":"ref-for-max-content-constraint"}],"title":"5. \nSizing Grid Containers"}],"url":"https://drafts.csswg.org/css-sizing-3/#max-content-constraint"},
"0bf6e64a": {"dfnID":"0bf6e64a","dfnText":"grid-gap","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-grid-gap"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"https://drafts.csswg.org/css-align-3/#propdef-grid-gap"},
"1044d688": {"dfnID":"1044d688","dfnText":"grid item","external":true,"refSections":[{"refs":[{"id":"ref-for-grid-item"},{"id":"ref-for-grid-item\u2460"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-grid-item\u2461"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"},{"refs":[{"id":"ref-for-grid-item\u2462"}],"title":"4.3.1. \nContaining Block"},{"refs":[{"id":"ref-for-grid-item\u2463"},{"id":"ref-for-grid-item\u2464"}],"title":"6. \nAlignment and Spacing"},{"refs":[{"id":"ref-for-grid-item\u2465"},{"id":"ref-for-grid-item\u2466"}],"title":"6.1. \nBaseline Alignment in the stacking axis"},{"refs":[{"id":"ref-for-grid-item\u2467"}],"title":"7.1. \nFragmentation in the stacking axis"}],"url":"https://drafts.csswg.org/css-grid-2/#grid-item"},
"11b7dd33": {"dfnID":"11b7dd33","dfnText":"order-modified document order","external":true,"refSections":[{"refs":[{"id":"ref-for-order-modified-document-order"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"https://www.w3.org/TR/css-flexbox-1/#order-modified-document-order"},
"11ee6625": {"dfnID":"11ee6625","dfnText":"available space","external":true,"refSections":[{"refs":[{"id":"ref-for-available"}],"title":"3. \nMasonry Track Specification"}],"url":"https://drafts.csswg.org/css-sizing-3/#available"},
"154375a0": {"dfnID":"154375a0","dfnText":"margin box","external":true,"refSections":[{"refs":[{"id":"ref-for-margin-box"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-box-4/#margin-box"},
"18222566": {"dfnID":"18222566","dfnText":"<length-percentage>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-length-percentage"},{"id":"ref-for-typedef-length-percentage\u2460"},{"id":"ref-for-typedef-length-percentage\u2461"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-typedef-length-percentage\u2462"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"}],"url":"https://drafts.csswg.org/css-values-4/#typedef-length-percentage"},
"1a548a6a": {"dfnID":"1a548a6a","dfnText":"blockify","external":true,"refSections":[{"refs":[{"id":"ref-for-blockify"}],"title":"2. \nMasonry Layout Model"}],"url":"https://drafts.csswg.org/css-display-4/#blockify"},
"1b3fde05": {"dfnID":"1b3fde05","dfnText":"single-line flex container","external":true,"refSections":[{"refs":[{"id":"ref-for-single-line-flex-container"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"https://drafts.csswg.org/css-flexbox-1/#single-line-flex-container"},
"24285d87": {"dfnID":"24285d87","dfnText":"flex container","external":true,"refSections":[{"refs":[{"id":"ref-for-flex-container"},{"id":"ref-for-flex-container\u2460"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-flex-container\u2461"},{"id":"ref-for-flex-container\u2462"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-flex-container\u2463"}],"title":"\nItem Placement Packing Mode: the item-pack property"}],"url":"https://drafts.csswg.org/css-flexbox-1/#flex-container"},
"26a40c98": {"dfnID":"26a40c98","dfnText":"max-content size","external":true,"refSections":[{"refs":[{"id":"ref-for-max-content"}],"title":"5. \nSizing Grid Containers"}],"url":"https://drafts.csswg.org/css-sizing-3/#max-content"},
"2acd09de": {"dfnID":"2acd09de","dfnText":"end","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-self-position-end"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#valdef-self-position-end"},
"31ccd1a9": {"dfnID":"31ccd1a9","dfnText":"longhand property","external":true,"refSections":[{"refs":[{"id":"ref-for-longhand"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"}],"url":"https://drafts.csswg.org/css-cascade-5/#longhand"},
"31e4f4d0": {"dfnID":"31e4f4d0","dfnText":"implicit grid track","external":true,"refSections":[{"refs":[{"id":"ref-for-implicit-grid-track"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"https://drafts.csswg.org/css-grid-2/#implicit-grid-track"},
"32995ff0": {"dfnID":"32995ff0","dfnText":"block-axis","external":true,"refSections":[{"refs":[{"id":"ref-for-block-axis"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-block-axis\u2460"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-block-axis\u2461"},{"id":"ref-for-block-axis\u2462"}],"title":"7.1. \nFragmentation in the stacking axis"},{"refs":[{"id":"ref-for-block-axis\u2463"}],"title":"7.2. \nFragmentation in the Grid Axis"},{"refs":[{"id":"ref-for-block-axis\u2464"}],"title":"9. \nGraceful Degradation"},{"refs":[{"id":"ref-for-block-axis\u2465"},{"id":"ref-for-block-axis\u2466"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"https://drafts.csswg.org/css-writing-modes-4/#block-axis"},
"358fd6ff": {"dfnID":"358fd6ff","dfnText":"CSS-wide keywords","external":true,"refSections":[{"refs":[{"id":"ref-for-css-wide-keywords"}],"title":"1.2. \nValue Definitions"}],"url":"https://drafts.csswg.org/css-values-4/#css-wide-keywords"},
"3a74ed0c": {"dfnID":"3a74ed0c","dfnText":"flex-flow","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-flex-flow"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"}],"url":"https://drafts.csswg.org/css-flexbox-1/#propdef-flex-flow"},
"3f0db204": {"dfnID":"3f0db204","dfnText":"min-content size","external":true,"refSections":[{"refs":[{"id":"ref-for-min-content"}],"title":"5. \nSizing Grid Containers"}],"url":"https://drafts.csswg.org/css-sizing-3/#min-content"},
"43667deb": {"dfnID":"43667deb","dfnText":"inline axis","external":true,"refSections":[{"refs":[{"id":"ref-for-inline-axis"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-inline-axis\u2460"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-inline-axis\u2461"},{"id":"ref-for-inline-axis\u2462"}],"title":"7.2. \nFragmentation in the Grid Axis"},{"refs":[{"id":"ref-for-inline-axis\u2463"},{"id":"ref-for-inline-axis\u2464"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"https://drafts.csswg.org/css-writing-modes-4/#inline-axis"},
"46c6a718": {"dfnID":"46c6a718","dfnText":"content box","external":true,"refSections":[{"refs":[{"id":"ref-for-content-box"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-content-box\u2460"}],"title":"4.3.1. \nContaining Block"},{"refs":[{"id":"ref-for-content-box\u2461"},{"id":"ref-for-content-box\u2462"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-box-4/#content-box"},
"4bc11993": {"dfnID":"4bc11993","dfnText":"center","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-self-position-center"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#valdef-self-position-center"},
"53deb49f": {"dfnID":"53deb49f","dfnText":"definite grid position","external":true,"refSections":[{"refs":[{"id":"ref-for-definite-grid-position"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-definite-grid-position\u2460"}],"title":"3.4.1. \nSubgrid Item Contributions"},{"refs":[{"id":"ref-for-definite-grid-position\u2461"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"https://drafts.csswg.org/css-grid-2/#definite-grid-position"},
"5bc8bd12": {"dfnID":"5bc8bd12","dfnText":"direction","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-direction"},{"id":"ref-for-propdef-direction\u2460"},{"id":"ref-for-propdef-direction\u2461"},{"id":"ref-for-propdef-direction\u2462"},{"id":"ref-for-propdef-direction\u2463"}],"title":"4.3.2. \nPlacement and Writing Modes"}],"url":"https://drafts.csswg.org/css-writing-modes-3/#propdef-direction"},
"5d82066a": {"dfnID":"5d82066a","dfnText":"fragmentainer","external":true,"refSections":[{"refs":[{"id":"ref-for-fragmentainer"}],"title":"7.1. \nFragmentation in the stacking axis"}],"url":"https://drafts.csswg.org/css-break-4/#fragmentainer"},
"6276ac24": {"dfnID":"6276ac24","dfnText":"grid-template-areas","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-grid-template-areas"},{"id":"ref-for-propdef-grid-template-areas\u2460"}],"title":"3.3.1. \nrepeat(auto-areas)"}],"url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-areas"},
"62c91816": {"dfnID":"62c91816","dfnText":"automatic grid position","external":true,"refSections":[{"refs":[{"id":"ref-for-automatic-grid-position"},{"id":"ref-for-automatic-grid-position\u2460"}],"title":"3.4. \nGrid Axis Track Sizing"},{"refs":[{"id":"ref-for-automatic-grid-position\u2461"},{"id":"ref-for-automatic-grid-position\u2462"}],"title":"3.4.1. \nSubgrid Item Contributions"},{"refs":[{"id":"ref-for-automatic-grid-position\u2463"}],"title":"3.4.2. \nOptimized Track Sizing"},{"refs":[{"id":"ref-for-automatic-grid-position\u2464"}],"title":"4. \nMasonry Placement"}],"url":"https://drafts.csswg.org/css-grid-2/#automatic-grid-position"},
"6dc3914f": {"dfnID":"6dc3914f","dfnText":"min-content constraint","external":true,"refSections":[{"refs":[{"id":"ref-for-min-content-constraint"}],"title":"5. \nSizing Grid Containers"}],"url":"https://drafts.csswg.org/css-sizing-3/#min-content-constraint"},
"6ec67710": {"dfnID":"6ec67710","dfnText":"|","external":true,"refSections":[{"refs":[{"id":"ref-for-comb-one"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-comb-one\u2460"},{"id":"ref-for-comb-one\u2461"},{"id":"ref-for-comb-one\u2462"},{"id":"ref-for-comb-one\u2463"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-comb-one\u2464"},{"id":"ref-for-comb-one\u2465"},{"id":"ref-for-comb-one\u2466"},{"id":"ref-for-comb-one\u2467"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-comb-one\u2468"}],"title":"\nItem Placement Packing Mode: the item-pack property"}],"url":"https://drafts.csswg.org/css-values-4/#comb-one"},
"72d5680b": {"dfnID":"72d5680b","dfnText":"grid-auto-flow","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-grid-auto-flow"},{"id":"ref-for-propdef-grid-auto-flow\u2460"},{"id":"ref-for-propdef-grid-auto-flow\u2461"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"}],"url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-flow"},
"73a98e20": {"dfnID":"73a98e20","dfnText":"flex layout","external":true,"refSections":[{"refs":[{"id":"ref-for-flex-layout"}],"title":"1.1.2. \nOne-dimensional Grid Layout"},{"refs":[{"id":"ref-for-flex-layout\u2460"},{"id":"ref-for-flex-layout\u2461"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-flex-layout\u2462"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-flex-layout\u2463"},{"id":"ref-for-flex-layout\u2464"},{"id":"ref-for-flex-layout\u2465"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-flex-layout\u2466"},{"id":"ref-for-flex-layout\u2467"},{"id":"ref-for-flex-layout\u2468"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-flex-layout\u2460\u24ea"},{"id":"ref-for-flex-layout\u2460\u2460"}],"title":"\nItem Placement Packing Mode: the item-pack property"}],"url":"https://drafts.csswg.org/css-flexbox-1/#flex-layout"},
"73e3a653": {"dfnID":"73e3a653","dfnText":"none (for grid-template-areas)","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-grid-template-areas-none"}],"title":"3.3.1. \nrepeat(auto-areas)"}],"url":"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-areas-none"},
"75f6cfb6": {"dfnID":"75f6cfb6","dfnText":"justify-content","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-justify-content"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#propdef-justify-content"},
"79b8b44f": {"dfnID":"79b8b44f","dfnText":"grid track","external":true,"refSections":[{"refs":[{"id":"ref-for-grid-track"}],"title":"2. \nMasonry Layout Model"}],"url":"https://drafts.csswg.org/css-grid-2/#grid-track"},
"7a8d5db2": {"dfnID":"7a8d5db2","dfnText":"order","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-order"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-propdef-order\u2460"}],"title":"2.1. \nReordering and Accessibility"}],"url":"https://www.w3.org/TR/css-flexbox-1/#propdef-order"},
"80175c82": {"dfnID":"80175c82","dfnText":"baseline-sharing group","external":true,"refSections":[{"refs":[{"id":"ref-for-baseline-sharing-group"}],"title":"3.4.2. \nOptimized Track Sizing"}],"url":"https://drafts.csswg.org/css-align-3/#baseline-sharing-group"},
"842c0376": {"dfnID":"842c0376","dfnText":"none (for grid-template-rows)","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-grid-template-rows-none"},{"id":"ref-for-valdef-grid-template-rows-none\u2460"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-rows-none"},
"8a82fda1": {"dfnID":"8a82fda1","dfnText":"||","external":true,"refSections":[{"refs":[{"id":"ref-for-comb-any"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-comb-any\u2460"}],"title":"\nItem Placement Packing Mode: the item-pack property"},{"refs":[{"id":"ref-for-comb-any\u2461"},{"id":"ref-for-comb-any\u2462"},{"id":"ref-for-comb-any\u2463"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"}],"url":"https://drafts.csswg.org/css-values-4/#comb-any"},
"8ca0c013": {"dfnID":"8ca0c013","dfnText":"shorthand property","external":true,"refSections":[{"refs":[{"id":"ref-for-shorthand-property"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"}],"url":"https://drafts.csswg.org/css-cascade-5/#shorthand-property"},
"8e662436": {"dfnID":"8e662436","dfnText":"baseline alignment","external":true,"refSections":[{"refs":[{"id":"ref-for-baseline-alignment"}],"title":"3.4.2. \nOptimized Track Sizing"},{"refs":[{"id":"ref-for-baseline-alignment\u2460"}],"title":"6. \nAlignment and Spacing"},{"refs":[{"id":"ref-for-baseline-alignment\u2461"},{"id":"ref-for-baseline-alignment\u2462"}],"title":"6.1. \nBaseline Alignment in the stacking axis"}],"url":"https://drafts.csswg.org/css-align-3/#baseline-alignment"},
"8f96f376": {"dfnID":"8f96f376","dfnText":"inline-axis","external":true,"refSections":[{"refs":[{"id":"ref-for-inline-axis"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-inline-axis\u2460"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-inline-axis\u2461"},{"id":"ref-for-inline-axis\u2462"}],"title":"7.2. \nFragmentation in the Grid Axis"},{"refs":[{"id":"ref-for-inline-axis\u2463"},{"id":"ref-for-inline-axis\u2464"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"https://drafts.csswg.org/css-writing-modes-4/#inline-axis"},
"9cb30ff4": {"dfnID":"9cb30ff4","dfnText":"alignment baseline","external":true,"refSections":[{"refs":[{"id":"ref-for-alignment-baseline"}],"title":"6.1. \nBaseline Alignment in the stacking axis"}],"url":"https://drafts.csswg.org/css-align-3/#alignment-baseline"},
"9fe435f5": {"dfnID":"9fe435f5","dfnText":"stretch","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-align-content-stretch"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#valdef-align-content-stretch"},
"a079e809": {"dfnID":"a079e809","dfnText":"auto-fit","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-repeat-auto-fit"},{"id":"ref-for-valdef-repeat-auto-fit\u2460"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"},{"refs":[{"id":"ref-for-valdef-repeat-auto-fit\u2461"},{"id":"ref-for-valdef-repeat-auto-fit\u2462"}],"title":"3.3.1. \nrepeat(auto-areas)"},{"refs":[{"id":"ref-for-valdef-repeat-auto-fit\u2463"},{"id":"ref-for-valdef-repeat-auto-fit\u2464"},{"id":"ref-for-valdef-repeat-auto-fit\u2465"}],"title":"3.3.2. \nrepeat(auto-fit)"}],"url":"https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit"},
"a27e1637": {"dfnID":"a27e1637","dfnText":"grid layout","external":true,"refSections":[{"refs":[{"id":"ref-for-grid-layout"},{"id":"ref-for-grid-layout\u2460"}],"title":"1.1.2. \nOne-dimensional Grid Layout"},{"refs":[{"id":"ref-for-grid-layout\u2461"},{"id":"ref-for-grid-layout\u2462"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-grid-layout\u2463"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-grid-layout\u2464"},{"id":"ref-for-grid-layout\u2465"},{"id":"ref-for-grid-layout\u2466"}],"title":"3. \nMasonry Track Specification"},{"refs":[{"id":"ref-for-grid-layout\u2467"}],"title":"4.1. \nSpecifying Masonry Item Placement: the grid-column-* and grid-row-* properties"},{"refs":[{"id":"ref-for-grid-layout\u2468"}],"title":"4.3.2. \nPlacement and Writing Modes"},{"refs":[{"id":"ref-for-grid-layout\u2460\u24ea"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-grid-layout\u2460\u2460"},{"id":"ref-for-grid-layout\u2460\u2461"},{"id":"ref-for-grid-layout\u2460\u2462"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"https://drafts.csswg.org/css-grid-2/#grid-layout"},
"a28c0f38": {"dfnID":"a28c0f38","dfnText":"grid-auto-rows","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-grid-auto-rows"}],"title":"3.1. \nDeclaring Masonry Track Templates: the grid-template-* properties"},{"refs":[{"id":"ref-for-propdef-grid-auto-rows\u2460"}],"title":"3.3.1. \nrepeat(auto-areas)"}],"url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-rows"},
"a73617e0": {"dfnID":"a73617e0","dfnText":"writing mode","external":true,"refSections":[{"refs":[{"id":"ref-for-writing-mode"}],"title":"4.3.2. \nPlacement and Writing Modes"}],"url":"https://drafts.csswg.org/css-writing-modes-4/#writing-mode"},
"auto-placement-cursor": {"dfnID":"auto-placement-cursor","dfnText":"auto-placement cursor","external":false,"refSections":[{"refs":[{"id":"ref-for-auto-placement-cursor"},{"id":"ref-for-auto-placement-cursor\u2460"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"#auto-placement-cursor"},
"b47c7071": {"dfnID":"b47c7071","dfnText":"grid-template-rows","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-grid-template-rows"}],"title":"2.2. \nEstablishing Masonry Layout"},{"refs":[{"id":"ref-for-propdef-grid-template-rows\u2460"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-rows"},
"b8850feb": {"dfnID":"b8850feb","dfnText":"start","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-self-position-start"},{"id":"ref-for-valdef-self-position-start\u2460"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#valdef-self-position-start"},
"b8c7a216": {"dfnID":"b8c7a216","dfnText":"forced break","external":true,"refSections":[{"refs":[{"id":"ref-for-forced-break"}],"title":"7.1. \nFragmentation in the stacking axis"}],"url":"https://drafts.csswg.org/css-break-4/#forced-break"},
"bdadecb4": {"dfnID":"bdadecb4","dfnText":"fallback alignment","external":true,"refSections":[{"refs":[{"id":"ref-for-fallback-alignment"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#fallback-alignment"},
"c6c2ab78": {"dfnID":"c6c2ab78","dfnText":"subgrid","external":true,"refSections":[{"refs":[{"id":"ref-for-subgrid"},{"id":"ref-for-subgrid\u2460"},{"id":"ref-for-subgrid\u2461"}],"title":"3.2. \nSubgrids"}],"url":"https://drafts.csswg.org/css-grid-2/#subgrid"},
"ca4fcf76": {"dfnID":"ca4fcf76","dfnText":"distributed alignment","external":true,"refSections":[{"refs":[{"id":"ref-for-distributed-alignment"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#distributed-alignment"},
"ce1c3a64": {"dfnID":"ce1c3a64","dfnText":"align-content","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-align-content"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#propdef-align-content"},
"column-masonry-container": {"dfnID":"column-masonry-container","dfnText":"column masonry container","external":false,"refSections":[],"url":"#column-masonry-container"},
"d0e23e1f": {"dfnID":"d0e23e1f","dfnText":"outer size","external":true,"refSections":[{"refs":[{"id":"ref-for-outer-size"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"https://drafts.csswg.org/css-sizing-3/#outer-size"},
"d15331bf": {"dfnID":"d15331bf","dfnText":"alignment subject","external":true,"refSections":[{"refs":[{"id":"ref-for-alignment-subject"},{"id":"ref-for-alignment-subject\u2460"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#alignment-subject"},
"d5412931": {"dfnID":"d5412931","dfnText":"auto-fill","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-repeat-auto-fill"},{"id":"ref-for-valdef-repeat-auto-fill\u2460"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"},{"refs":[{"id":"ref-for-valdef-repeat-auto-fill\u2461"},{"id":"ref-for-valdef-repeat-auto-fill\u2462"}],"title":"3.3.2. \nrepeat(auto-fit)"}],"url":"https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fill"},
"d6d433c0": {"dfnID":"d6d433c0","dfnText":"multi-line flex container","external":true,"refSections":[{"refs":[{"id":"ref-for-multi-line-flex-container"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"https://drafts.csswg.org/css-flexbox-1/#multi-line-flex-container"},
"dda6df97": {"dfnID":"dda6df97","dfnText":"flex-wrap","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-flex-wrap"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"https://drafts.csswg.org/css-flexbox-1/#propdef-flex-wrap"},
"e0f38f8e": {"dfnID":"e0f38f8e","dfnText":"grid-template-columns","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-grid-template-columns"}],"title":"2.2. \nEstablishing Masonry Layout"},{"refs":[{"id":"ref-for-propdef-grid-template-columns\u2460"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-propdef-grid-template-columns\u2461"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-columns"},
"e1ab41b7": {"dfnID":"e1ab41b7","dfnText":"block axis","external":true,"refSections":[{"refs":[{"id":"ref-for-block-axis"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-block-axis\u2460"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-block-axis\u2461"},{"id":"ref-for-block-axis\u2462"}],"title":"7.1. \nFragmentation in the stacking axis"},{"refs":[{"id":"ref-for-block-axis\u2463"}],"title":"7.2. \nFragmentation in the Grid Axis"},{"refs":[{"id":"ref-for-block-axis\u2464"}],"title":"9. \nGraceful Degradation"},{"refs":[{"id":"ref-for-block-axis\u2465"},{"id":"ref-for-block-axis\u2466"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"https://drafts.csswg.org/css-writing-modes-4/#block-axis"},
"e3ccce60": {"dfnID":"e3ccce60","dfnText":"grid area","external":true,"refSections":[{"refs":[{"id":"ref-for-grid-area"}],"title":"4.3.1. \nContaining Block"}],"url":"https://drafts.csswg.org/css-grid-2/#grid-area"},
"e7f0dd6c": {"dfnID":"e7f0dd6c","dfnText":"display","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-display"},{"id":"ref-for-propdef-display\u2460"}],"title":"2.2. \nEstablishing Masonry Layout"}],"url":"https://drafts.csswg.org/css-display-4/#propdef-display"},
"e8bb041c": {"dfnID":"e8bb041c","dfnText":"grid-auto-columns","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-grid-auto-columns"}],"title":"3.1. \nDeclaring Masonry Track Templates: the grid-template-* properties"},{"refs":[{"id":"ref-for-propdef-grid-auto-columns\u2460"}],"title":"3.3.1. \nrepeat(auto-areas)"}],"url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-columns"},
"ea663a43": {"dfnID":"ea663a43","dfnText":"containing block","external":true,"refSections":[{"refs":[{"id":"ref-for-containing-block"}],"title":"4.3.1. \nContaining Block"}],"url":"https://drafts.csswg.org/css-display-4/#containing-block"},
"eb309e21": {"dfnID":"eb309e21","dfnText":"normal","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-justify-content-normal"}],"title":"6. \nAlignment and Spacing"}],"url":"https://drafts.csswg.org/css-align-3/#valdef-justify-content-normal"},
"ecf777ac": {"dfnID":"ecf777ac","dfnText":"reading-flow","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-reading-flow"}],"title":"2.1. \nReordering and Accessibility"}],"url":"https://drafts.csswg.org/css-display-4/#propdef-reading-flow"},
"ef47d3e4": {"dfnID":"ef47d3e4","dfnText":"grid-placement property","external":true,"refSections":[{"refs":[{"id":"ref-for-grid-placement-property"}],"title":"4. \nMasonry Placement"}],"url":"https://drafts.csswg.org/css-grid-2/#grid-placement-property"},
"f005b2f6": {"dfnID":"f005b2f6","dfnText":"grid container","external":true,"refSections":[{"refs":[{"id":"ref-for-grid-container"},{"id":"ref-for-grid-container\u2460"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-grid-container\u2461"}],"title":"2.2. \nEstablishing Masonry Layout"},{"refs":[{"id":"ref-for-grid-container\u2462"}],"title":"3. \nMasonry Track Specification"},{"refs":[{"id":"ref-for-grid-container\u2463"}],"title":"3.1. \nDeclaring Masonry Track Templates: the grid-template-* properties"},{"refs":[{"id":"ref-for-grid-container\u2464"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-grid-container\u2465"}],"title":"3.3.1. \nrepeat(auto-areas)"},{"refs":[{"id":"ref-for-grid-container\u2466"}],"title":"3.3.2. \nrepeat(auto-fit)"},{"refs":[{"id":"ref-for-grid-container\u2467"}],"title":"3.4.1. \nSubgrid Item Contributions"},{"refs":[{"id":"ref-for-grid-container\u2468"}],"title":"4.3.1. \nContaining Block"},{"refs":[{"id":"ref-for-grid-container\u2460\u24ea"},{"id":"ref-for-grid-container\u2460\u2460"},{"id":"ref-for-grid-container\u2460\u2461"}],"title":"5. \nSizing Grid Containers"},{"refs":[{"id":"ref-for-grid-container\u2460\u2462"},{"id":"ref-for-grid-container\u2460\u2463"},{"id":"ref-for-grid-container\u2460\u2464"}],"title":"6. \nAlignment and Spacing"},{"refs":[{"id":"ref-for-grid-container\u2460\u2465"},{"id":"ref-for-grid-container\u2460\u2466"},{"id":"ref-for-grid-container\u2460\u2467"},{"id":"ref-for-grid-container\u2460\u2468"}],"title":"6.1. \nBaseline Alignment in the stacking axis"},{"refs":[{"id":"ref-for-grid-container\u2461\u24ea"}],"title":"7.1. \nFragmentation in the stacking axis"},{"refs":[{"id":"ref-for-grid-container\u2461\u2460"}],"title":"7.2. \nFragmentation in the Grid Axis"},{"refs":[{"id":"ref-for-grid-container\u2461\u2461"}],"title":"8. \nAbsolute Positioning"},{"refs":[{"id":"ref-for-grid-container\u2461\u2462"},{"id":"ref-for-grid-container\u2461\u2463"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-grid-container\u2461\u2464"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-grid-container\u2461\u2465"}],"title":"\nItem Placement Packing Mode: the item-pack property"}],"url":"https://drafts.csswg.org/css-grid-2/#grid-container"},
"f6ac6c55": {"dfnID":"f6ac6c55","dfnText":"explicit grid","external":true,"refSections":[{"refs":[{"id":"ref-for-explicit-grid"}],"title":"3. \nMasonry Track Specification"}],"url":"https://drafts.csswg.org/css-grid-2/#explicit-grid"},
"f776fb8b": {"dfnID":"f776fb8b","dfnText":"repeat()","external":true,"refSections":[{"refs":[{"id":"ref-for-funcdef-repeat-line-color-repeat"},{"id":"ref-for-funcdef-repeat-line-color-repeat\u2460"},{"id":"ref-for-funcdef-repeat-line-color-repeat\u2461"},{"id":"ref-for-funcdef-repeat-line-color-repeat\u2462"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"},{"refs":[{"id":"ref-for-funcdef-repeat-line-color-repeat\u2463"},{"id":"ref-for-funcdef-repeat-line-color-repeat\u2464"}],"title":"3.3. \nTrack Repetition: the repeat() notation"},{"refs":[{"id":"ref-for-funcdef-repeat-line-color-repeat\u2465"}],"title":"3.3.1. \nrepeat(auto-areas)"}],"url":"https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat"},
"f83b5bfc": {"dfnID":"f83b5bfc","dfnText":"auto","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-grid-template-columns-auto"},{"id":"ref-for-valdef-grid-template-columns-auto\u2460"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"}],"url":"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-auto"},
"f9a0b0f1": {"dfnID":"f9a0b0f1","dfnText":"text-wrap-style","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-text-wrap-style"}],"title":"\nItem Placement Packing Mode: the item-pack property"}],"url":"https://drafts.csswg.org/css-text-4/#propdef-text-wrap-style"},
"f9ab2883": {"dfnID":"f9ab2883","dfnText":"definite position","external":true,"refSections":[{"refs":[{"id":"ref-for-definite-grid-position"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-definite-grid-position\u2460"}],"title":"3.4.1. \nSubgrid Item Contributions"},{"refs":[{"id":"ref-for-definite-grid-position\u2461"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"https://drafts.csswg.org/css-grid-2/#definite-grid-position"},
"fdb725d6": {"dfnID":"fdb725d6","dfnText":"implicit grid","external":true,"refSections":[{"refs":[{"id":"ref-for-implicit-grid"}],"title":"3. \nMasonry Track Specification"},{"refs":[{"id":"ref-for-implicit-grid\u2460"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"https://drafts.csswg.org/css-grid-2/#implicit-grid"},
"grid-axis": {"dfnID":"grid-axis","dfnText":"grid axis","external":false,"refSections":[{"refs":[{"id":"ref-for-grid-axis"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-grid-axis\u2460"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-grid-axis\u2461"},{"id":"ref-for-grid-axis\u2462"}],"title":"3. \nMasonry Track Specification"},{"refs":[{"id":"ref-for-grid-axis\u2463"}],"title":"3.1. \nDeclaring Masonry Track Templates: the grid-template-* properties"},{"refs":[{"id":"ref-for-grid-axis\u2464"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-grid-axis\u2465"},{"id":"ref-for-grid-axis\u2466"},{"id":"ref-for-grid-axis\u2467"}],"title":"3.4. \nGrid Axis Track Sizing"},{"refs":[{"id":"ref-for-grid-axis\u2468"}],"title":"3.4.2. \nOptimized Track Sizing"},{"refs":[{"id":"ref-for-grid-axis\u2460\u24ea"}],"title":"4. \nMasonry Placement"},{"refs":[{"id":"ref-for-grid-axis\u2460\u2460"}],"title":"4.1. \nSpecifying Masonry Item Placement: the grid-column-* and grid-row-* properties"},{"refs":[{"id":"ref-for-grid-axis\u2460\u2461"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-grid-axis\u2460\u2462"},{"id":"ref-for-grid-axis\u2460\u2463"},{"id":"ref-for-grid-axis\u2460\u2464"},{"id":"ref-for-grid-axis\u2460\u2465"},{"id":"ref-for-grid-axis\u2460\u2466"},{"id":"ref-for-grid-axis\u2460\u2467"},{"id":"ref-for-grid-axis\u2460\u2468"},{"id":"ref-for-grid-axis\u2461\u24ea"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"},{"refs":[{"id":"ref-for-grid-axis\u2461\u2460"}],"title":"4.3.1. \nContaining Block"},{"refs":[{"id":"ref-for-grid-axis\u2461\u2461"},{"id":"ref-for-grid-axis\u2461\u2462"}],"title":"4.3.2. \nPlacement and Writing Modes"},{"refs":[{"id":"ref-for-grid-axis\u2461\u2463"}],"title":"6. \nAlignment and Spacing"},{"refs":[{"id":"ref-for-grid-axis\u2461\u2464"}],"title":"6.1. \nBaseline Alignment in the stacking axis"},{"refs":[{"id":"ref-for-grid-axis\u2461\u2465"},{"id":"ref-for-grid-axis\u2461\u2466"},{"id":"ref-for-grid-axis\u2461\u2467"}],"title":"7.1. \nFragmentation in the stacking axis"},{"refs":[{"id":"ref-for-grid-axis\u2461\u2468"},{"id":"ref-for-grid-axis\u2462\u24ea"},{"id":"ref-for-grid-axis\u2462\u2460"}],"title":"7.2. \nFragmentation in the Grid Axis"},{"refs":[{"id":"ref-for-grid-axis\u2462\u2461"}],"title":"8. \nAbsolute Positioning"}],"url":"#grid-axis"},
"item-groups": {"dfnID":"item-groups","dfnText":"item groups","external":false,"refSections":[{"refs":[{"id":"ref-for-item-groups"}],"title":"3.4.2. \nOptimized Track Sizing"}],"url":"#item-groups"},
"masonry-box": {"dfnID":"masonry-box","dfnText":"masonry box","external":false,"refSections":[{"refs":[{"id":"ref-for-masonry-box"}],"title":"5. \nSizing Grid Containers"},{"refs":[{"id":"ref-for-masonry-box\u2460"},{"id":"ref-for-masonry-box\u2461"}],"title":"6. \nAlignment and Spacing"},{"refs":[{"id":"ref-for-masonry-box\u2462"},{"id":"ref-for-masonry-box\u2463"}],"title":"8. \nAbsolute Positioning"}],"url":"#masonry-box"},
"masonry-container": {"dfnID":"masonry-container","dfnText":"masonry container","external":false,"refSections":[{"refs":[{"id":"ref-for-masonry-container"}],"title":"1.1.1. \nWaterfall Layout with Auto-placed Items"},{"refs":[{"id":"ref-for-masonry-container\u2460"}],"title":"1.1.2. \nOne-dimensional Grid Layout"},{"refs":[{"id":"ref-for-masonry-container\u2461"},{"id":"ref-for-masonry-container\u2462"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-masonry-container\u2463"}],"title":"3. \nMasonry Track Specification"},{"refs":[{"id":"ref-for-masonry-container\u2464"}],"title":"3.1. \nDeclaring Masonry Track Templates: the grid-template-* properties"},{"refs":[{"id":"ref-for-masonry-container\u2465"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"},{"refs":[{"id":"ref-for-masonry-container\u2466"},{"id":"ref-for-masonry-container\u2467"},{"id":"ref-for-masonry-container\u2468"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-masonry-container\u2460\u24ea"}],"title":"3.3.1. \nrepeat(auto-areas)"},{"refs":[{"id":"ref-for-masonry-container\u2460\u2460"},{"id":"ref-for-masonry-container\u2460\u2461"}],"title":"3.3.2. \nrepeat(auto-fit)"},{"refs":[{"id":"ref-for-masonry-container\u2460\u2462"}],"title":"3.4.1. \nSubgrid Item Contributions"},{"refs":[{"id":"ref-for-masonry-container\u2460\u2463"}],"title":"3.4.2. \nOptimized Track Sizing"},{"refs":[{"id":"ref-for-masonry-container\u2460\u2464"},{"id":"ref-for-masonry-container\u2460\u2465"},{"id":"ref-for-masonry-container\u2460\u2466"},{"id":"ref-for-masonry-container\u2460\u2467"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-masonry-container\u2460\u2468"}],"title":"8. \nAbsolute Positioning"},{"refs":[{"id":"ref-for-masonry-container\u2461\u24ea"},{"id":"ref-for-masonry-container\u2461\u2460"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-masonry-container\u2461\u2461"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-masonry-container\u2461\u2462"}],"title":"\nItem Placement Packing Mode: the item-pack property"}],"url":"#masonry-container"},
"masonry-item": {"dfnID":"masonry-item","dfnText":"masonry items","external":false,"refSections":[{"refs":[{"id":"ref-for-masonry-item"},{"id":"ref-for-masonry-item\u2460"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"},{"refs":[{"id":"ref-for-masonry-item\u2461"}],"title":"3.4.2. \nOptimized Track Sizing"},{"refs":[{"id":"ref-for-masonry-item\u2462"}],"title":"4.2. \nPlacement Precision: the item-slack property"}],"url":"#masonry-item"},
"masonry-layout": {"dfnID":"masonry-layout","dfnText":"Masonry layout","external":false,"refSections":[{"refs":[{"id":"ref-for-masonry-layout"},{"id":"ref-for-masonry-layout\u2460"}],"title":"1.1.1. \nWaterfall Layout with Auto-placed Items"},{"refs":[{"id":"ref-for-masonry-layout\u2461"},{"id":"ref-for-masonry-layout\u2462"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-masonry-layout\u2463"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-masonry-layout\u2464"}],"title":"2.2. \nEstablishing Masonry Layout"},{"refs":[{"id":"ref-for-masonry-layout\u2465"},{"id":"ref-for-masonry-layout\u2466"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-masonry-layout\u2467"}],"title":"4.3.1. \nContaining Block"},{"refs":[{"id":"ref-for-masonry-layout\u2468"}],"title":"7.1. \nFragmentation in the stacking axis"},{"refs":[{"id":"ref-for-masonry-layout\u2460\u24ea"},{"id":"ref-for-masonry-layout\u2460\u2460"},{"id":"ref-for-masonry-layout\u2460\u2461"}],"title":"7.2. \nFragmentation in the Grid Axis"},{"refs":[{"id":"ref-for-masonry-layout\u2460\u2462"},{"id":"ref-for-masonry-layout\u2460\u2463"},{"id":"ref-for-masonry-layout\u2460\u2464"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-masonry-layout\u2460\u2465"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-masonry-layout\u2460\u2466"}],"title":"\nItem Placement Packing Mode: the item-pack property"},{"refs":[{"id":"ref-for-masonry-layout\u2460\u2467"}],"title":"\nAdditions Since Level 2"}],"url":"#masonry-layout"},
"masonry-tie-threshold": {"dfnID":"masonry-tie-threshold","dfnText":"tie threshold","external":false,"refSections":[{"refs":[{"id":"ref-for-masonry-tie-threshold"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-masonry-tie-threshold\u2460"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"}],"url":"#masonry-tie-threshold"},
"masonry-track": {"dfnID":"masonry-track","dfnText":"masonry tracks","external":false,"refSections":[{"refs":[{"id":"ref-for-masonry-track"}],"title":"4.2. \nPlacement Precision: the item-slack property"}],"url":"#masonry-track"},
"primary-axis": {"dfnID":"primary-axis","dfnText":"primary axis","external":false,"refSections":[{"refs":[{"id":"ref-for-primary-axis"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"#primary-axis"},
"primary-placement-axis": {"dfnID":"primary-placement-axis","dfnText":"primary placement axis","external":false,"refSections":[{"refs":[{"id":"ref-for-primary-placement-axis"},{"id":"ref-for-primary-placement-axis\u2460"},{"id":"ref-for-primary-placement-axis\u2461"},{"id":"ref-for-primary-placement-axis\u2462"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"#primary-placement-axis"},
"primary-track-axis": {"dfnID":"primary-track-axis","dfnText":"primary track axis","external":false,"refSections":[{"refs":[{"id":"ref-for-primary-track-axis"},{"id":"ref-for-primary-track-axis\u2460"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"#primary-track-axis"},
"propdef-item-cross": {"dfnID":"propdef-item-cross","dfnText":"item-cross","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-item-cross"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"},{"refs":[{"id":"ref-for-propdef-item-cross\u2460"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"#propdef-item-cross"},
"propdef-item-direction": {"dfnID":"propdef-item-direction","dfnText":"item-direction","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-item-direction"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"},{"refs":[{"id":"ref-for-propdef-item-direction\u2460"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-propdef-item-direction\u2461"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-propdef-item-direction\u2462"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"}],"url":"#propdef-item-direction"},
"propdef-item-flow": {"dfnID":"propdef-item-flow","dfnText":"item-flow","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-item-flow"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"},{"refs":[{"id":"ref-for-propdef-item-flow\u2460"}],"title":"\nAdditions Since Level 2"},{"refs":[{"id":"ref-for-propdef-item-flow\u2461"}],"title":"\nRecent Changes"}],"url":"#propdef-item-flow"},
"propdef-item-pack": {"dfnID":"propdef-item-pack","dfnText":"item-pack","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-item-pack"},{"id":"ref-for-propdef-item-pack\u2460"}],"title":"2.2. \nEstablishing Masonry Layout"},{"refs":[{"id":"ref-for-propdef-item-pack\u2461"},{"id":"ref-for-propdef-item-pack\u2462"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"},{"refs":[{"id":"ref-for-propdef-item-pack\u2463"},{"id":"ref-for-propdef-item-pack\u2464"}],"title":"\nItem Placement Packing Mode: the item-pack property"},{"refs":[{"id":"ref-for-propdef-item-pack\u2465"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"}],"url":"#propdef-item-pack"},
"propdef-item-slack": {"dfnID":"propdef-item-slack","dfnText":"item-slack","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-item-slack"},{"id":"ref-for-propdef-item-slack\u2460"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-propdef-item-slack\u2461"},{"id":"ref-for-propdef-item-slack\u2462"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-propdef-item-slack\u2463"},{"id":"ref-for-propdef-item-slack\u2464"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"},{"refs":[{"id":"ref-for-propdef-item-slack\u2465"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"},{"refs":[{"id":"ref-for-propdef-item-slack\u2466"}],"title":"\nRecent Changes"}],"url":"#propdef-item-slack"},
"propdef-item-track": {"dfnID":"propdef-item-track","dfnText":"item-track","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-item-track"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"},{"refs":[{"id":"ref-for-propdef-item-track\u2460"}],"title":"\nItem Flow Axis: item-track/item-direction"},{"refs":[{"id":"ref-for-propdef-item-track\u2461"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"#propdef-item-track"},
"propdef-item-wrap": {"dfnID":"propdef-item-wrap","dfnText":"item-wrap","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-item-wrap"}],"title":"\nAppendix A: Generic Layout Item Flow Controls: the item-* properties"},{"refs":[{"id":"ref-for-propdef-item-wrap\u2460"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"},{"refs":[{"id":"ref-for-propdef-item-wrap\u2461"}],"title":"\nItem Placement Shorthand: the item-flow shorthand"}],"url":"#propdef-item-wrap"},
"row-masonry-container": {"dfnID":"row-masonry-container","dfnText":"row masonry container","external":false,"refSections":[],"url":"#row-masonry-container"},
"running-position": {"dfnID":"running-position","dfnText":"running position","external":false,"refSections":[{"refs":[{"id":"ref-for-running-position"},{"id":"ref-for-running-position\u2460"},{"id":"ref-for-running-position\u2461"}],"title":"4.3. \nMasonry Layout and Placement Algorithm"},{"refs":[{"id":"ref-for-running-position\u2462"}],"title":"7.1. \nFragmentation in the stacking axis"},{"refs":[{"id":"ref-for-running-position\u2463"}],"title":"8. \nAbsolute Positioning"}],"url":"#running-position"},
"stacking-axis": {"dfnID":"stacking-axis","dfnText":"stacking axis","external":false,"refSections":[{"refs":[{"id":"ref-for-stacking-axis"},{"id":"ref-for-stacking-axis\u2460"}],"title":"2. \nMasonry Layout Model"},{"refs":[{"id":"ref-for-stacking-axis\u2461"}],"title":"2.1. \nReordering and Accessibility"},{"refs":[{"id":"ref-for-stacking-axis\u2462"}],"title":"2.2. \nEstablishing Masonry Layout"},{"refs":[{"id":"ref-for-stacking-axis\u2463"}],"title":"3.1. \nDeclaring Masonry Track Templates: the grid-template-* properties"},{"refs":[{"id":"ref-for-stacking-axis\u2464"},{"id":"ref-for-stacking-axis\u2465"}],"title":"3.2. \nSubgrids"},{"refs":[{"id":"ref-for-stacking-axis\u2466"}],"title":"4.2. \nPlacement Precision: the item-slack property"},{"refs":[{"id":"ref-for-stacking-axis\u2467"}],"title":"4.3.1. \nContaining Block"},{"refs":[{"id":"ref-for-stacking-axis\u2468"},{"id":"ref-for-stacking-axis\u2460\u24ea"}],"title":"4.3.2. \nPlacement and Writing Modes"},{"refs":[{"id":"ref-for-stacking-axis\u2460\u2460"},{"id":"ref-for-stacking-axis\u2460\u2461"}],"title":"5. \nSizing Grid Containers"},{"refs":[{"id":"ref-for-stacking-axis\u2460\u2462"},{"id":"ref-for-stacking-axis\u2460\u2463"},{"id":"ref-for-stacking-axis\u2460\u2464"},{"id":"ref-for-stacking-axis\u2460\u2465"}],"title":"6. \nAlignment and Spacing"},{"refs":[{"id":"ref-for-stacking-axis\u2460\u2466"}],"title":"6.1. \nBaseline Alignment in the stacking axis"},{"refs":[{"id":"ref-for-stacking-axis\u2460\u2467"}],"title":"7.1. \nFragmentation in the stacking axis"},{"refs":[{"id":"ref-for-stacking-axis\u2460\u2468"},{"id":"ref-for-stacking-axis\u2461\u24ea"}],"title":"8. \nAbsolute Positioning"}],"url":"#stacking-axis"},
"submasonry": {"dfnID":"submasonry","dfnText":"submasonry","external":false,"refSections":[{"refs":[{"id":"ref-for-submasonry"},{"id":"ref-for-submasonry\u2460"}],"title":"3.4.1. \nSubgrid Item Contributions"}],"url":"#submasonry"},
"valdef-item-direction-auto": {"dfnID":"valdef-item-direction-auto","dfnText":"auto","external":false,"refSections":[],"url":"#valdef-item-direction-auto"},
"valdef-item-direction-column": {"dfnID":"valdef-item-direction-column","dfnText":"column","external":false,"refSections":[{"refs":[{"id":"ref-for-valdef-item-direction-column"},{"id":"ref-for-valdef-item-direction-column\u2460"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"#valdef-item-direction-column"},
"valdef-item-direction-column-reverse": {"dfnID":"valdef-item-direction-column-reverse","dfnText":"column-reverse","external":false,"refSections":[],"url":"#valdef-item-direction-column-reverse"},
"valdef-item-direction-row": {"dfnID":"valdef-item-direction-row","dfnText":"row","external":false,"refSections":[{"refs":[{"id":"ref-for-valdef-item-direction-row"},{"id":"ref-for-valdef-item-direction-row\u2460"},{"id":"ref-for-valdef-item-direction-row\u2461"}],"title":"\nItem Flow Axis: item-track/item-direction"}],"url":"#valdef-item-direction-row"},
"valdef-item-direction-row-reverse": {"dfnID":"valdef-item-direction-row-reverse","dfnText":"row-reverse","external":false,"refSections":[],"url":"#valdef-item-direction-row-reverse"},
"valdef-item-pack-balance": {"dfnID":"valdef-item-pack-balance","dfnText":"balance","external":false,"refSections":[],"url":"#valdef-item-pack-balance"},
"valdef-item-pack-collapse": {"dfnID":"valdef-item-pack-collapse","dfnText":"collapse","external":false,"refSections":[],"url":"#valdef-item-pack-collapse"},
"valdef-item-pack-dense": {"dfnID":"valdef-item-pack-dense","dfnText":"dense","external":false,"refSections":[],"url":"#valdef-item-pack-dense"},
"valdef-item-pack-normal": {"dfnID":"valdef-item-pack-normal","dfnText":"normal","external":false,"refSections":[],"url":"#valdef-item-pack-normal"},
"valdef-item-slack-infinite": {"dfnID":"valdef-item-slack-infinite","dfnText":"infinite","external":false,"refSections":[],"url":"#valdef-item-slack-infinite"},
"valdef-item-slack-length-percentage": {"dfnID":"valdef-item-slack-length-percentage","dfnText":"<length-percentage>","external":false,"refSections":[],"url":"#valdef-item-slack-length-percentage"},
"valdef-item-wrap-auto": {"dfnID":"valdef-item-wrap-auto","dfnText":"auto","external":false,"refSections":[],"url":"#valdef-item-wrap-auto"},
"valdef-item-wrap-normal": {"dfnID":"valdef-item-wrap-normal","dfnText":"normal","external":false,"refSections":[],"url":"#valdef-item-wrap-normal"},
"valdef-item-wrap-nowrap": {"dfnID":"valdef-item-wrap-nowrap","dfnText":"nowrap","external":false,"refSections":[{"refs":[{"id":"ref-for-valdef-item-wrap-nowrap"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"#valdef-item-wrap-nowrap"},
"valdef-item-wrap-reverse": {"dfnID":"valdef-item-wrap-reverse","dfnText":"reverse","external":false,"refSections":[],"url":"#valdef-item-wrap-reverse"},
"valdef-item-wrap-wrap": {"dfnID":"valdef-item-wrap-wrap","dfnText":"wrap","external":false,"refSections":[{"refs":[{"id":"ref-for-valdef-item-wrap-wrap"}],"title":"\nItem Cross Axis Placement Mode: item-cross/item-wrap"}],"url":"#valdef-item-wrap-wrap"},
"valdef-item-wrap-wrap-reverse": {"dfnID":"valdef-item-wrap-wrap-reverse","dfnText":"wrap-reverse","external":false,"refSections":[],"url":"#valdef-item-wrap-wrap-reverse"},
"valdef-repeat-auto-areas": {"dfnID":"valdef-repeat-auto-areas","dfnText":"auto-areas","external":false,"refSections":[{"refs":[{"id":"ref-for-valdef-repeat-auto-areas"}],"title":"3.3.1. \nrepeat(auto-areas)"}],"url":"#valdef-repeat-auto-areas"},
"virtual-masonry-item": {"dfnID":"virtual-masonry-item","dfnText":"virtual masonry item","external":false,"refSections":[{"refs":[{"id":"ref-for-virtual-masonry-item"}],"title":"3.1.1. \nIntrinsic Tracks and repeat()"},{"refs":[{"id":"ref-for-virtual-masonry-item\u2460"},{"id":"ref-for-virtual-masonry-item\u2461"}],"title":"3.4.2. \nOptimized Track Sizing"}],"url":"#virtual-masonry-item"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-position-annos */
"use strict";
{
function repositionAnnoPanels(){
    const panels = [...document.querySelectorAll("[data-anno-for]")];
    hydratePanels(panels);
    let vSoFar = 0;
    for(const panel of panels.sort(cmpTops)) {
        if(panel.top < vSoFar) {
            panel.top = vSoFar;
            panel.style.top = vSoFar + "px";
        }
        vSoFar = panel.top + panel.height + 15;
    }
}
function hydratePanels(panels) {
    const main = document.querySelector("main");
    let mainRect;
    if(main) mainRect = main.getBoundingClientRect();
    // First display them all, if they're not already visible.
    for(const panel of panels) {
        panel.classList.remove("unpositioned");
    }
    // Measure them all
    for(const panel of panels) {
        const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
        if(!dfn) {
            console.log("Can't find the annotation panel target:", panel);
            continue;
        }
        panel.dfn = dfn;
        panel.top = window.scrollY + dfn.getBoundingClientRect().top;
        let panelRect = panel.getBoundingClientRect();
        panel.height = panelRect.height;
        if(main) {
            panel.overlappingMain = panelRect.left < mainRect.right;
        } else {
            panel.overlappingMain = false;
        }
    }
    // And finally position them
    for(const panel of panels) {
        const dfn = panel.dfn;
        if(!dfn) continue;
        panel.style.top = panel.top + "px";
        panel.classList.toggle("overlapping-main", panel.overlappingMain);
    }
}

function cmpTops(a,b) {
    return a.top - b.top;
}

window.addEventListener("load", repositionAnnoPanels);
window.addEventListener("resize", repositionAnnoPanels);
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#auto-placement-cursor": {"displayText":"auto-placement cursor","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"auto-placement cursor","type":"dfn","url":"#auto-placement-cursor"},
"#grid-axis": {"displayText":"grid axis","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"grid axis","type":"dfn","url":"#grid-axis"},
"#item-groups": {"displayText":"item groups","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item groups","type":"dfn","url":"#item-groups"},
"#masonry-box": {"displayText":"masonry box","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"masonry box","type":"dfn","url":"#masonry-box"},
"#masonry-container": {"displayText":"masonry container","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"masonry container","type":"dfn","url":"#masonry-container"},
"#masonry-item": {"displayText":"masonry item","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"masonry item","type":"dfn","url":"#masonry-item"},
"#masonry-layout": {"displayText":"masonry layout","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"masonry layout","type":"dfn","url":"#masonry-layout"},
"#masonry-tie-threshold": {"displayText":"tie threshold","export":true,"for_":["masonry"],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"tie threshold","type":"dfn","url":"#masonry-tie-threshold"},
"#masonry-track": {"displayText":"masonry track","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"masonry track","type":"dfn","url":"#masonry-track"},
"#primary-axis": {"displayText":"primary axis","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"primary axis","type":"dfn","url":"#primary-axis"},
"#primary-placement-axis": {"displayText":"primary placement axis","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"primary placement axis","type":"dfn","url":"#primary-placement-axis"},
"#primary-track-axis": {"displayText":"primary track axis","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"primary track axis","type":"dfn","url":"#primary-track-axis"},
"#propdef-item-cross": {"displayText":"item-cross","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item-cross","type":"property","url":"#propdef-item-cross"},
"#propdef-item-direction": {"displayText":"item-direction","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item-direction","type":"property","url":"#propdef-item-direction"},
"#propdef-item-flow": {"displayText":"item-flow","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item-flow","type":"property","url":"#propdef-item-flow"},
"#propdef-item-pack": {"displayText":"item-pack","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item-pack","type":"property","url":"#propdef-item-pack"},
"#propdef-item-slack": {"displayText":"item-slack","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item-slack","type":"property","url":"#propdef-item-slack"},
"#propdef-item-track": {"displayText":"item-track","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item-track","type":"property","url":"#propdef-item-track"},
"#propdef-item-wrap": {"displayText":"item-wrap","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"item-wrap","type":"property","url":"#propdef-item-wrap"},
"#running-position": {"displayText":"running position","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"running position","type":"dfn","url":"#running-position"},
"#stacking-axis": {"displayText":"stacking axis","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"stacking axis","type":"dfn","url":"#stacking-axis"},
"#submasonry": {"displayText":"submasonry","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"submasonry","type":"dfn","url":"#submasonry"},
"#valdef-item-direction-column": {"displayText":"column","export":true,"for_":["item-direction","item-track"],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"column","type":"value","url":"#valdef-item-direction-column"},
"#valdef-item-direction-row": {"displayText":"row","export":true,"for_":["item-direction","item-track"],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"row","type":"value","url":"#valdef-item-direction-row"},
"#valdef-item-wrap-nowrap": {"displayText":"nowrap","export":true,"for_":["item-cross","item-wrap"],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"nowrap","type":"value","url":"#valdef-item-wrap-nowrap"},
"#valdef-item-wrap-wrap": {"displayText":"wrap","export":true,"for_":["item-cross","item-wrap"],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"wrap","type":"value","url":"#valdef-item-wrap-wrap"},
"#valdef-repeat-auto-areas": {"displayText":"auto-areas","export":true,"for_":["repeat()"],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"auto-areas","type":"value","url":"#valdef-repeat-auto-areas"},
"#virtual-masonry-item": {"displayText":"virtual masonry item","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-grid","spec":"css-grid-3","status":"local","text":"virtual masonry item","type":"dfn","url":"#virtual-masonry-item"},
"https://drafts.csswg.org/css-align-3/#alignment-baseline": {"displayText":"alignment baseline","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"alignment baseline","type":"dfn","url":"https://drafts.csswg.org/css-align-3/#alignment-baseline"},
"https://drafts.csswg.org/css-align-3/#alignment-subject": {"displayText":"alignment subject","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"alignment subject","type":"dfn","url":"https://drafts.csswg.org/css-align-3/#alignment-subject"},
"https://drafts.csswg.org/css-align-3/#baseline-alignment": {"displayText":"baseline alignment","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"baseline alignment","type":"dfn","url":"https://drafts.csswg.org/css-align-3/#baseline-alignment"},
"https://drafts.csswg.org/css-align-3/#baseline-sharing-group": {"displayText":"baseline-sharing group","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"baseline-sharing group","type":"dfn","url":"https://drafts.csswg.org/css-align-3/#baseline-sharing-group"},
"https://drafts.csswg.org/css-align-3/#distributed-alignment": {"displayText":"distributed alignment","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"distributed alignment","type":"dfn","url":"https://drafts.csswg.org/css-align-3/#distributed-alignment"},
"https://drafts.csswg.org/css-align-3/#fallback-alignment": {"displayText":"fallback alignment","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"fallback alignment","type":"dfn","url":"https://drafts.csswg.org/css-align-3/#fallback-alignment"},
"https://drafts.csswg.org/css-align-3/#propdef-align-content": {"displayText":"align-content","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"align-content","type":"property","url":"https://drafts.csswg.org/css-align-3/#propdef-align-content"},
"https://drafts.csswg.org/css-align-3/#propdef-grid-gap": {"displayText":"grid-gap","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"grid-gap","type":"property","url":"https://drafts.csswg.org/css-align-3/#propdef-grid-gap"},
"https://drafts.csswg.org/css-align-3/#propdef-justify-content": {"displayText":"justify-content","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"justify-content","type":"property","url":"https://drafts.csswg.org/css-align-3/#propdef-justify-content"},
"https://drafts.csswg.org/css-align-3/#valdef-align-content-stretch": {"displayText":"stretch","export":true,"for_":["align-content","justify-content","<content-distribution>"],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"stretch","type":"value","url":"https://drafts.csswg.org/css-align-3/#valdef-align-content-stretch"},
"https://drafts.csswg.org/css-align-3/#valdef-justify-content-normal": {"displayText":"normal","export":true,"for_":["justify-content","align-content"],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"normal","type":"value","url":"https://drafts.csswg.org/css-align-3/#valdef-justify-content-normal"},
"https://drafts.csswg.org/css-align-3/#valdef-self-position-center": {"displayText":"center","export":true,"for_":["<self-position>","<content-position>","justify-self","align-self","justify-content","align-content"],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"center","type":"value","url":"https://drafts.csswg.org/css-align-3/#valdef-self-position-center"},
"https://drafts.csswg.org/css-align-3/#valdef-self-position-end": {"displayText":"end","export":true,"for_":["<self-position>","<content-position>","justify-self","align-self","justify-content","align-content"],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"end","type":"value","url":"https://drafts.csswg.org/css-align-3/#valdef-self-position-end"},
"https://drafts.csswg.org/css-align-3/#valdef-self-position-start": {"displayText":"start","export":true,"for_":["<self-position>","<content-position>","justify-self","align-self","justify-content","align-content"],"level":"3","normative":true,"shortname":"css-align","spec":"css-align-3","status":"current","text":"start","type":"value","url":"https://drafts.csswg.org/css-align-3/#valdef-self-position-start"},
"https://drafts.csswg.org/css-box-4/#content-box": {"displayText":"content box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-box","spec":"css-box-4","status":"current","text":"content box","type":"dfn","url":"https://drafts.csswg.org/css-box-4/#content-box"},
"https://drafts.csswg.org/css-box-4/#margin-box": {"displayText":"margin box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-box","spec":"css-box-4","status":"current","text":"margin box","type":"dfn","url":"https://drafts.csswg.org/css-box-4/#margin-box"},
"https://drafts.csswg.org/css-break-4/#forced-break": {"displayText":"forced break","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-break","spec":"css-break-4","status":"current","text":"forced break","type":"dfn","url":"https://drafts.csswg.org/css-break-4/#forced-break"},
"https://drafts.csswg.org/css-break-4/#fragmentainer": {"displayText":"fragmentainer","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-break","spec":"css-break-4","status":"current","text":"fragmentainer","type":"dfn","url":"https://drafts.csswg.org/css-break-4/#fragmentainer"},
"https://drafts.csswg.org/css-cascade-5/#longhand": {"displayText":"longhand property","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"longhand property","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#longhand"},
"https://drafts.csswg.org/css-cascade-5/#shorthand-property": {"displayText":"shorthand property","export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"shorthand property","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#shorthand-property"},
"https://drafts.csswg.org/css-display-4/#blockify": {"displayText":"blockify","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"blockify","type":"dfn","url":"https://drafts.csswg.org/css-display-4/#blockify"},
"https://drafts.csswg.org/css-display-4/#containing-block": {"displayText":"containing block","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"containing block","type":"dfn","url":"https://drafts.csswg.org/css-display-4/#containing-block"},
"https://drafts.csswg.org/css-display-4/#propdef-display": {"displayText":"display","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"display","type":"property","url":"https://drafts.csswg.org/css-display-4/#propdef-display"},
"https://drafts.csswg.org/css-display-4/#propdef-reading-flow": {"displayText":"reading-flow","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"reading-flow","type":"property","url":"https://drafts.csswg.org/css-display-4/#propdef-reading-flow"},
"https://drafts.csswg.org/css-flexbox-1/#flex-container": {"displayText":"flex container","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"current","text":"flex container","type":"dfn","url":"https://drafts.csswg.org/css-flexbox-1/#flex-container"},
"https://drafts.csswg.org/css-flexbox-1/#flex-layout": {"displayText":"flex layout","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"current","text":"flex layout","type":"dfn","url":"https://drafts.csswg.org/css-flexbox-1/#flex-layout"},
"https://drafts.csswg.org/css-flexbox-1/#multi-line-flex-container": {"displayText":"multi-line flex container","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"current","text":"multi-line flex container","type":"dfn","url":"https://drafts.csswg.org/css-flexbox-1/#multi-line-flex-container"},
"https://drafts.csswg.org/css-flexbox-1/#propdef-flex-flow": {"displayText":"flex-flow","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"current","text":"flex-flow","type":"property","url":"https://drafts.csswg.org/css-flexbox-1/#propdef-flex-flow"},
"https://drafts.csswg.org/css-flexbox-1/#propdef-flex-wrap": {"displayText":"flex-wrap","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"current","text":"flex-wrap","type":"property","url":"https://drafts.csswg.org/css-flexbox-1/#propdef-flex-wrap"},
"https://drafts.csswg.org/css-flexbox-1/#single-line-flex-container": {"displayText":"single-line flex container","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"current","text":"single-line flex container","type":"dfn","url":"https://drafts.csswg.org/css-flexbox-1/#single-line-flex-container"},
"https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat": {"displayText":"repeat()","export":true,"for_":["<repeat-line-color>","<auto-repeat-line-color>","<repeat-line-style>","<auto-repeat-line-style>","<repeat-line-width>","<auto-repeat-line-width>"],"level":"1","normative":true,"shortname":"css-gaps","spec":"css-gaps-1","status":"current","text":"repeat()","type":"function","url":"https://drafts.csswg.org/css-gaps-1/#funcdef-repeat-line-color-repeat"},
"https://drafts.csswg.org/css-grid-2/#automatic-grid-position": {"displayText":"automatic grid position","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"automatic grid position","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#automatic-grid-position"},
"https://drafts.csswg.org/css-grid-2/#definite-grid-position": {"displayText":"definite position","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"definite position","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#definite-grid-position"},
"https://drafts.csswg.org/css-grid-2/#explicit-grid": {"displayText":"explicit grid","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"explicit grid","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#explicit-grid"},
"https://drafts.csswg.org/css-grid-2/#grid-area": {"displayText":"grid area","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid area","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#grid-area"},
"https://drafts.csswg.org/css-grid-2/#grid-container": {"displayText":"grid container","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid container","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#grid-container"},
"https://drafts.csswg.org/css-grid-2/#grid-item": {"displayText":"grid item","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid item","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#grid-item"},
"https://drafts.csswg.org/css-grid-2/#grid-layout": {"displayText":"grid layout","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid layout","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#grid-layout"},
"https://drafts.csswg.org/css-grid-2/#grid-placement-property": {"displayText":"grid-placement property","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid-placement property","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#grid-placement-property"},
"https://drafts.csswg.org/css-grid-2/#grid-track": {"displayText":"grid track","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid track","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#grid-track"},
"https://drafts.csswg.org/css-grid-2/#implicit-grid": {"displayText":"implicit grid","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"implicit grid","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#implicit-grid"},
"https://drafts.csswg.org/css-grid-2/#implicit-grid-track": {"displayText":"implicit grid track","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"implicit grid track","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#implicit-grid-track"},
"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-columns": {"displayText":"grid-auto-columns","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid-auto-columns","type":"property","url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-columns"},
"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-flow": {"displayText":"grid-auto-flow","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid-auto-flow","type":"property","url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-flow"},
"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-rows": {"displayText":"grid-auto-rows","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid-auto-rows","type":"property","url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-rows"},
"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-areas": {"displayText":"grid-template-areas","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid-template-areas","type":"property","url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-areas"},
"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-columns": {"displayText":"grid-template-columns","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid-template-columns","type":"property","url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-columns"},
"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-rows": {"displayText":"grid-template-rows","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"grid-template-rows","type":"property","url":"https://drafts.csswg.org/css-grid-2/#propdef-grid-template-rows"},
"https://drafts.csswg.org/css-grid-2/#subgrid": {"displayText":"subgrid","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"subgrid","type":"dfn","url":"https://drafts.csswg.org/css-grid-2/#subgrid"},
"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-areas-none": {"displayText":"none","export":true,"for_":["grid-template-areas"],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"none","type":"value","url":"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-areas-none"},
"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-auto": {"displayText":"auto","export":true,"for_":["grid-template-columns","grid-template-rows"],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"auto","type":"value","url":"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-auto"},
"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-rows-none": {"displayText":"none","export":true,"for_":["grid-template-rows","grid-template-columns"],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"none","type":"value","url":"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-rows-none"},
"https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fill": {"displayText":"auto-fill","export":true,"for_":["repeat()"],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"auto-fill","type":"value","url":"https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fill"},
"https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit": {"displayText":"auto-fit","export":true,"for_":["repeat()"],"level":"2","normative":true,"shortname":"css-grid","spec":"css-grid-2","status":"current","text":"auto-fit","type":"value","url":"https://drafts.csswg.org/css-grid-2/#valdef-repeat-auto-fit"},
"https://drafts.csswg.org/css-sizing-3/#available": {"displayText":"available space","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-sizing","spec":"css-sizing-3","status":"current","text":"available space","type":"dfn","url":"https://drafts.csswg.org/css-sizing-3/#available"},
"https://drafts.csswg.org/css-sizing-3/#max-content": {"displayText":"max-content size","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-sizing","spec":"css-sizing-3","status":"current","text":"max-content size","type":"dfn","url":"https://drafts.csswg.org/css-sizing-3/#max-content"},
"https://drafts.csswg.org/css-sizing-3/#max-content-constraint": {"displayText":"max-content constraint","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-sizing","spec":"css-sizing-3","status":"current","text":"max-content constraint","type":"dfn","url":"https://drafts.csswg.org/css-sizing-3/#max-content-constraint"},
"https://drafts.csswg.org/css-sizing-3/#min-content": {"displayText":"min-content size","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-sizing","spec":"css-sizing-3","status":"current","text":"min-content size","type":"dfn","url":"https://drafts.csswg.org/css-sizing-3/#min-content"},
"https://drafts.csswg.org/css-sizing-3/#min-content-constraint": {"displayText":"min-content constraint","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-sizing","spec":"css-sizing-3","status":"current","text":"min-content constraint","type":"dfn","url":"https://drafts.csswg.org/css-sizing-3/#min-content-constraint"},
"https://drafts.csswg.org/css-sizing-3/#outer-size": {"displayText":"outer size","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-sizing","spec":"css-sizing-3","status":"current","text":"outer size","type":"dfn","url":"https://drafts.csswg.org/css-sizing-3/#outer-size"},
"https://drafts.csswg.org/css-text-4/#propdef-text-wrap-style": {"displayText":"text-wrap-style","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-text","spec":"css-text-4","status":"current","text":"text-wrap-style","type":"property","url":"https://drafts.csswg.org/css-text-4/#propdef-text-wrap-style"},
"https://drafts.csswg.org/css-values-4/#comb-any": {"displayText":"||","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"||","type":"grammar","url":"https://drafts.csswg.org/css-values-4/#comb-any"},
"https://drafts.csswg.org/css-values-4/#comb-one": {"displayText":"|","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"|","type":"grammar","url":"https://drafts.csswg.org/css-values-4/#comb-one"},
"https://drafts.csswg.org/css-values-4/#css-wide-keywords": {"displayText":"CSS-wide keywords","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"css-wide keywords","type":"dfn","url":"https://drafts.csswg.org/css-values-4/#css-wide-keywords"},
"https://drafts.csswg.org/css-values-4/#typedef-length-percentage": {"displayText":"<length-percentage>","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"<length-percentage>","type":"type","url":"https://drafts.csswg.org/css-values-4/#typedef-length-percentage"},
"https://drafts.csswg.org/css-writing-modes-3/#propdef-direction": {"displayText":"direction","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-writing-modes","spec":"css-writing-modes-3","status":"current","text":"direction","type":"property","url":"https://drafts.csswg.org/css-writing-modes-3/#propdef-direction"},
"https://drafts.csswg.org/css-writing-modes-4/#block-axis": {"displayText":"block axis","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-writing-modes","spec":"css-writing-modes-4","status":"current","text":"block axis","type":"dfn","url":"https://drafts.csswg.org/css-writing-modes-4/#block-axis"},
"https://drafts.csswg.org/css-writing-modes-4/#inline-axis": {"displayText":"inline axis","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-writing-modes","spec":"css-writing-modes-4","status":"current","text":"inline axis","type":"dfn","url":"https://drafts.csswg.org/css-writing-modes-4/#inline-axis"},
"https://drafts.csswg.org/css-writing-modes-4/#writing-mode": {"displayText":"writing mode","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-writing-modes","spec":"css-writing-modes-4","status":"current","text":"writing mode","type":"dfn","url":"https://drafts.csswg.org/css-writing-modes-4/#writing-mode"},
"https://www.w3.org/TR/css-flexbox-1/#order-modified-document-order": {"displayText":"order-modified document order","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"snapshot","text":"order-modified document order","type":"dfn","url":"https://www.w3.org/TR/css-flexbox-1/#order-modified-document-order"},
"https://www.w3.org/TR/css-flexbox-1/#propdef-order": {"displayText":"order","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-flexbox","spec":"css-flexbox-1","status":"snapshot","text":"order","type":"property","url":"https://www.w3.org/TR/css-flexbox-1/#propdef-order"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const refHintKey = link.getAttribute("data-refhint-key");
    let key = url;
    if(refHintKey) {
        key = refHintKey + "_" + url;
    }
    const ref = refsData[key];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>