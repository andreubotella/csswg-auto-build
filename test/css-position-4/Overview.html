<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>CSS Positioned Layout Module Level 4</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 618007319, updated Thu Jun 26 17:23:55 2025 -0700" name="generator">
  <link href="https://drafts.csswg.org/css-position-4/" rel="canonical">
  <link href="https://drafts.csswg.org/csslogo.ico" rel="icon">
  <meta content="2009f4d01df701a0fadeeb24c5ca468d07890e77" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>
/* Put nice boxes around each algorithm. */
[data-algorithm]:not(.heading) {
	padding: .5em;
	border: thin solid #ddd; border-radius: .5em;
	margin: .5em calc(-0.5em - 1px);
}
[data-algorithm]:not(.heading) > :first-child {
	margin-top: 0;
}
[data-algorithm]:not(.heading) > :last-child {
	margin-bottom: 0;
}
[data-algorithm] [data-algorithm] {
	margin: 1em 0;
}
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-mdn-anno */
:root {
	--mdn-bg: #EEE;
	--mdn-shadow: #999;
	--mdn-nosupport-text: #ccc;
	--mdn-pass: green;
	--mdn-fail: red;
}
@media (prefers-color-scheme: dark) {
	:root {
		--mdn-bg: #222;
		--mdn-shadow: #444;
		--mdn-nosupport-text: #666;
		--mdn-pass: #690;
		--mdn-fail: #d22;
	}
}
.mdn-anno {
	background: var(--mdn-bg, #EEE);
	border-radius: .25em;
	box-shadow: 0 0 3px var(--mdn-shadow, #999);
	color: var(--text, black);
	font: 1em sans-serif;
	hyphens: none;
	max-width: min-content;
	overflow: hidden;
	padding: 0.2em;
	position: absolute;
	right: 0.3em;
	top: auto;
	white-space: nowrap;
	word-wrap: normal;
	z-index: 8;
}
.mdn-anno.unpositioned {
	display: none;
}
.mdn-anno.overlapping-main {
	opacity: .2;
	transition: opacity .1s;
}
.mdn-anno[open] {
	opacity: 1;
	z-index: 9;
	min-width: 9em;
}
.mdn-anno:hover {
	opacity: 1;
	outline: var(--text, black) 1px solid;
}
.mdn-anno > summary {
	font-weight: normal;
	text-align: right;
	cursor: pointer;
	display: block;
}
.mdn-anno > summary > .less-than-two-engines-flag {
	color: var(--mdn-fail);
	padding-right: 2px;
}
.mdn-anno > summary > .all-engines-flag {
	color: var(--mdn-pass);
	padding-right: 2px;
}
.mdn-anno > summary > span {
	color: #fff;
	background-color: #000;
	font-weight: normal;
	font-family: zillaslab, Palatino, "Palatino Linotype", serif;
	padding: 2px 3px 0px 3px;
	line-height: 1.3em;
	vertical-align: top;
}
.mdn-anno > .feature {
	margin-top: 20px;
}
.mdn-anno > .feature:not(:first-of-type) {
	border-top: 1px solid #999;
	margin-top: 6px;
	padding-top: 2px;
}
.mdn-anno > .feature > .less-than-two-engines-text {
	color: var(--mdn-fail);
}
.mdn-anno > .feature > .all-engines-text {
	color: var(--mdn-pass);
}
.mdn-anno > .feature > p {
	font-size: .75em;
	margin-top: 6px;
	margin-bottom: 0;
}
.mdn-anno > .feature > p + p {
	margin-top: 3px;
}
.mdn-anno > .feature > .support {
	display: block;
	font-size: 0.6em;
	margin: 0;
	padding: 0;
	margin-top: 2px;
}
.mdn-anno > .feature > .support + div {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > hr {
	display: block;
	border: none;
	border-top: 1px dotted #999;
	padding: 3px 0px 0px 0px;
	margin: 2px 3px 0px 3px;
}
.mdn-anno > .feature > .support > hr::before {
	content: "";
}
.mdn-anno > .feature > .support > span {
	padding: 0.2em 0;
	display: block;
	display: table;
}
.mdn-anno > .feature > .support > span.no {
	color: var(--mdn-nosupport-text);
	filter: grayscale(100%);
}
.mdn-anno > .feature > .support > span.no::before {
	opacity: 0.5;
}
.mdn-anno > .feature > .support > span:first-of-type {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > span > span {
	padding: 0 0.5em;
	display: table-cell;
}
.mdn-anno > .feature > .support > span > span:first-child {
	width: 100%;
}
.mdn-anno > .feature > .support > span > span:last-child {
	width: 100%;
	white-space: pre;
	padding: 0;
}
.mdn-anno > .feature > .support > span::before {
	content: ' ';
	display: table-cell;
	min-width: 1.5em;
	height: 1.5em;
	background: no-repeat center center;
	background-size: contain;
	text-align: right;
	font-size: 0.75em;
	font-weight: bold;
}
.mdn-anno > .feature > .support > .chrome_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .firefox_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .chrome::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .edge_blink::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
}
.mdn-anno > .feature > .support > .edge::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
}
.mdn-anno > .feature > .support > .firefox::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .ie::before {
	background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
}
.mdn-anno > .feature > .support > .safari_ios::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
}
.mdn-anno > .feature > .support > .nodejs::before {
	background-image: url(https://nodejs.org/favicon.ico);
}
.mdn-anno > .feature > .support > .opera_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .opera::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .safari::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
}
.mdn-anno > .feature > .support > .samsunginternet_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
}
.mdn-anno > .feature > .support > .webview_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
}
.name-slug-mismatch {
	color: red;
}
.caniuse-status:hover {
	z-index: 9;
}
/* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */;
.h-entry:not(.status-LS) dt > .mdn-anno, .h-entry:not(.status-LS) li > .mdn-anno, .h-entry:not(.status-LS) .issue > .mdn-anno, .h-entry:not(.status-LS) .note > .mdn-anno, .h-entry:not(.status-LS) .example > .mdn-anno {
	right: -6.7em;
}
.h-entry p + .mdn-anno {
	margin-top: 0;
}
 h2 + .mdn-anno.after {
	margin: -48px 0 0 0;
}
 h3 + .mdn-anno.after {
	margin: -46px 0 0 0;
}
 h4 + .mdn-anno.after {
	margin: -42px 0 0 0;
}
 h5 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
 h6 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

[data-algorithm] var { cursor: pointer; }
var[data-var-color] { background-color: var(--var-bg); box-shadow: 0 0 0 2px var(--var-bg); }

var[data-var-color] { --var-bg: #F4D200; }
var[data-var-color="1"] { --var-bg: #FF87A2; }
var[data-var-color="2"] { --var-bg: #96E885; }
var[data-var-color="3"] { --var-bg: #3EEED2; }
var[data-var-color="4"] { --var-bg: #EACFB6; }
var[data-var-color="5"] { --var-bg: #82DDFF; }
var[data-var-color="6"] { --var-vg: #FFBCF2; }

@media (prefers-color-scheme: dark) {
	var[data-var-color] { --var-bg: #bc1a00; }
	var[data-var-color="1"] { --var-bg: #007f00; }
	var[data-var-color="2"] { --var-bg: #008698; }
	var[data-var-color="3"] { --var-bg: #7f5b2b; }
	var[data-var-color="4"] { --var-bg: #004df3; }
	var[data-var-color="5"] { --var-bg: #a1248a; }
	var[data-var-color="6"] { --var-vg: #ff0000; }
}
</style>
<style>/* Boilerplate: style-wpt */
:root {
    --wpt-border: hsl(0, 0%, 60%);
    --wpt-bg: hsl(0, 0%, 95%);
    --wpt-text: var(--text);
    --wptheading-text: hsl(0, 0%, 30%);
}
@media (prefers-color-scheme: dark) {
    :root {
        --wpt-border: hsl(0, 0%, 30%);
        --wpt-bg: var(--borderedblock-bg);
        --wpt-text: var(--text);
        --wptheading-text: hsl(0, 0%, 60%);
    }
}
.wpt-tests-block {
    list-style: none;
    border-left: .5em solid var(--wpt-border);
    background: var(--wpt-bg);
    color: var(--wpt-text);
    margin: 1em auto;
    padding: .5em;
}
.wpt-tests-block summary {
    color: var(--wptheading-text);
    font-weight: normal;
    text-transform: uppercase;
}
.wpt-tests-block summary::marker{
    color: var(--wpt-border);
}
.wpt-tests-block summary:hover::marker{
    color: var(--wpt-text);
}
/*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
.wpt-tests-block:not([open]){
    padding: 0;
    border: none;
    background: none;
    font-size: 0.75em;
    line-height: 1;
    position: relative;
    margin: 1em 0 0;
}
.wpt-tests-block:not([open]) summary {
    position: absolute;
    right: 0;
    bottom: 0;
}
/*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
.wpt-tests-block:not([open]):last-child {
    padding-bottom: 1px;
    margin-bottom: -1px;
}
/*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
li:not(:last-child) > .wpt-tests-block:not([open]):last-child,
dd:not(:last-child) > .wpt-tests-block:not([open]):last-child {
    padding-bottom: 0;
    margin-bottom: 0;
}
.wpt-tests-block:not([open]):not(:hover){
    opacity: 0.5;
}
.wpt-tests-list {
    list-style: none;
    display: grid;
    margin: 0;
    padding: 0;
    grid-template-columns: 1fr max-content auto auto;
    grid-column-gap: .5em;
}
.wpt-tests-block hr:last-child {
    display: none;
}
.wpt-test {
    display: contents;
}
.wpt-test > a {
    text-decoration: underline;
    border: none;
}
.wpt-test > .wpt-name { grid-column: 1; }
.wpt-test > .wpt-results { grid-column: 2; }
.wpt-test > .wpt-live { grid-column: 3; }
.wpt-test > .wpt-source { grid-column: 4; }

.wpt-test > .wpt-results {
    display: flex;
    gap: .1em;
}
.wpt-test .wpt-result {
    display: inline-block;
    height: 1em;
    width: 1em;
    border-radius: 50%;
    position: relative;
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
</a>
</p>
   <h1 class="p-name no-ref" id="title">CSS Positioned Layout Module Level 4</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>,
    <time class="dt-updated" datetime="2025-06-30">30 June 2025</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://drafts.csswg.org/css-position-4/">https://drafts.csswg.org/css-position-4/</a>
      <dt>Issue Tracking:
      <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-position-4">CSSWG Issues Repository</a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="35400"><a class="p-name fn u-url url" href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a> (<span class="p-org org">Apple</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url" href="http://xanthir.com/contact/">Tab Atkins Jr.</a> (<span class="p-org org">Google</span>)
      <dt>Suggest an Edit for this Spec:
      <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-position-4/Overview.bs">GitHub Editor</a>
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply.
</p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This module contains defines coordinate-based positioning and offsetting schemes of <a href="https://www.w3.org/TR/CSS/">CSS</a>: <a data-link-type="dfn" href="https://www.w3.org/TR/CSS2/visuren.html#x34" id="ref-for-x34">relative positioning</a>, <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#sticky-position" id="ref-for-sticky-position">sticky positioning</a>, <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-position" id="ref-for-absolute-position">absolute positioning</a>, and <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#fixed-position" id="ref-for-fixed-position">fixed positioning</a>.</p>
   <p>It also defines the painting/rendering model of CSS.</p>
   


<a href="https://www.w3.org/TR/CSS/">CSS</a> is a language for describing the rendering of structured documents
(such as HTML and XML)
on screen, on paper, etc.


  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p>Please send feedback
	by <a href="https://github.com/w3c/csswg-drafts/issues">filing issues in GitHub</a> (preferred),
	including the spec code “css-position” in the title, like this:
	“[css-position] <i>…summary of comment…</i>”.
	All issues and comments are <a href="https://lists.w3.org/Archives/Public/public-css-archive/">archived</a>.
	Alternately, feedback can be sent to the (<a href="https://lists.w3.org/Archives/Public/www-style/">archived</a>) public mailing list
	<a href="mailto:www-style@w3.org?Subject=%5Bcss-position%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>.

</p>
   <p>This document is governed by the
	<a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>.

</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#painting-order"><span class="secno">2</span> <span class="content">Painting Order and Stacking Contexts</span></a>
    <li><a href="#scrollable-cb"><span class="secno">3</span> <span class="content">Scrollable Containing Block</span></a>
    <li>
     <a href="#top-layer"><span class="secno">4</span> <span class="content">Top Layer</span></a>
     <ol class="toc">
      <li><a href="#top-styling"><span class="secno">4.1</span> <span class="content">Top Layer Styling</span></a>
      <li><a href="#backdrop"><span class="secno">4.2</span> <span class="content">The <span class="css">::backdrop</span> Pseudo-Element</span></a>
      <li><a href="#top-manip"><span class="secno">4.3</span> <span class="content">Top Layer Manipulation</span></a>
      <li><a href="#overlay"><span class="secno">4.4</span> <span class="content">Controlling the Top Layer: the <span class="property">overlay</span> property</span></a>
     </ol>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">
Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">
Document conventions</span></a>
      <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
Conformance classes</span></a>
      <li>
       <a href="#w3c-partial"><span class="secno"></span> <span class="content">
Partial implementations</span></a>
       <ol class="toc">
        <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span class="content">
Implementations of Unstable and Proprietary Features</span></a>
       </ol>
      <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">
Non-experimental implementations</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#property-index"><span class="secno"></span> <span class="content">Property Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>This is an early delta spec over <a data-link-type="biblio" href="#biblio-css-position-3" title="CSS Positioned Layout Module Level 3">[css-position-3]</a>.</p>
   <h2 class="heading settled" data-level="2" id="painting-order"><span class="secno">2. </span><span class="content">Painting Order and Stacking Contexts</span><a class="self-link" href="#painting-order"></a></h2>
   <p>This chapter describes the painting order of CSS’s <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#box-tree" id="ref-for-box-tree">box tree</a>.</p>
   <p>When traversing the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#box-tree" id="ref-for-box-tree①">box tree</a>,
<a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order">tree order</a> is often used.
For <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment" id="ref-for-fragment">fragments</a>,
this refers to the logical order of the fragments,
not the visual order.
(This can be relevant, for example,
when rending bidirectional text.)</p>
   <p>Painting order is defined in terms of a "painter’s model",
where elements are described as painting in a stack,
with the bottom of the stack rendered "first",
below items higher in the stack.
The user is implied to exist above the top of the stack,
looking down:</p>
<pre class="ascii-art">             |     |         |
             |          |    |   ⇦ ☻
             |          |        user
z-index:  canvas  -1    0    1
</pre>
   <p>The stacking context background and most negative positioned
stacking contexts are at the bottom of the stack, while the most
positive positioned stacking contexts are at the top of the stack.</p>
   <p>The canvas is transparent if contained within another, and
given a UA-defined color if it is not. It is infinite in extent
and contains the root element. Initially, the viewport is anchored
with its top left corner at the canvas origin.</p>
   <div class="algorithm" data-algorithm="paint a document">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="paint-a-document">paint a document</dfn>,
	given a document <var>doc</var>
	and an infinite canvas <var>canvas</var>:


    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context">Paint a stacking context</a> given <var>doc</var>’s root element
 and <var>canvas</var>.</p>
     <li data-md>
      <p>For each element <var>el</var> in <var>doc</var>’s <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer">top layer</a>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context①">Paint a stacking context</a>
given <var>el</var>'s <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop">::backdrop</a> pseudo-element
and <var>canvas</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context②">Paint a stacking context</a> given <var>el</var> and <var>canvas</var>,
treating <var>el</var> as a <a data-link-type="dfn" href="https://www.w3.org/TR/CSS2/visuren.html#x43" id="ref-for-x43">stacking context</a>,
with the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#initial-containing-block" id="ref-for-initial-containing-block">initial containing block</a>
as its <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block" id="ref-for-containing-block">containing block</a>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="paint a stacking context">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="paint-a-stacking-context">paint a stacking context</dfn>
	given an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element" id="ref-for-concept-element">element</a>, <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/selectors-4/#pseudo-element" id="ref-for-pseudo-element">pseudo-element</a>, or <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#box" id="ref-for-box">box</a> <var>root</var>,
	and an infinite canvas <var>canvas</var>:


    <ol>
     <li data-md>
      <p>If <var>root</var> is an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element" id="ref-for-concept-element①">element</a>,
<a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context③">paint a stacking context</a> given <var>root</var>’s <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#principal-box" id="ref-for-principal-box">principal box</a>
and <var>canvas</var>,
then return.</p>
     <li data-md>
      <p class="assertion">Assert: <var>root</var> is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#box" id="ref-for-box①">box</a>,
and generates a <a data-link-type="dfn" href="https://www.w3.org/TR/CSS2/visuren.html#x43" id="ref-for-x43①">stacking context</a>.</p>
     <li data-md>
      <p>If <var>root</var> is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#root-element" id="ref-for-root-element">root element’s</a> <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#principal-box" id="ref-for-principal-box①">principal box</a>,
paint <var>root</var>’s background over the entire <var>canvas</var>,
with the origin of the background positioning area
being the position on <var>canvas</var>
that would be used if <var>root</var>’s background was being painted normally.</p>
     <li data-md>
      <p>If <var>root</var> is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level-box" id="ref-for-block-level-box">block-level box</a>,
<a data-link-type="dfn" href="#paint-a-blocks-decorations" id="ref-for-paint-a-blocks-decorations">paint a block’s decorations</a>
given <var>root</var> and <var>canvas</var>.</p>
     <li data-md>
      <p>For each of <var>root</var>’s positioned descendants
with negative (non-zero) <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index" id="ref-for-propdef-z-index">z-index</a> values,
sort those descendants by <span class="property" id="ref-for-propdef-z-index①">z-index</span> order (most negative first)
then <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order①">tree order</a>,
and <a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context④">paint a stacking context</a> given each descendant and <var>canvas</var>.</p>
     <li data-md>
      <p>For each of <var>root</var>’s in-flow, non-positioned, block-level descendants,
in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order②">tree order</a>,
<a data-link-type="dfn" href="#paint-a-blocks-decorations" id="ref-for-paint-a-blocks-decorations①">paint a block’s decorations</a>
given the descendant and <var>canvas</var>.</p>
     <li data-md>
      <p>For each of <var>root</var>’s non-positioned floating descendants,
in tree order,
<a data-link-type="dfn" href="#paint-a-stacking-container" id="ref-for-paint-a-stacking-container">paint a stacking container</a>
given the descendant and <var>canvas</var>.</p>
     <li data-md>
      <dl class="switch">
       <dt data-md>If <var>root</var> is an <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-level" id="ref-for-inline-level">inline-level</a> box
       <dd data-md>
        <p>For each line box <var>root</var> is in,
<a data-link-type="dfn" href="#paint-a-box-in-a-line-box" id="ref-for-paint-a-box-in-a-line-box">paint a box in a line box</a>
given <var>root</var>,
the line box,
and <var>canvas</var>.</p>
       <dt data-md>Otherwise
       <dd data-md>
        <p>First for <var>root</var>,
then for all its in-flow, non-positioned, <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level" id="ref-for-block-level">block-level</a> descendant boxes,
in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order③">tree order</a>:</p>
        <ol>
         <li data-md>
          <p>If the box is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#replaced-element" id="ref-for-replaced-element">replaced element</a>,
paint the replaced content into <var>canvas</var>, atomically.</p>
         <li data-md>
          <p>Otherwise, for each line box of the box,
<a data-link-type="dfn" href="#paint-a-box-in-a-line-box" id="ref-for-paint-a-box-in-a-line-box①">paint a box in a line box</a>
given the box,
the line box,
and <var>canvas</var>.</p>
         <li data-md>
          <p>If the UA uses <a data-link-type="dfn" href="#in-band-outline" id="ref-for-in-band-outline">in-band outlines</a>,
paint the outlines of the box
into <var>canvas</var>.</p>
        </ol>
      </dl>
     <li data-md>
      <p>For each of <var>root</var>’s positioned descendants
with <a class="css" data-link-type="propdesc" href="https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index" id="ref-for-propdef-z-index②">z-index: auto</a> or <span class="css" id="ref-for-propdef-z-index③">z-index: 0</span>,
in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order④">tree order</a>:</p>
      <dl class="switch">
       <dt data-md>descendant has <a class="css" data-link-type="propdesc" href="https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index" id="ref-for-propdef-z-index④">z-index: auto</a>
       <dd data-md>
        <p><a data-link-type="dfn" href="#paint-a-stacking-container" id="ref-for-paint-a-stacking-container①">Paint a stacking container</a>
given the descendant and <var>canvas</var>.</p>
       <dt data-md>descendant has <a class="css" data-link-type="propdesc" href="https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index" id="ref-for-propdef-z-index⑤">z-index: 0</a>
       <dd data-md>
        <p><a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context⑤">Paint a stacking context</a>
given the descendant and <var>canvas</var>.</p>
      </dl>
     <li data-md>
      <p>For each of <var>root</var>’s positioned descendants
with positive (non-zero) <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index" id="ref-for-propdef-z-index⑥">z-index</a> values,
sort those descendants by <span class="property" id="ref-for-propdef-z-index⑦">z-index</span> order (smallest first)
then <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order⑤">tree order</a>,
and <a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context⑥">paint a stacking context</a> given each descendant and <var>canvas</var>.</p>
     <li data-md>
      <p>If the UA uses <a data-link-type="dfn" href="#out-of-band-outline" id="ref-for-out-of-band-outline">out-of-band outlines</a>,
draw all of <var>root</var>’s outlines
(those that it skipped drawing
due to not using <a data-link-type="dfn" href="#in-band-outline" id="ref-for-in-band-outline①">in-band outlines</a>
during the current invocation of this algorithm)
into <var>canvas</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="paint a block’s decorations">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="paint-a-blocks-decorations">paint a block’s decorations</dfn>
	given a block box <var>root</var>
	and a canvas <var>canvas</var>:


    <ol>
     <li data-md>
      <p>If <var>root</var> is not a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box">table wrapper box</a>:</p>
      <ol>
       <li data-md>
        <p>Paint <var>root</var>’s background to <var>canvas</var>
if it is not the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#root-element" id="ref-for-root-element①">root element’s</a> <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#principal-box" id="ref-for-principal-box②">principal box</a>.</p>
       <li data-md>
        <p>Paint <var>root</var>’s border to <var>canvas</var>.</p>
      </ol>
     <li data-md>
      <p>If <var>root</var> is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box①">table wrapper box</a>:</p>
      <ol>
       <li data-md>
        <p>Paint <var>root</var>’s background to <var>canvas</var>
if it is not the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#root-element" id="ref-for-root-element②">root element’s</a> <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#principal-box" id="ref-for-principal-box③">principal box</a>.</p>
       <li data-md>
        <p>For each column group of <var>root</var> in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order⑥">tree order</a>,
paint the column group’s background to <var>canvas</var>.</p>
       <li data-md>
        <p>For each column of <var>root</var> in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order⑦">tree order</a>,
paint the column’s background to <var>canvas</var>.</p>
       <li data-md>
        <p>For each row group of <var>root</var> in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order⑧">tree order</a>,
paint the row group’s background to <var>canvas</var>.</p>
       <li data-md>
        <p>For each row of <var>root</var> in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order⑨">tree order</a>,
paint the row’s background to <var>canvas</var>.</p>
       <li data-md>
        <p>For each cell of <var>root</var> in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order①⓪">tree order</a>,
paint the cell’s background to <var>canvas</var>.</p>
       <li data-md>
        <p>Paint the borders of all of the table elements of <var>root</var>.
If the borders are separated,
do so in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order①①">tree order</a>;
if connected,
do so as specified in <a data-link-type="biblio" href="#biblio-css-tables-3" title="CSS Table Module Level 3">[css-tables-3]</a>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="paint a box in a line box">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="paint-a-box-in-a-line-box">paint a box in a line box</dfn>,
	given a box <var>root</var>,
	a line box <var>line box</var>,
	and a canvas <var>canvas</var>:


    <ol>
     <li data-md>
      <p>Paint the backgrounds
of <var>root</var>’s <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment" id="ref-for-fragment①">fragments</a> that are in <var>line box</var>
into <var>canvas</var>.</p>
     <li data-md>
      <p>Paint the borders
of <var>root</var>’s <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment" id="ref-for-fragment②">fragments</a> that are in <var>line box</var>
into <var>canvas</var>.</p>
     <li data-md>
      <dl class="switch">
       <dt data-md>If <var>root</var> is an <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-box" id="ref-for-inline-box">inline box</a>
       <dd data-md>
        <p>For all <var>root</var>’s in-flow, non-positioned, inline-level children
that generate <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment" id="ref-for-fragment③">fragments</a> in <var>line box</var>,
and all child <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#css-text-sequence" id="ref-for-css-text-sequence">text sequences</a>
that generate <span id="ref-for-fragment④">fragments</span> in <var>line box</var>,
in <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-order" id="ref-for-concept-tree-order①②">tree order</a>:</p>
        <dl class="switch">
         <dt data-md>If this child is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#css-text-sequence" id="ref-for-css-text-sequence①">text sequence</a>, then:
         <dd data-md>
          <ol>
           <li data-md>
            <p>Paint any underlining affecting the text,
in tree order of the elements applying the underlining
(such that the deepest element’s underlining, if any,
is painted topmost
and the root element’s underlining, if any,
is drawn bottommost)
into <var>canvas</var>.</p>
           <li data-md>
            <p>Paint any overlining affecting the text,
in tree order of the elements applying the overlining
(such that the deepest element’s overlining, if any,
is painted topmost
and the root element’s overlining, if any,
is drawn bottommost)
into <var>canvas</var>.</p>
           <li data-md>
            <p>Paint the text into <var>canvas</var>.</p>
           <li data-md>
            <p>Paint any line-through affecting the text,
in tree order of the elements applying the line-through
(such that the deepest element’s line-through, if any,
is painted topmost
and the root element’s line-through, if any,
is drawn bottommost)
into <var>canvas</var>.</p>
          </ol>
         <dt data-md>If this child is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#box" id="ref-for-box②">box</a>:
         <dd data-md>
          <p><a data-link-type="dfn" href="#paint-a-box-in-a-line-box" id="ref-for-paint-a-box-in-a-line-box②">Paint a box in a line box</a>
given the child,
<var>line box</var>,
and <var>canvas</var>.</p>
        </dl>
       <dt data-md>If <var>root</var> is an <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-level" id="ref-for-inline-level①">inline-level</a> <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-box" id="ref-for-block-box">block</a> or <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box②">table wrapper box</a>
       <dd data-md>
        <p><a data-link-type="dfn" href="#paint-a-stacking-container" id="ref-for-paint-a-stacking-container②">Paint a stacking container</a>
given <var>root</var> and <var>canvas</var>.</p>
       <dt data-md>If <var>root</var> is an <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-level" id="ref-for-inline-level②">inline-level</a> replaced element
       <dd data-md>
        <p>Paint the replaced content into <var>canvas</var>, atomically.</p>
      </dl>
     <li data-md>
      <p>If the UA uses <a data-link-type="dfn" href="#in-band-outline" id="ref-for-in-band-outline②">in-band outlines</a>,
paint the outlines
of <var>root</var>’s <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment" id="ref-for-fragment⑤">fragments</a> that are in <var>line box</var>
into <var>canvas</var>.</p>
    </ol>
    <p class="note" role="note"><span class="marker">Note:</span> Even though the visual order of inline box fragments
	can be rearranged within a line
	due to <a href="https://andreubotella.com/csswg-auto-build/test/css-writing-modes-3/#bidi-box-model">bidirectional reordering</a>,
	the fragments are nevertheless painted in tree order.</p>
   </div>
   <div class="algorithm" data-algorithm="paint a stacking container">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="paint-a-stacking-container">paint a stacking container</dfn>,
	given a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#box" id="ref-for-box③">box</a> <var>root</var>
	and a canvas <var>canvas</var>:


    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="#paint-a-stacking-context" id="ref-for-paint-a-stacking-context⑦">Paint a stacking context</a> given <var>root</var> and <var>canvas</var>,
treating <var>root</var> as if it created a new stacking context,
but omitting any positioned descendants
or descendants that actually create a stacking context
(letting the parent stacking context paint them, instead).</p>
    </ol>
   </div>
   <p>UAs can draw outlines (from the <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-ui-4/#propdef-outline" id="ref-for-propdef-outline">outline</a> property)
either <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="in-band outline" id="in-band-outline">in-band</dfn>
(painted along each element,
and thus potentially obscured/overlapping by following content)
or <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="out-of-band outline" id="out-of-band-outline">out-of-band</dfn>
(all outlines painted at the end of the stacking context,
so nothing in the stacking context can obscure them).
It is recommended that UAs use <a data-link-type="dfn" href="#out-of-band-outline" id="ref-for-out-of-band-outline①">out-of-band outlines</a>,
as making outlines easily visible
is an important accessibility feature.</p>
   <h2 class="heading settled" data-level="3" id="scrollable-cb"><span class="secno">3. </span><span class="content">Scrollable Containing Block</span><a class="self-link" href="#scrollable-cb"></a></h2>
   <p>When an element
generates an <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-positioning-containing-block" id="ref-for-absolute-positioning-containing-block">absolute positioning containing block</a>
for its descendants,
that <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block" id="ref-for-containing-block①">containing block</a> is generated from the element’s <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-box-4/#padding-box" id="ref-for-padding-box">padding box</a> edges.
If that element is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scroll-container" id="ref-for-scroll-container">scroll container</a>,
this corresponds to the dimensions of the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollport" id="ref-for-scrollport">scrollport</a>,
and does not shift as the scroll container is scrolled.
In other words,
it’s "outside of" the scrollable area.</p>
   <p>Sometimes, however, you instead want a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block" id="ref-for-containing-block②">containing block</a>
based on the "inside" of the scroll container,
sized according to the scrollable contents
and shifting as the container is scrolled.</p>
   <p>Whenever a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scroll-container" id="ref-for-scroll-container①">scroll container</a> generates an <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-positioning-containing-block" id="ref-for-absolute-positioning-containing-block①">absolute positioning containing block</a>,
it addition to the normal <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block" id="ref-for-containing-block③">containing block</a> it generates,
it also generates a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="scrollable-containing-block">scrollable containing block</dfn>.
This is sized to match the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-box-4/#padding-box" id="ref-for-padding-box①">padding box</a> edges
of the scrollable area,
and is treated as being "inside" the scrollable area,
so it moves as the <span id="ref-for-scroll-container②">scroll container</span> is scrolled.</p>
   <p class="note" role="note"><span class="marker">Note:</span> This is not <em>quite</em> the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollable-overflow-rectangle" id="ref-for-scrollable-overflow-rectangle">scrollable overflow rectangle</a>;
in particular, it doesn’t include the effects of transformed elements
or absolutely positioned elements.</p>
   <p>In <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block-chain" id="ref-for-containing-block-chain">containing block chains</a>,
the <a data-link-type="dfn" href="#scrollable-containing-block" id="ref-for-scrollable-containing-block">scrollable containing block</a> generated by an element
is considered a child of the element’s normal <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block" id="ref-for-containing-block④">containing block</a>,
and a parent of any containing blocks generated by its descendants.</p>
   <p>This also applies to the <u class="link-error" data-lt="root scroller" title="LINK ERROR: No &apos;dfn&apos; refs found for &apos;root scroller&apos;.">root scroller</u>;
a <a data-link-type="dfn" href="#scrollable-containing-block" id="ref-for-scrollable-containing-block①">scrollable containing block</a> that corresponds
to the padding edges of the entire document
is generated,
and is considered a child of the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#initial-containing-block" id="ref-for-initial-containing-block①">initial containing block</a>.</p>
   <p>The <a data-link-type="dfn" href="#scrollable-containing-block" id="ref-for-scrollable-containing-block②">scrollable containing block</a> is not used by default,
but certain CSS features
(such as <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-anchor-position-1/#propdef-position-area" id="ref-for-propdef-position-area">position-area</a>)
can specify that they use it instead of an element’s normal <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block" id="ref-for-containing-block⑤">containing block</a>.</p>
   <h2 class="heading settled" data-level="4" id="top-layer"><span class="secno">4. </span><span class="content">Top Layer</span><a class="self-link" href="#top-layer"></a></h2>
   <p><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code>s have a <dfn class="dfn-paneled" data-dfn-for="Document" data-dfn-type="dfn" data-export id="document-top-layer">top layer</dfn>,
an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">ordered set</a> containing <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element" id="ref-for-concept-element②">elements</a> from the document.
Elements in the <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①">top layer</a>
do not lay out normally based on their position in the document;
instead they generate <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#box" id="ref-for-box④">boxes</a>
as if they were siblings of the root element.
<span id="ref-for-document-top-layer②">Top layer</span> elements are rendered in the order they appear in the <span id="ref-for-document-top-layer③">top layer</span>;
the last element in the <span id="ref-for-document-top-layer④">top layer</span> is rendered on top of everything else.</p>
   <p class="note" role="note"><span class="marker">Note:</span> This special rendering behavior ensures
that elements in the <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer⑤">top layer</a> cannot be clipped by anything in the document,
or obscured by anything except elements later in the <span id="ref-for-document-top-layer⑥">top layer</span>.
This ensures that things like <u class="link-error" data-lt="popovers" title="LINK ERROR: No &apos;dfn&apos; refs found for &apos;popovers&apos;.">popovers</u>
can be displayed reliably,
regardless of what their ancestor elements might be doing.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="top-layer-root">top layer root</dfn> of an element
is its nearest ancestor element
that is in the <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer⑦">top layer</a>,
or none otherwise
(in which case it’s painted as part of the document as normal).</p>
   <p>Two elements are <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="in-the-same-top-layer">in the same top layer</dfn>
if they have the same <a data-link-type="dfn" href="#top-layer-root" id="ref-for-top-layer-root">top layer root</a>
(including if both are none).
An element A is <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="in-a-higher-top-layer">in a higher top layer</dfn>
than an element B
if A has a <span id="ref-for-top-layer-root①">top layer root</span>,
and either B has a <span id="ref-for-top-layer-root②">top layer root</span> earlier in the <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer⑧">top layer</a> than A’s,
or B doesn’t have a <span id="ref-for-top-layer-root③">top layer root</span> at all.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer⑨">top layer</a> is managed entirely by the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent">user agent</a>;
it cannot be directly manipulated by authors.
This ensures that "nested" invocations of top-layer-using APIs,
like a popup within a popup,
will display correctly.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①⓪">top layer</a> interacts with the <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay">overlay</a> property
in a somewhat unusual way.
See <span class="property" id="ref-for-propdef-overlay①">overlay</span> for details.</p>
   <p><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code>s also have a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="pending-top-layer-removals">pending top layer removals</dfn> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">ordered set</a>,
containing elements that are pending removal.
(See the algorithms, below, for details on how this is used.)</p>
   <p>The <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①①">top layer</a>
(and the <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals">pending top layer removals</a>)
should not be interacted with directly
by specification algorithms.
(Individual features using the <span id="ref-for-document-top-layer①②">top layer</span>
might have ownership over various things in the top layer,
like a popover inside of a popover,
that need to be reordered or moved as a group.)
Instead, specifications should use the following algorithms.</p>
   <h3 class="heading settled" data-level="4.1" id="top-styling"><span class="secno">4.1. </span><span class="content">Top Layer Styling</span><a class="self-link" href="#top-styling"></a></h3>
   <p>Every element <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer">rendered in the top layer</a>,
as well as its corresponding <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop①">::backdrop</a> pseudo-element,
are rendered with the following qualities:</p>
   <ul>
    <li data-md>
     <p>It generates a new <a data-link-type="dfn" href="https://www.w3.org/TR/CSS2/visuren.html#x43" id="ref-for-x43②">stacking context</a>.</p>
    <li data-md>
     <p>Its parent stacking context is the root stacking context.</p>
    <li data-md>
     <p>It is rendered as an atomic unit as if it were a sibling of the document’s root.</p>
     <p class="note" role="note"><span class="marker">Note:</span> Ancestor elements with <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#propdef-overflow" id="ref-for-propdef-overflow">overflow</a>, <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-color-4/#propdef-opacity" id="ref-for-propdef-opacity">opacity</a>, <a class="property css" data-link-type="property" href="https://drafts.fxtf.org/css-masking-1/#propdef-mask" id="ref-for-propdef-mask">mask</a>, etc. cannot affect it.</p>
    <li data-md>
     <p>If its <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#propdef-position" id="ref-for-propdef-position">position</a> property computes to <a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-fixed" id="ref-for-valdef-position-fixed">fixed</a>,
its containing block is the viewport;
otherwise, it’s the initial containing block.</p>
    <li data-md>
     <p>If it is an element,
it and its <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop②">::backdrop</a> pseudo-element are not rendered
if its <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-shadow-including-inclusive-ancestor" id="ref-for-concept-shadow-including-inclusive-ancestor">shadow-including inclusive ancestor</a> has the <a class="css" data-link-type="propdesc" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-display" id="ref-for-propdef-display">display: none</a>.</p>
    <li data-md>
     <p>If its specified <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-display" id="ref-for-propdef-display①">display</a> property is <a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-contents" id="ref-for-valdef-display-contents">contents</a>,
it computes to <a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-block" id="ref-for-valdef-display-block">block</a>.</p>
    <li data-md>
     <p>If its specified <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#propdef-position" id="ref-for-propdef-position①">position</a> property
is not <a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-absolute" id="ref-for-valdef-position-absolute">absolute</a> or <a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-fixed" id="ref-for-valdef-position-fixed①">fixed</a>,
it computes to <span class="css" id="ref-for-valdef-position-absolute①">absolute</span>.</p>
    <li data-md>
     <p>Unless overridden by another specification,
its static position for left, right, and top is zero.</p>
   </ul>
   <h3 class="heading settled" data-level="4.2" id="backdrop"><span class="secno">4.2. </span><span class="content">The <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop③">::backdrop</a> Pseudo-Element</span><a class="self-link" href="#backdrop"></a></h3>
   <p>Each element <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer①">rendered in the top layer</a> has a <dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="selectordef-backdrop">::backdrop</dfn> pseudo-element,
for which it is the <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/selectors-4/#originating-element" id="ref-for-originating-element">originating element</a>.</p>
   <p>When its computed <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-content-3/#propdef-content" id="ref-for-propdef-content">content</a> value is not <a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-content-3/#valdef-content-none" id="ref-for-valdef-content-none">none</a>,
<a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop④">::backdrop</a> pseudo-elements generate boxes
as if they were siblings of the root element.
They’re automatically rendered as a separate item in the <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①③">top layer</a>,
below their <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/selectors-4/#originating-element" id="ref-for-originating-element①">originating element</a>.
(See "<a data-link-type="dfn" href="#paint-a-document" id="ref-for-paint-a-document">paint a document</a>" for details.)</p>
   <p class="note" role="note"><span class="marker">Note:</span> The <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop⑤">::backdrop</a> pseudo-element
can be used to create a backdrop
that hides the underlying document for an element in a top layer
(such as an element that is displayed fullscreen).</p>
   <p>The <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop⑥">::backdrop</a> pseudo-element is a <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-pseudo-4/#tree-abiding" id="ref-for-tree-abiding">tree-abiding pseudo-element</a>.
It accepts all properties.
It inherits from its <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/selectors-4/#originating-element" id="ref-for-originating-element②">originating element</a>.</p>
   <p>User agents should contain the following rules in a UA-level style sheet:</p>
<pre class="highlight">::backdrop <c- p>{</c->
  <c- k>position</c-><c- p>:</c-> fixed<c- p>;</c->
  <c- k>inset</c-><c- p>:</c-> <c- m>0</c-><c- p>;</c->
<c- p>}</c->
</pre>
   <p>Other specifications can additional properties
to the default <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop⑦">::backdrop</a> rendering.</p>
   <p class="note" role="note"><span class="marker">Note:</span> For example, a fullscreen element
(see <a data-link-type="biblio" href="#biblio-fullscreen" title="Fullscreen API Standard">[FULLSCREEN]</a>)
styles its <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop⑧">::backdrop</a> as opaque black by default.</p>
   <p>See <a href="#top-styling">§ 4.1 Top Layer Styling</a> for additional details
on how <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop⑨">::backdrop</a> elements are rendered.</p>
   <h3 class="heading settled" data-level="4.3" id="top-manip"><span class="secno">4.3. </span><span class="content">Top Layer Manipulation</span><a class="self-link" href="#top-manip"></a></h3>
   <div class="algorithm" data-algorithm="in the top layer">
    
	An element <var>el</var> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="in-the-top-layer">in the top layer</dfn>
	if <var>el</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contained</a> in its <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node document’s</a> <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①④">top layer</a>
	but <em>not</em> <span id="ref-for-list-contain①">contained</span> in its <span id="ref-for-concept-node-document①">node document’s</span> <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals①">pending top layer removals</a>.


    <p class="note" role="note"><span class="marker">Note:</span> Specs should use this concept,
	rather than <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer②">rendered in the top layer</a>,
	when they are manipulating the top layer itself.
	Using this concept avoids the behavior being different
	based on whether there’s an <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay②">overlay</a> transition,
	or whether two operations happened <em>between</em> rendering updates
	or <em>across</em> them.</p>
   </div>
   <div class="algorithm" data-algorithm="render in the top layer">
    
	An element <var>el</var> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="render in the top layer" id="render-in-the-top-layer">rendered in the top layer</dfn>
	if <var>el</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain②">contained</a> in its <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document②">node document’s</a> <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①⑤">top layer</a>,
	and <var>el</var> has <a class="css" data-link-type="propdesc" href="#propdef-overlay" id="ref-for-propdef-overlay③">overlay: auto</a>.


    <p class="note" role="note"><span class="marker">Note:</span> Specs should use this concept,
	rather than <a data-link-type="dfn" href="#in-the-top-layer" id="ref-for-in-the-top-layer">in the top layer</a>,
	when they are not manipulating the top layer itself,
	but rather responding to the rendering behavior of being "on top of everything".
	For example, the presence of a <a class="css" data-link-type="maybe" href="#selectordef-backdrop" id="ref-for-selectordef-backdrop①⓪">::backdrop</a> pseudo
	relies on the element being <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer③">rendered in the top layer</a>;
	even if the element is <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals②">pending removal</a>,
	it has a <span class="css" id="ref-for-selectordef-backdrop①①">::backdrop</span> as long as it’s being displayed on top of everything.</p>
   </div>
   <div class="algorithm" data-algorithm="add an element to the top layer">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="add an element to the top layer | add to the top layer" id="add-an-element-to-the-top-layer">add an element to the top layer</dfn>,
	given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element">Element</a></code> <var>el</var>:


    <ol>
     <li data-md>
      <p>Let <var>doc</var> be <var>el</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document③">node document</a>.</p>
     <li data-md>
      <p>If <var>el</var> is already <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain③">contained</a> in <var>doc</var>’s <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①⑥">top layer</a>:</p>
      <ul>
       <li data-md>
        <p class="assertion">Assert: <var>el</var> is also in <var>doc</var>’s <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals③">pending top layer removals</a>.
(Otherwise, this is a spec error.)</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">Remove</a> <var>el</var> from both <var>doc</var>’s <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①⑦">top layer</a>
and <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals④">pending top layer removals</a>.</p>
      </ul>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>el</var> to <var>doc</var>’s <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①⑧">top layer</a>.</p>
     <li data-md>
      <p>At the UA !important <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-cascade-6/#origin" id="ref-for-origin">cascade origin</a>,
add a rule targeting <var>el</var>
containing an <a class="css" data-link-type="propdesc" href="#propdef-overlay" id="ref-for-propdef-overlay④">overlay: auto</a> declaration.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="request an element to be removed from the top layer">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="request an element to be removed from the top layer | request removal from the top layer" id="request-an-element-to-be-removed-from-the-top-layer">request an element to be removed from the top layer</dfn>,
	given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①">Element</a></code> <var>el</var>:


    <ol>
     <li data-md>
      <p>Let <var>doc</var> be <var>el</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document④">node document</a>.</p>
     <li data-md>
      <p>If <var>el</var> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain④">contained</a> <var>doc</var>’s <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer①⑨">top layer</a>,
or <var>el</var> <em>is</em> already <span id="ref-for-list-contain⑤">contained</span>
in <var>doc</var>’s <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals⑤">pending top layer removals</a>,
return.</p>
     <li data-md>
      <p>Remove the UA !important <a class="css" data-link-type="propdesc" href="#propdef-overlay" id="ref-for-propdef-overlay⑤">overlay: auto</a> rule targeting <var>el</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append①">Append</a> <var>el</var> to <var>doc</var>’s <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals⑥">pending top layer removals</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="remove an element from the top layer immediately">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="remove an element from the top layer immediately | remove from the top layer immediately" id="remove-an-element-from-the-top-layer-immediately">remove an element from the top layer immediately</dfn>,
	given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element②">Element</a></code> <var>el</var>:


    <ol>
     <li data-md>
      <p>Let <var>doc</var> be <var>el</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document⑤">node document</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove①">Remove</a> <var>el</var> from <var>doc</var>’s <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer②⓪">top layer</a> and <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals⑦">pending top layer removals</a>.</p>
     <li data-md>
      <p>Remove the UA !important <a class="css" data-link-type="propdesc" href="#propdef-overlay" id="ref-for-propdef-overlay⑥">overlay: auto</a> rule targeting <var>el</var>,
if it exists.</p>
    </ol>
    <p class="note" role="note"><span class="marker">Note:</span> This algorithm is only intended to be used in special cases
	where removing something from the top layer immediately
	(bypassing things like an <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay⑦">overlay</a> transition)
	is necessary,
	such as a modal dialog that is removed from the document.
	Most of the time, <a data-link-type="dfn" href="#request-an-element-to-be-removed-from-the-top-layer" id="ref-for-request-an-element-to-be-removed-from-the-top-layer">requesting removal from the top layer</a> is more appropriate.</p>
   </div>
   <div class="algorithm" data-algorithm="process top layer removals">
    
	To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="process-top-layer-removals">process top layer removals</dfn>,
	given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code> <var>doc</var>:


    <ol>
     <li data-md>
      <p>For each element <var>el</var> in <var>doc</var>’s <a data-link-type="dfn" href="#pending-top-layer-removals" id="ref-for-pending-top-layer-removals⑧">pending top layer removals</a>:
if <var>el</var>'s computed value of <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay⑧">overlay</a> is <a class="css" data-link-type="maybe" href="#valdef-overlay-none" id="ref-for-valdef-overlay-none">none</a>,
or <var>el</var> is <u class="link-error" data-lt="not rendered" title="LINK ERROR: No &apos;dfn&apos; refs found for &apos;not rendered&apos;.">not rendered</u>,
<a data-link-type="dfn" href="#remove-an-element-from-the-top-layer-immediately" id="ref-for-remove-an-element-from-the-top-layer-immediately">remove from the top layer immediately</a> <var>el</var>.</p>
    </ol>
    <p class="note" role="note"><span class="marker">Note:</span> This is intended to be called during the "Update the Rendering" step
	of HTML’s rendering algorithm.
	It is not intended to be called by other algorithms.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay⑨">overlay</a> check can be delayed arbitrarily long
	by author-level transitions;
	see <a href="#overlay">§ 4.4 Controlling the Top Layer: the overlay property</a> for details.</p>
   </div>
   <h3 class="heading settled" data-level="4.4" id="overlay"><span class="secno">4.4. </span><span class="content">Controlling the Top Layer: the <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay①⓪">overlay</a> property</span><a class="self-link" href="#overlay"></a></h3>
   <table class="def propdef" data-link-for-hint="overlay">
    <tbody>
     <tr>
      <th>Name:
      <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-overlay">overlay</dfn>
     <tr class="value">
      <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
      <td class="prod">none <a data-link-type="grammar" href="https://andreubotella.com/csswg-auto-build/test/css-values-4/#comb-one" id="ref-for-comb-one">|</a> auto
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
      <td>none
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
      <td><a href="https://www.w3.org/TR/css-pseudo/#generated-content" title="Includes ::before and ::after pseudo-elements.">all elements</a>
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
      <td>no
     <tr>
      <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
      <td>n/a
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
      <td>as specified
     <tr>
      <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
      <td>per grammar
     <tr>
      <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
      <td>see prose
   </table>
   <p>When an element is <a data-link-type="dfn" href="#in-the-top-layer" id="ref-for-in-the-top-layer①">in the top layer</a>,
the <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay①①">overlay</a> property determines
whether it is actually <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer④">rendered in the top layer</a> or not.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="overlay" data-dfn-type="value" data-export id="valdef-overlay-none">none</dfn>
    <dd data-md>
     <p>The element isn’t <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer⑤">rendered in the top layer</a>.</p>
    <dt data-md><dfn class="dfn-paneled css" data-dfn-for="overlay" data-dfn-type="value" data-export id="valdef-overlay-auto">auto</dfn>
    <dd data-md>
     <p>The element is <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer⑥">rendered in the top layer</a>
if it is <a data-link-type="dfn" href="#in-the-top-layer" id="ref-for-in-the-top-layer②">in the top layer</a>.</p>
     <p>Rather than generating boxes as part of its normal position in the document,
it generates boxes as a sibling of the root element,
rendered "above" it.</p>
   </dl>
   <div class="note" id="overlay-guidance" role="note">
    <a class="self-link" href="#overlay-guidance"></a>
	Note: <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay①②">overlay</a> is a somewhat unusual property,
	as it is <em>only</em> set by the user agent,
	and can’t be set by authors <em>at all</em>.


    <p>However, authors <em>do</em> have the ability to affect
	<em>when</em> <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay①③">overlay</a> changes its value,
	by setting a <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#propdef-transition" id="ref-for-propdef-transition">transition</a> on the property.
	This allows an author to align an animation
	with the transition,
	with the element moving in or out of the top layer
	only at the desired point in the animation.
	This allows, for example,
	an animation that causes an element to fade out of its normal position on the page,
	then fade in at its new top-layer position,
	or vice versa.</p>
   </div>
   <p>For animation,
<a class="css" data-link-type="maybe" href="#valdef-overlay-auto" id="ref-for-valdef-overlay-auto">auto</a> is <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-values-4/#interpolation" id="ref-for-interpolation">interpolated</a> as a discrete step
where values of p such that <code>0 &lt; p &lt; 1</code>
map to <span class="css" id="ref-for-valdef-overlay-auto①">auto</span>
and other values of p map to the closer endpoint;
if neither value is <span class="css" id="ref-for-valdef-overlay-auto②">auto</span> then discrete animation is used.</p>
   <p class="note" role="note"><span class="marker">Note:</span> This is similar to how <a class="property css" data-link-type="property" href="https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-visibility" id="ref-for-propdef-visibility">visibility</a> animates.
With most <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-easing-2/#easing-function" id="ref-for-easing-function">easing functions</a>,
this will keep the element <a data-link-type="dfn" href="#render-in-the-top-layer" id="ref-for-render-in-the-top-layer⑦">rendered in the top layer</a>
for the entire duration of the transition,
whether it’s entering or leaving the top layer.
<a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-start" id="ref-for-valdef-step-easing-function-step-start">step-start</a>/<a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-end" id="ref-for-valdef-step-easing-function-step-end">step-end</a>/<a class="css" data-link-type="maybe" href="https://andreubotella.com/csswg-auto-build/test/css-easing-2/#funcdef-linear" id="ref-for-funcdef-linear">linear()</a>
can be used to control when the value flips more precisely.</p>
   <p>User agents must have the following rule in their UA stylesheet:</p>
<pre class="highlight">* <c- p>{</c-> <c- k>overlay</c-><c- p>:</c-> none !important<c- p>;</c-> <c- p>}</c->
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> This means that the <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay①④">overlay</a> property <em>cannot be set by authors or users</em>—​it is entirely controlled by the user agent
(which sets elements to <span class="css" id="ref-for-propdef-overlay①⑤">overlay: auto</span>,
via another UA-!important rule,
when they’re in the <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer②①">top layer</a>).</p>
   <p>User agents <em>may</em>, at their discretion,
remove a running <a data-link-type="dfn" href="https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#transitions" id="ref-for-transitions">transition</a> on <a class="property css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay①⑥">overlay</a>.
The conditions for this are intentionally undefined.
<span class="note">(This is to prevent potential abuse scenarios
where a <a class="css" data-link-type="propdesc" href="https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#propdef-transition" id="ref-for-propdef-transition①">transition: overlay 1e9s;</a> or similar
attempts to keep an element in the <a data-link-type="dfn" href="#document-top-layer" id="ref-for-document-top-layer②②">top layer</a> permanently.)</span></p>
  </main>
  <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">
Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
  <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content">
Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    </p>
  <div class="example" id="w3c-example">
   <a class="self-link" href="#w3c-example"></a>
        
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <p>Advisements are normative sections styled to evoke special attention and are
    set apart from other normative text with <code>&lt;strong class="advisement"></code>, like
    this:

    <strong class="advisement">
        UAs MUST provide an accessible alternative.
    </strong></p>
  <details class="wpt-tests-block" dir="ltr" lang="en" open>
   <summary>Tests</summary>
   <p>Tests relating to the content of this specification
                     may be documented in “Tests” blocks like this one.
                     Any such block is non-normative.</p>
   <ul class="wpt-tests-list"></ul>
   <hr>
  </details>
  <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content">
Conformance classes</span><a class="self-link" href="#w3c-conformance-classes"></a></h3>
  <p>Conformance to this specification
    is defined for three conformance classes:
    </p>
  <dl>
   <dt>style sheet
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
            style sheet</a>.
        
   <dt>renderer
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
            that interprets the semantics of a style sheet and renders
            documents that use them.
        
   <dt>authoring tool
            
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
            that writes a style sheet.
    
  </dl>
  <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module.

    </p>
  <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.)

    </p>
  <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module.

</p>
  <h3 class="no-ref heading settled" id="w3c-partial"><span class="content">
Partial implementations</span><a class="self-link" href="#w3c-partial"></a></h3>
  <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong>
    treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>
  <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content">
Implementations of Unstable and Proprietary Features</span><a class="self-link" href="#w3c-conform-future-proofing"></a></h4>
  <p>To avoid clashes with future stable CSS features,
        the CSSWG recommends <a href="http://www.w3.org/TR/CSS/#future-proofing">following best practices</a> for the implementation of <a href="http://www.w3.org/TR/CSS/#unstable">unstable</a> features and <a href="http://www.w3.org/TR/CSS/#proprietary-extension">proprietary extensions</a> to CSS.

</p>
  <h3 class="no-ref heading settled" id="w3c-testing"><span class="content">
Non-experimental implementations</span><a class="self-link" href="#w3c-testing"></a></h3>
  <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec.

    </p>
  <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group.

    </p>
  <p>Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at
    <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the
    <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
    mailing list.</p>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#add-an-element-to-the-top-layer">add an element to the top layer</a><span>, in § 4.3</span>
   <li><a href="#add-an-element-to-the-top-layer">add to the top layer</a><span>, in § 4.3</span>
   <li><a href="#valdef-overlay-auto">auto</a><span>, in § 4.4</span>
   <li><a href="#selectordef-backdrop">::backdrop</a><span>, in § 4.2</span>
   <li><a href="#in-a-higher-top-layer">in a higher top layer</a><span>, in § 4</span>
   <li><a href="#in-band-outline">in-band outline</a><span>, in § 2</span>
   <li><a href="#in-the-same-top-layer">in the same top layer</a><span>, in § 4</span>
   <li><a href="#in-the-top-layer">in the top layer</a><span>, in § 4.3</span>
   <li><a href="#valdef-overlay-none">none</a><span>, in § 4.4</span>
   <li><a href="#out-of-band-outline">out-of-band outline</a><span>, in § 2</span>
   <li><a href="#propdef-overlay">overlay</a><span>, in § 4.4</span>
   <li><a href="#paint-a-blocks-decorations">paint a block’s decorations</a><span>, in § 2</span>
   <li><a href="#paint-a-box-in-a-line-box">paint a box in a line box</a><span>, in § 2</span>
   <li><a href="#paint-a-document">paint a document</a><span>, in § 2</span>
   <li><a href="#paint-a-stacking-container">paint a stacking container</a><span>, in § 2</span>
   <li><a href="#paint-a-stacking-context">paint a stacking context</a><span>, in § 2</span>
   <li><a href="#pending-top-layer-removals">pending top layer removals</a><span>, in § 4</span>
   <li><a href="#process-top-layer-removals">process top layer removals</a><span>, in § 4.3</span>
   <li><a href="#remove-an-element-from-the-top-layer-immediately">remove an element from the top layer immediately</a><span>, in § 4.3</span>
   <li><a href="#remove-an-element-from-the-top-layer-immediately">remove from the top layer immediately</a><span>, in § 4.3</span>
   <li><a href="#render-in-the-top-layer">render in the top layer</a><span>, in § 4.3</span>
   <li><a href="#request-an-element-to-be-removed-from-the-top-layer">request an element to be removed from the top layer</a><span>, in § 4.3</span>
   <li><a href="#request-an-element-to-be-removed-from-the-top-layer">request removal from the top layer</a><span>, in § 4.3</span>
   <li><a href="#scrollable-containing-block">scrollable containing block</a><span>, in § 3</span>
   <li><a href="#document-top-layer">top layer</a><span>, in § 4</span>
   <li><a href="#top-layer-root">top layer root</a><span>, in § 4</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS-ANCHOR-POSITION-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="05743aea">position-area</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-BOX-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a32a70ec">padding box</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-BREAK-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0023c450">fragment</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CASCADE-6]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f3c57a2e">cascade origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-COLOR-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="90dfc4e6">opacity</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CONTENT-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f96bc335">content</span>
     <li><span class="dfn-paneled" id="c8e464a0">none</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-DISPLAY-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c4a98f3b">block</span>
     <li><span class="dfn-paneled" id="bbe2bd93">block box</span>
     <li><span class="dfn-paneled" id="a8fd8a6a">block-level</span>
     <li><span class="dfn-paneled" id="b1c1df73">block-level box</span>
     <li><span class="dfn-paneled" id="35fda15c">box</span>
     <li><span class="dfn-paneled" id="af6f111b">box tree</span>
     <li><span class="dfn-paneled" id="3603ae22">containing block</span>
     <li><span class="dfn-paneled" id="b31fbe80">containing block chain</span>
     <li><span class="dfn-paneled" id="6ded3d6f">contents</span>
     <li><span class="dfn-paneled" id="649eec52">display</span>
     <li><span class="dfn-paneled" id="0fd8a325">initial containing block</span>
     <li><span class="dfn-paneled" id="c7cb2301">inline box</span>
     <li><span class="dfn-paneled" id="5547d838">inline-level</span>
     <li><span class="dfn-paneled" id="6a70f541">principal box</span>
     <li><span class="dfn-paneled" id="48d82798">replaced element</span>
     <li><span class="dfn-paneled" id="43aefead">root element</span>
     <li><span class="dfn-paneled" id="3c965b2a">text sequence</span>
     <li><span class="dfn-paneled" id="10818e6d">visibility</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-EASING-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="fdf5064e">easing function</span>
     <li><span class="dfn-paneled" id="7f950ffc">linear()</span>
     <li><span class="dfn-paneled" id="4743fff0">step-end</span>
     <li><span class="dfn-paneled" id="00cd721b">step-start</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-MASKING-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="bd765d87">mask</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-OVERFLOW-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5e56c929">overflow</span>
     <li><span class="dfn-paneled" id="69547633">scroll container</span>
     <li><span class="dfn-paneled" id="9a270c76">scrollable overflow rectangle</span>
     <li><span class="dfn-paneled" id="e3892eaa">scrollport</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-POSITION-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="af537e3f">absolute</span>
     <li><span class="dfn-paneled" id="bbdac8e6">absolute position</span>
     <li><span class="dfn-paneled" id="44bccbcd">absolute positioning containing block</span>
     <li><span class="dfn-paneled" id="2a666fa9">fixed</span>
     <li><span class="dfn-paneled" id="c3307517">fixed position</span>
     <li><span class="dfn-paneled" id="50a5eb45">position</span>
     <li><span class="dfn-paneled" id="186c40a6">sticky position</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-PSEUDO-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a1fc3eca">tree-abiding pseudo-elements</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-TABLES-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="69689470">table wrapper box</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-TRANSITIONS-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="04734e3e">transition</span>
     <li><span class="dfn-paneled" id="79cb78b4">transitions</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-UI-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="e438d305">outline</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-VALUES-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a2932f14">interpolate</span>
     <li><span class="dfn-paneled" id="7936a36b">|</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f285fdb1">relative positioning</span>
     <li><span class="dfn-paneled" id="b8c9eb8a">stacking context</span>
     <li><span class="dfn-paneled" id="51fc15a7">z-index</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="85394472">Document</span>
     <li><span class="dfn-paneled" id="296f3551">Element</span>
     <li><span class="dfn-paneled" id="27d9b7ea">element</span>
     <li><span class="dfn-paneled" id="5216e1a0">node document</span>
     <li><span class="dfn-paneled" id="3d6a3d36">shadow-including inclusive ancestor</span>
     <li><span class="dfn-paneled" id="25538777">tree order</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a3b18719">append</span>
     <li><span class="dfn-paneled" id="ae8def21">contain</span>
     <li><span class="dfn-paneled" id="692595fe">ordered set</span>
     <li><span class="dfn-paneled" id="99c988d6">remove</span>
     <li><span class="dfn-paneled" id="6d19ac93">user agent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SELECTORS-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="97b8be07">originating element</span>
     <li><span class="dfn-paneled" id="b821ba02">pseudo-element</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-anchor-position-1">[CSS-ANCHOR-POSITION-1]
   <dd>Tab Atkins Jr.; Elika Etemad; Ian Kilpatrick. <a href="https://andreubotella.com/csswg-auto-build/test/css-anchor-position-1/"><cite>CSS Anchor Positioning</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-anchor-position-1/">https://andreubotella.com/csswg-auto-build/test/css-anchor-position-1/</a>
   <dt id="biblio-css-box-4">[CSS-BOX-4]
   <dd>Elika Etemad. <a href="https://andreubotella.com/csswg-auto-build/test/css-box-4/"><cite>CSS Box Model Module Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-box-4/">https://andreubotella.com/csswg-auto-build/test/css-box-4/</a>
   <dt id="biblio-css-break-4">[CSS-BREAK-4]
   <dd>Rossen Atanassov; Elika Etemad. <a href="https://andreubotella.com/csswg-auto-build/test/css-break-4/"><cite>CSS Fragmentation Module Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-break-4/">https://andreubotella.com/csswg-auto-build/test/css-break-4/</a>
   <dt id="biblio-css-cascade-6">[CSS-CASCADE-6]
   <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://andreubotella.com/csswg-auto-build/test/css-cascade-6/"><cite>CSS Cascading and Inheritance Level 6</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-cascade-6/">https://andreubotella.com/csswg-auto-build/test/css-cascade-6/</a>
   <dt id="biblio-css-content-3">[CSS-CONTENT-3]
   <dd>Elika Etemad; Dave Cramer. <a href="https://andreubotella.com/csswg-auto-build/test/css-content-3/"><cite>CSS Generated Content Module Level 3</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-content-3/">https://andreubotella.com/csswg-auto-build/test/css-content-3/</a>
   <dt id="biblio-css-display-4">[CSS-DISPLAY-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://andreubotella.com/csswg-auto-build/test/css-display/"><cite>CSS Display Module Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-display/">https://andreubotella.com/csswg-auto-build/test/css-display/</a>
   <dt id="biblio-css-overflow-3">[CSS-OVERFLOW-3]
   <dd>Elika Etemad; Florian Rivoal. <a href="https://andreubotella.com/csswg-auto-build/test/css-overflow-3/"><cite>CSS Overflow Module Level 3</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-overflow-3/">https://andreubotella.com/csswg-auto-build/test/css-overflow-3/</a>
   <dt id="biblio-css-position-3">[CSS-POSITION-3]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://andreubotella.com/csswg-auto-build/test/css-position-3/"><cite>CSS Positioned Layout Module Level 3</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-position-3/">https://andreubotella.com/csswg-auto-build/test/css-position-3/</a>
   <dt id="biblio-css-pseudo-4">[CSS-PSEUDO-4]
   <dd>Elika Etemad; Alan Stearns. <a href="https://andreubotella.com/csswg-auto-build/test/css-pseudo-4/"><cite>CSS Pseudo-Elements Module Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-pseudo-4/">https://andreubotella.com/csswg-auto-build/test/css-pseudo-4/</a>
   <dt id="biblio-css-tables-3">[CSS-TABLES-3]
   <dd>François Remy; Greg Whitworth; David Baron. <a href="https://andreubotella.com/csswg-auto-build/test/css-tables-3/"><cite>CSS Table Module Level 3</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-tables-3/">https://andreubotella.com/csswg-auto-build/test/css-tables-3/</a>
   <dt id="biblio-css-transitions-1">[CSS-TRANSITIONS-1]
   <dd>David Baron; et al. <a href="https://andreubotella.com/csswg-auto-build/test/css-transitions/"><cite>CSS Transitions</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-transitions/">https://andreubotella.com/csswg-auto-build/test/css-transitions/</a>
   <dt id="biblio-css-ui-4">[CSS-UI-4]
   <dd>Florian Rivoal. <a href="https://andreubotella.com/csswg-auto-build/test/css-ui-4/"><cite>CSS Basic User Interface Module Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-ui-4/">https://andreubotella.com/csswg-auto-build/test/css-ui-4/</a>
   <dt id="biblio-css-values-4">[CSS-VALUES-4]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://andreubotella.com/csswg-auto-build/test/css-values-4/"><cite>CSS Values and Units Module Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-values-4/">https://andreubotella.com/csswg-auto-build/test/css-values-4/</a>
   <dt id="biblio-css2">[CSS2]
   <dd>Bert Bos; et al. <a href="https://andreubotella.com/csswg-auto-build/test/css2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css2/">https://andreubotella.com/csswg-auto-build/test/css2/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-selectors-4">[SELECTORS-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://andreubotella.com/csswg-auto-build/test/selectors/"><cite>Selectors Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/selectors/">https://andreubotella.com/csswg-auto-build/test/selectors/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-css-color-4">[CSS-COLOR-4]
   <dd>Chris Lilley; Tab Atkins Jr.; Lea Verou. <a href="https://andreubotella.com/csswg-auto-build/test/css-color-4/"><cite>CSS Color Module Level 4</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-color-4/">https://andreubotella.com/csswg-auto-build/test/css-color-4/</a>
   <dt id="biblio-css-easing-2">[CSS-EASING-2]
   <dd><a href="https://andreubotella.com/csswg-auto-build/test/css-easing/"><cite>CSS Easing Functions Level 2</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-easing/">https://andreubotella.com/csswg-auto-build/test/css-easing/</a>
   <dt id="biblio-css-masking-1">[CSS-MASKING-1]
   <dd>Dirk Schulze; Brian Birtles; Tab Atkins Jr.. <a href="https://drafts.fxtf.org/css-masking-1/"><cite>CSS Masking Module Level 1</cite></a>. URL: <a href="https://drafts.fxtf.org/css-masking-1/">https://drafts.fxtf.org/css-masking-1/</a>
   <dt id="biblio-css-writing-modes-3">[CSS-WRITING-MODES-3]
   <dd>Elika Etemad; Koji Ishii. <a href="https://andreubotella.com/csswg-auto-build/test/css-writing-modes-3/"><cite>CSS Writing Modes Level 3</cite></a>. URL: <a href="https://andreubotella.com/csswg-auto-build/test/css-writing-modes-3/">https://andreubotella.com/csswg-auto-build/test/css-writing-modes-3/</a>
   <dt id="biblio-fullscreen">[FULLSCREEN]
   <dd>Philip Jägenstedt. <a href="https://fullscreen.spec.whatwg.org/"><cite>Fullscreen API Standard</cite></a>. Living Standard. URL: <a href="https://fullscreen.spec.whatwg.org/">https://fullscreen.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">Property Index</span><a class="self-link" href="#property-index"></a></h2>
  <div class="big-element-wrapper">
   <table class="index">
    <thead>
     <tr>
      <th scope="col">Name
      <th scope="col">Value
      <th scope="col">Initial
      <th scope="col">Applies to
      <th scope="col">Inh.
      <th scope="col">%ages
      <th scope="col">Anim­ation type
      <th scope="col">Canonical order
      <th scope="col">Com­puted value
    <tbody>
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-overlay" id="ref-for-propdef-overlay①⑦">overlay</a>
      <td>none | auto
      <td>none
      <td>all elements
      <td>no
      <td>n/a
      <td>see prose
      <td>per grammar
      <td>as specified
   </table>
  </div>
  <details class="mdn-anno unpositioned" data-anno-for="backdrop">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/::backdrop" title="The ::backdrop CSS pseudo-element is a box the size of the viewport, which is rendered immediately beneath any element being presented in the top layer.">::backdrop</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>47+</span></span><span class="safari yes"><span>Safari</span><span>15.4+</span></span><span class="chrome yes"><span>Chrome</span><span>37+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"0023c450": {"dfnID":"0023c450","dfnText":"fragment","external":true,"refSections":[{"refs":[{"id":"ref-for-fragment"},{"id":"ref-for-fragment\u2460"},{"id":"ref-for-fragment\u2461"},{"id":"ref-for-fragment\u2462"},{"id":"ref-for-fragment\u2463"},{"id":"ref-for-fragment\u2464"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment"},
"00cd721b": {"dfnID":"00cd721b","dfnText":"step-start","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-step-easing-function-step-start"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-start"},
"04734e3e": {"dfnID":"04734e3e","dfnText":"transition","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-transition"},{"id":"ref-for-propdef-transition\u2460"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#propdef-transition"},
"05743aea": {"dfnID":"05743aea","dfnText":"position-area","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-position-area"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-anchor-position-1/#propdef-position-area"},
"0fd8a325": {"dfnID":"0fd8a325","dfnText":"initial containing block","external":true,"refSections":[{"refs":[{"id":"ref-for-initial-containing-block"}],"title":"2. Painting Order and Stacking Contexts"},{"refs":[{"id":"ref-for-initial-containing-block\u2460"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#initial-containing-block"},
"10818e6d": {"dfnID":"10818e6d","dfnText":"visibility","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-visibility"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-visibility"},
"186c40a6": {"dfnID":"186c40a6","dfnText":"sticky position","external":true,"refSections":[{"refs":[{"id":"ref-for-sticky-position"}],"title":"Unnumbered Section"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#sticky-position"},
"25538777": {"dfnID":"25538777","dfnText":"tree order","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-tree-order"},{"id":"ref-for-concept-tree-order\u2460"},{"id":"ref-for-concept-tree-order\u2461"},{"id":"ref-for-concept-tree-order\u2462"},{"id":"ref-for-concept-tree-order\u2463"},{"id":"ref-for-concept-tree-order\u2464"},{"id":"ref-for-concept-tree-order\u2465"},{"id":"ref-for-concept-tree-order\u2466"},{"id":"ref-for-concept-tree-order\u2467"},{"id":"ref-for-concept-tree-order\u2468"},{"id":"ref-for-concept-tree-order\u2460\u24ea"},{"id":"ref-for-concept-tree-order\u2460\u2460"},{"id":"ref-for-concept-tree-order\u2460\u2461"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://dom.spec.whatwg.org/#concept-tree-order"},
"27d9b7ea": {"dfnID":"27d9b7ea","dfnText":"element","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-element"},{"id":"ref-for-concept-element\u2460"}],"title":"2. Painting Order and Stacking Contexts"},{"refs":[{"id":"ref-for-concept-element\u2461"}],"title":"4. Top Layer"}],"url":"https://dom.spec.whatwg.org/#concept-element"},
"296f3551": {"dfnID":"296f3551","dfnText":"Element","external":true,"refSections":[{"refs":[{"id":"ref-for-element"},{"id":"ref-for-element\u2460"},{"id":"ref-for-element\u2461"}],"title":"4.3. Top Layer Manipulation"}],"url":"https://dom.spec.whatwg.org/#element"},
"2a666fa9": {"dfnID":"2a666fa9","dfnText":"fixed","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-position-fixed"},{"id":"ref-for-valdef-position-fixed\u2460"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-fixed"},
"35fda15c": {"dfnID":"35fda15c","dfnText":"box","external":true,"refSections":[{"refs":[{"id":"ref-for-box"},{"id":"ref-for-box\u2460"},{"id":"ref-for-box\u2461"},{"id":"ref-for-box\u2462"}],"title":"2. Painting Order and Stacking Contexts"},{"refs":[{"id":"ref-for-box\u2463"}],"title":"4. Top Layer"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#box"},
"3603ae22": {"dfnID":"3603ae22","dfnText":"containing block","external":true,"refSections":[{"refs":[{"id":"ref-for-containing-block"}],"title":"2. Painting Order and Stacking Contexts"},{"refs":[{"id":"ref-for-containing-block\u2460"},{"id":"ref-for-containing-block\u2461"},{"id":"ref-for-containing-block\u2462"},{"id":"ref-for-containing-block\u2463"},{"id":"ref-for-containing-block\u2464"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block"},
"3c965b2a": {"dfnID":"3c965b2a","dfnText":"text sequence","external":true,"refSections":[{"refs":[{"id":"ref-for-css-text-sequence"},{"id":"ref-for-css-text-sequence\u2460"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#css-text-sequence"},
"3d6a3d36": {"dfnID":"3d6a3d36","dfnText":"shadow-including inclusive ancestor","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-shadow-including-inclusive-ancestor"}],"title":"4.1. Top Layer Styling"}],"url":"https://dom.spec.whatwg.org/#concept-shadow-including-inclusive-ancestor"},
"43aefead": {"dfnID":"43aefead","dfnText":"root element","external":true,"refSections":[{"refs":[{"id":"ref-for-root-element"},{"id":"ref-for-root-element\u2460"},{"id":"ref-for-root-element\u2461"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#root-element"},
"44bccbcd": {"dfnID":"44bccbcd","dfnText":"absolute positioning containing block","external":true,"refSections":[{"refs":[{"id":"ref-for-absolute-positioning-containing-block"},{"id":"ref-for-absolute-positioning-containing-block\u2460"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-positioning-containing-block"},
"4743fff0": {"dfnID":"4743fff0","dfnText":"step-end","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-step-easing-function-step-end"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-end"},
"48d82798": {"dfnID":"48d82798","dfnText":"replaced element","external":true,"refSections":[{"refs":[{"id":"ref-for-replaced-element"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#replaced-element"},
"50a5eb45": {"dfnID":"50a5eb45","dfnText":"position","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-position"},{"id":"ref-for-propdef-position\u2460"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#propdef-position"},
"51fc15a7": {"dfnID":"51fc15a7","dfnText":"z-index","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-z-index"},{"id":"ref-for-propdef-z-index\u2460"},{"id":"ref-for-propdef-z-index\u2461"},{"id":"ref-for-propdef-z-index\u2462"},{"id":"ref-for-propdef-z-index\u2463"},{"id":"ref-for-propdef-z-index\u2464"},{"id":"ref-for-propdef-z-index\u2465"},{"id":"ref-for-propdef-z-index\u2466"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index"},
"5216e1a0": {"dfnID":"5216e1a0","dfnText":"node document","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-node-document"},{"id":"ref-for-concept-node-document\u2460"},{"id":"ref-for-concept-node-document\u2461"},{"id":"ref-for-concept-node-document\u2462"},{"id":"ref-for-concept-node-document\u2463"},{"id":"ref-for-concept-node-document\u2464"}],"title":"4.3. Top Layer Manipulation"}],"url":"https://dom.spec.whatwg.org/#concept-node-document"},
"5547d838": {"dfnID":"5547d838","dfnText":"inline-level","external":true,"refSections":[{"refs":[{"id":"ref-for-inline-level"},{"id":"ref-for-inline-level\u2460"},{"id":"ref-for-inline-level\u2461"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-level"},
"5e56c929": {"dfnID":"5e56c929","dfnText":"overflow","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-overflow"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#propdef-overflow"},
"649eec52": {"dfnID":"649eec52","dfnText":"display","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-display"},{"id":"ref-for-propdef-display\u2460"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-display"},
"692595fe": {"dfnID":"692595fe","dfnText":"ordered set","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-set"},{"id":"ref-for-ordered-set\u2460"}],"title":"4. Top Layer"}],"url":"https://infra.spec.whatwg.org/#ordered-set"},
"69547633": {"dfnID":"69547633","dfnText":"scroll container","external":true,"refSections":[{"refs":[{"id":"ref-for-scroll-container"},{"id":"ref-for-scroll-container\u2460"},{"id":"ref-for-scroll-container\u2461"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scroll-container"},
"69689470": {"dfnID":"69689470","dfnText":"table wrapper box","external":true,"refSections":[{"refs":[{"id":"ref-for-table-wrapper-box"},{"id":"ref-for-table-wrapper-box\u2460"},{"id":"ref-for-table-wrapper-box\u2461"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-tables-3/#table-wrapper-box"},
"6a70f541": {"dfnID":"6a70f541","dfnText":"principal box","external":true,"refSections":[{"refs":[{"id":"ref-for-principal-box"},{"id":"ref-for-principal-box\u2460"},{"id":"ref-for-principal-box\u2461"},{"id":"ref-for-principal-box\u2462"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#principal-box"},
"6d19ac93": {"dfnID":"6d19ac93","dfnText":"user agent","external":true,"refSections":[{"refs":[{"id":"ref-for-user-agent"}],"title":"4. Top Layer"}],"url":"https://infra.spec.whatwg.org/#user-agent"},
"6ded3d6f": {"dfnID":"6ded3d6f","dfnText":"contents","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-display-contents"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-contents"},
"7936a36b": {"dfnID":"7936a36b","dfnText":"|","external":true,"refSections":[{"refs":[{"id":"ref-for-comb-one"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-values-4/#comb-one"},
"79cb78b4": {"dfnID":"79cb78b4","dfnText":"transitions","external":true,"refSections":[{"refs":[{"id":"ref-for-transitions"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#transitions"},
"7f950ffc": {"dfnID":"7f950ffc","dfnText":"linear()","external":true,"refSections":[{"refs":[{"id":"ref-for-funcdef-linear"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#funcdef-linear"},
"85394472": {"dfnID":"85394472","dfnText":"Document","external":true,"refSections":[{"refs":[{"id":"ref-for-document"},{"id":"ref-for-document\u2460"}],"title":"4. Top Layer"},{"refs":[{"id":"ref-for-document\u2461"}],"title":"4.3. Top Layer Manipulation"}],"url":"https://dom.spec.whatwg.org/#document"},
"90dfc4e6": {"dfnID":"90dfc4e6","dfnText":"opacity","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-opacity"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-color-4/#propdef-opacity"},
"97b8be07": {"dfnID":"97b8be07","dfnText":"originating element","external":true,"refSections":[{"refs":[{"id":"ref-for-originating-element"},{"id":"ref-for-originating-element\u2460"},{"id":"ref-for-originating-element\u2461"}],"title":"4.2. The ::backdrop Pseudo-Element"}],"url":"https://andreubotella.com/csswg-auto-build/test/selectors-4/#originating-element"},
"99c988d6": {"dfnID":"99c988d6","dfnText":"remove","external":true,"refSections":[{"refs":[{"id":"ref-for-list-remove"},{"id":"ref-for-list-remove\u2460"}],"title":"4.3. Top Layer Manipulation"}],"url":"https://infra.spec.whatwg.org/#list-remove"},
"9a270c76": {"dfnID":"9a270c76","dfnText":"scrollable overflow rectangle","external":true,"refSections":[{"refs":[{"id":"ref-for-scrollable-overflow-rectangle"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollable-overflow-rectangle"},
"a1fc3eca": {"dfnID":"a1fc3eca","dfnText":"tree-abiding pseudo-elements","external":true,"refSections":[{"refs":[{"id":"ref-for-tree-abiding"}],"title":"4.2. The ::backdrop Pseudo-Element"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-pseudo-4/#tree-abiding"},
"a2932f14": {"dfnID":"a2932f14","dfnText":"interpolate","external":true,"refSections":[{"refs":[{"id":"ref-for-interpolation"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-values-4/#interpolation"},
"a32a70ec": {"dfnID":"a32a70ec","dfnText":"padding box","external":true,"refSections":[{"refs":[{"id":"ref-for-padding-box"},{"id":"ref-for-padding-box\u2460"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-box-4/#padding-box"},
"a3b18719": {"dfnID":"a3b18719","dfnText":"append","external":true,"refSections":[{"refs":[{"id":"ref-for-set-append"},{"id":"ref-for-set-append\u2460"}],"title":"4.3. Top Layer Manipulation"}],"url":"https://infra.spec.whatwg.org/#set-append"},
"a8fd8a6a": {"dfnID":"a8fd8a6a","dfnText":"block-level","external":true,"refSections":[{"refs":[{"id":"ref-for-block-level"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level"},
"add-an-element-to-the-top-layer": {"dfnID":"add-an-element-to-the-top-layer","dfnText":"add an element to the top layer","external":false,"refSections":[],"url":"#add-an-element-to-the-top-layer"},
"ae8def21": {"dfnID":"ae8def21","dfnText":"contain","external":true,"refSections":[{"refs":[{"id":"ref-for-list-contain"},{"id":"ref-for-list-contain\u2460"},{"id":"ref-for-list-contain\u2461"},{"id":"ref-for-list-contain\u2462"},{"id":"ref-for-list-contain\u2463"},{"id":"ref-for-list-contain\u2464"}],"title":"4.3. Top Layer Manipulation"}],"url":"https://infra.spec.whatwg.org/#list-contain"},
"af537e3f": {"dfnID":"af537e3f","dfnText":"absolute","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-position-absolute"},{"id":"ref-for-valdef-position-absolute\u2460"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-absolute"},
"af6f111b": {"dfnID":"af6f111b","dfnText":"box tree","external":true,"refSections":[{"refs":[{"id":"ref-for-box-tree"},{"id":"ref-for-box-tree\u2460"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#box-tree"},
"b1c1df73": {"dfnID":"b1c1df73","dfnText":"block-level box","external":true,"refSections":[{"refs":[{"id":"ref-for-block-level-box"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level-box"},
"b31fbe80": {"dfnID":"b31fbe80","dfnText":"containing block chain","external":true,"refSections":[{"refs":[{"id":"ref-for-containing-block-chain"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block-chain"},
"b821ba02": {"dfnID":"b821ba02","dfnText":"pseudo-element","external":true,"refSections":[{"refs":[{"id":"ref-for-pseudo-element"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/selectors-4/#pseudo-element"},
"b8c9eb8a": {"dfnID":"b8c9eb8a","dfnText":"stacking context","external":true,"refSections":[{"refs":[{"id":"ref-for-x43"},{"id":"ref-for-x43\u2460"}],"title":"2. Painting Order and Stacking Contexts"},{"refs":[{"id":"ref-for-x43\u2461"}],"title":"4.1. Top Layer Styling"}],"url":"https://www.w3.org/TR/CSS2/visuren.html#x43"},
"bbdac8e6": {"dfnID":"bbdac8e6","dfnText":"absolute position","external":true,"refSections":[{"refs":[{"id":"ref-for-absolute-position"}],"title":"Unnumbered Section"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-position"},
"bbe2bd93": {"dfnID":"bbe2bd93","dfnText":"block box","external":true,"refSections":[{"refs":[{"id":"ref-for-block-box"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-box"},
"bd765d87": {"dfnID":"bd765d87","dfnText":"mask","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-mask"}],"title":"4.1. Top Layer Styling"}],"url":"https://drafts.fxtf.org/css-masking-1/#propdef-mask"},
"c3307517": {"dfnID":"c3307517","dfnText":"fixed position","external":true,"refSections":[{"refs":[{"id":"ref-for-fixed-position"}],"title":"Unnumbered Section"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#fixed-position"},
"c4a98f3b": {"dfnID":"c4a98f3b","dfnText":"block","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-display-block"}],"title":"4.1. Top Layer Styling"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-block"},
"c7cb2301": {"dfnID":"c7cb2301","dfnText":"inline box","external":true,"refSections":[{"refs":[{"id":"ref-for-inline-box"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-box"},
"c8e464a0": {"dfnID":"c8e464a0","dfnText":"none","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-content-none"}],"title":"4.2. The ::backdrop Pseudo-Element"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-content-3/#valdef-content-none"},
"document-top-layer": {"dfnID":"document-top-layer","dfnText":"top layer","external":false,"refSections":[{"refs":[{"id":"ref-for-document-top-layer"}],"title":"2. Painting Order and Stacking Contexts"},{"refs":[{"id":"ref-for-document-top-layer\u2460"},{"id":"ref-for-document-top-layer\u2461"},{"id":"ref-for-document-top-layer\u2462"},{"id":"ref-for-document-top-layer\u2463"},{"id":"ref-for-document-top-layer\u2464"},{"id":"ref-for-document-top-layer\u2465"},{"id":"ref-for-document-top-layer\u2466"},{"id":"ref-for-document-top-layer\u2467"},{"id":"ref-for-document-top-layer\u2468"},{"id":"ref-for-document-top-layer\u2460\u24ea"},{"id":"ref-for-document-top-layer\u2460\u2460"},{"id":"ref-for-document-top-layer\u2460\u2461"}],"title":"4. Top Layer"},{"refs":[{"id":"ref-for-document-top-layer\u2460\u2462"}],"title":"4.2. The ::backdrop Pseudo-Element"},{"refs":[{"id":"ref-for-document-top-layer\u2460\u2463"},{"id":"ref-for-document-top-layer\u2460\u2464"},{"id":"ref-for-document-top-layer\u2460\u2465"},{"id":"ref-for-document-top-layer\u2460\u2466"},{"id":"ref-for-document-top-layer\u2460\u2467"},{"id":"ref-for-document-top-layer\u2460\u2468"},{"id":"ref-for-document-top-layer\u2461\u24ea"}],"title":"4.3. Top Layer Manipulation"},{"refs":[{"id":"ref-for-document-top-layer\u2461\u2460"},{"id":"ref-for-document-top-layer\u2461\u2461"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"#document-top-layer"},
"e3892eaa": {"dfnID":"e3892eaa","dfnText":"scrollport","external":true,"refSections":[{"refs":[{"id":"ref-for-scrollport"}],"title":"3. Scrollable Containing Block"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollport"},
"e438d305": {"dfnID":"e438d305","dfnText":"outline","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-outline"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-ui-4/#propdef-outline"},
"f285fdb1": {"dfnID":"f285fdb1","dfnText":"relative positioning","external":true,"refSections":[{"refs":[{"id":"ref-for-x34"}],"title":"Unnumbered Section"}],"url":"https://www.w3.org/TR/CSS2/visuren.html#x34"},
"f3c57a2e": {"dfnID":"f3c57a2e","dfnText":"cascade origin","external":true,"refSections":[{"refs":[{"id":"ref-for-origin"}],"title":"4.3. Top Layer Manipulation"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-cascade-6/#origin"},
"f96bc335": {"dfnID":"f96bc335","dfnText":"content","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-content"}],"title":"4.2. The ::backdrop Pseudo-Element"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-content-3/#propdef-content"},
"fdf5064e": {"dfnID":"fdf5064e","dfnText":"easing function","external":true,"refSections":[{"refs":[{"id":"ref-for-easing-function"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#easing-function"},
"in-a-higher-top-layer": {"dfnID":"in-a-higher-top-layer","dfnText":"in a higher top layer","external":false,"refSections":[],"url":"#in-a-higher-top-layer"},
"in-band-outline": {"dfnID":"in-band-outline","dfnText":"in-band","external":false,"refSections":[{"refs":[{"id":"ref-for-in-band-outline"},{"id":"ref-for-in-band-outline\u2460"},{"id":"ref-for-in-band-outline\u2461"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"#in-band-outline"},
"in-the-same-top-layer": {"dfnID":"in-the-same-top-layer","dfnText":"in the same top layer","external":false,"refSections":[],"url":"#in-the-same-top-layer"},
"in-the-top-layer": {"dfnID":"in-the-top-layer","dfnText":"in the top layer","external":false,"refSections":[{"refs":[{"id":"ref-for-in-the-top-layer"}],"title":"4.3. Top Layer Manipulation"},{"refs":[{"id":"ref-for-in-the-top-layer\u2460"},{"id":"ref-for-in-the-top-layer\u2461"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"#in-the-top-layer"},
"out-of-band-outline": {"dfnID":"out-of-band-outline","dfnText":"out-of-band","external":false,"refSections":[{"refs":[{"id":"ref-for-out-of-band-outline"},{"id":"ref-for-out-of-band-outline\u2460"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"#out-of-band-outline"},
"paint-a-blocks-decorations": {"dfnID":"paint-a-blocks-decorations","dfnText":"paint a block\u2019s decorations","external":false,"refSections":[{"refs":[{"id":"ref-for-paint-a-blocks-decorations"},{"id":"ref-for-paint-a-blocks-decorations\u2460"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"#paint-a-blocks-decorations"},
"paint-a-box-in-a-line-box": {"dfnID":"paint-a-box-in-a-line-box","dfnText":"paint a box in a line box","external":false,"refSections":[{"refs":[{"id":"ref-for-paint-a-box-in-a-line-box"},{"id":"ref-for-paint-a-box-in-a-line-box\u2460"},{"id":"ref-for-paint-a-box-in-a-line-box\u2461"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"#paint-a-box-in-a-line-box"},
"paint-a-document": {"dfnID":"paint-a-document","dfnText":"paint a document","external":false,"refSections":[{"refs":[{"id":"ref-for-paint-a-document"}],"title":"4.2. The ::backdrop Pseudo-Element"}],"url":"#paint-a-document"},
"paint-a-stacking-container": {"dfnID":"paint-a-stacking-container","dfnText":"paint a stacking container","external":false,"refSections":[{"refs":[{"id":"ref-for-paint-a-stacking-container"},{"id":"ref-for-paint-a-stacking-container\u2460"},{"id":"ref-for-paint-a-stacking-container\u2461"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"#paint-a-stacking-container"},
"paint-a-stacking-context": {"dfnID":"paint-a-stacking-context","dfnText":"paint a stacking context","external":false,"refSections":[{"refs":[{"id":"ref-for-paint-a-stacking-context"},{"id":"ref-for-paint-a-stacking-context\u2460"},{"id":"ref-for-paint-a-stacking-context\u2461"},{"id":"ref-for-paint-a-stacking-context\u2462"},{"id":"ref-for-paint-a-stacking-context\u2463"},{"id":"ref-for-paint-a-stacking-context\u2464"},{"id":"ref-for-paint-a-stacking-context\u2465"},{"id":"ref-for-paint-a-stacking-context\u2466"}],"title":"2. Painting Order and Stacking Contexts"}],"url":"#paint-a-stacking-context"},
"pending-top-layer-removals": {"dfnID":"pending-top-layer-removals","dfnText":"pending top layer removals","external":false,"refSections":[{"refs":[{"id":"ref-for-pending-top-layer-removals"}],"title":"4. Top Layer"},{"refs":[{"id":"ref-for-pending-top-layer-removals\u2460"},{"id":"ref-for-pending-top-layer-removals\u2461"},{"id":"ref-for-pending-top-layer-removals\u2462"},{"id":"ref-for-pending-top-layer-removals\u2463"},{"id":"ref-for-pending-top-layer-removals\u2464"},{"id":"ref-for-pending-top-layer-removals\u2465"},{"id":"ref-for-pending-top-layer-removals\u2466"},{"id":"ref-for-pending-top-layer-removals\u2467"}],"title":"4.3. Top Layer Manipulation"}],"url":"#pending-top-layer-removals"},
"process-top-layer-removals": {"dfnID":"process-top-layer-removals","dfnText":"process top layer removals","external":false,"refSections":[],"url":"#process-top-layer-removals"},
"propdef-overlay": {"dfnID":"propdef-overlay","dfnText":"overlay","external":false,"refSections":[{"refs":[{"id":"ref-for-propdef-overlay"},{"id":"ref-for-propdef-overlay\u2460"}],"title":"4. Top Layer"},{"refs":[{"id":"ref-for-propdef-overlay\u2461"},{"id":"ref-for-propdef-overlay\u2462"},{"id":"ref-for-propdef-overlay\u2463"},{"id":"ref-for-propdef-overlay\u2464"},{"id":"ref-for-propdef-overlay\u2465"},{"id":"ref-for-propdef-overlay\u2466"},{"id":"ref-for-propdef-overlay\u2467"},{"id":"ref-for-propdef-overlay\u2468"}],"title":"4.3. Top Layer Manipulation"},{"refs":[{"id":"ref-for-propdef-overlay\u2460\u24ea"},{"id":"ref-for-propdef-overlay\u2460\u2460"},{"id":"ref-for-propdef-overlay\u2460\u2461"},{"id":"ref-for-propdef-overlay\u2460\u2462"},{"id":"ref-for-propdef-overlay\u2460\u2463"},{"id":"ref-for-propdef-overlay\u2460\u2464"},{"id":"ref-for-propdef-overlay\u2460\u2465"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"#propdef-overlay"},
"remove-an-element-from-the-top-layer-immediately": {"dfnID":"remove-an-element-from-the-top-layer-immediately","dfnText":"remove an element from the top layer immediately","external":false,"refSections":[{"refs":[{"id":"ref-for-remove-an-element-from-the-top-layer-immediately"}],"title":"4.3. Top Layer Manipulation"}],"url":"#remove-an-element-from-the-top-layer-immediately"},
"render-in-the-top-layer": {"dfnID":"render-in-the-top-layer","dfnText":"rendered in the top layer","external":false,"refSections":[{"refs":[{"id":"ref-for-render-in-the-top-layer"}],"title":"4.1. Top Layer Styling"},{"refs":[{"id":"ref-for-render-in-the-top-layer\u2460"}],"title":"4.2. The ::backdrop Pseudo-Element"},{"refs":[{"id":"ref-for-render-in-the-top-layer\u2461"},{"id":"ref-for-render-in-the-top-layer\u2462"}],"title":"4.3. Top Layer Manipulation"},{"refs":[{"id":"ref-for-render-in-the-top-layer\u2463"},{"id":"ref-for-render-in-the-top-layer\u2464"},{"id":"ref-for-render-in-the-top-layer\u2465"},{"id":"ref-for-render-in-the-top-layer\u2466"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"#render-in-the-top-layer"},
"request-an-element-to-be-removed-from-the-top-layer": {"dfnID":"request-an-element-to-be-removed-from-the-top-layer","dfnText":"request an element to be removed from the top layer","external":false,"refSections":[{"refs":[{"id":"ref-for-request-an-element-to-be-removed-from-the-top-layer"}],"title":"4.3. Top Layer Manipulation"}],"url":"#request-an-element-to-be-removed-from-the-top-layer"},
"scrollable-containing-block": {"dfnID":"scrollable-containing-block","dfnText":"scrollable containing block","external":false,"refSections":[{"refs":[{"id":"ref-for-scrollable-containing-block"},{"id":"ref-for-scrollable-containing-block\u2460"},{"id":"ref-for-scrollable-containing-block\u2461"}],"title":"3. Scrollable Containing Block"}],"url":"#scrollable-containing-block"},
"selectordef-backdrop": {"dfnID":"selectordef-backdrop","dfnText":"::backdrop","external":false,"refSections":[{"refs":[{"id":"ref-for-selectordef-backdrop"}],"title":"2. Painting Order and Stacking Contexts"},{"refs":[{"id":"ref-for-selectordef-backdrop\u2460"},{"id":"ref-for-selectordef-backdrop\u2461"}],"title":"4.1. Top Layer Styling"},{"refs":[{"id":"ref-for-selectordef-backdrop\u2462"},{"id":"ref-for-selectordef-backdrop\u2463"},{"id":"ref-for-selectordef-backdrop\u2464"},{"id":"ref-for-selectordef-backdrop\u2465"},{"id":"ref-for-selectordef-backdrop\u2466"},{"id":"ref-for-selectordef-backdrop\u2467"},{"id":"ref-for-selectordef-backdrop\u2468"}],"title":"4.2. The ::backdrop Pseudo-Element"},{"refs":[{"id":"ref-for-selectordef-backdrop\u2460\u24ea"},{"id":"ref-for-selectordef-backdrop\u2460\u2460"}],"title":"4.3. Top Layer Manipulation"}],"url":"#selectordef-backdrop"},
"top-layer-root": {"dfnID":"top-layer-root","dfnText":"top layer root","external":false,"refSections":[{"refs":[{"id":"ref-for-top-layer-root"},{"id":"ref-for-top-layer-root\u2460"},{"id":"ref-for-top-layer-root\u2461"},{"id":"ref-for-top-layer-root\u2462"}],"title":"4. Top Layer"}],"url":"#top-layer-root"},
"valdef-overlay-auto": {"dfnID":"valdef-overlay-auto","dfnText":"auto","external":false,"refSections":[{"refs":[{"id":"ref-for-valdef-overlay-auto"},{"id":"ref-for-valdef-overlay-auto\u2460"},{"id":"ref-for-valdef-overlay-auto\u2461"}],"title":"4.4. Controlling the Top Layer: the overlay property"}],"url":"#valdef-overlay-auto"},
"valdef-overlay-none": {"dfnID":"valdef-overlay-none","dfnText":"none","external":false,"refSections":[{"refs":[{"id":"ref-for-valdef-overlay-none"}],"title":"4.3. Top Layer Manipulation"}],"url":"#valdef-overlay-none"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-position-annos */
"use strict";
{
function repositionAnnoPanels(){
    const panels = [...document.querySelectorAll("[data-anno-for]")];
    hydratePanels(panels);
    let vSoFar = 0;
    for(const panel of panels.sort(cmpTops)) {
        if(panel.top < vSoFar) {
            panel.top = vSoFar;
            panel.style.top = vSoFar + "px";
        }
        vSoFar = panel.top + panel.height + 15;
    }
}
function hydratePanels(panels) {
    const main = document.querySelector("main");
    let mainRect;
    if(main) mainRect = main.getBoundingClientRect();
    // First display them all, if they're not already visible.
    for(const panel of panels) {
        panel.classList.remove("unpositioned");
    }
    // Measure them all
    for(const panel of panels) {
        const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
        if(!dfn) {
            console.log("Can't find the annotation panel target:", panel);
            continue;
        }
        panel.dfn = dfn;
        panel.top = window.scrollY + dfn.getBoundingClientRect().top;
        let panelRect = panel.getBoundingClientRect();
        panel.height = panelRect.height;
        if(main) {
            panel.overlappingMain = panelRect.left < mainRect.right;
        } else {
            panel.overlappingMain = false;
        }
    }
    // And finally position them
    for(const panel of panels) {
        const dfn = panel.dfn;
        if(!dfn) continue;
        panel.style.top = panel.top + "px";
        panel.classList.toggle("overlapping-main", panel.overlappingMain);
    }
}

function cmpTops(a,b) {
    return a.top - b.top;
}

window.addEventListener("load", repositionAnnoPanels);
window.addEventListener("resize", repositionAnnoPanels);
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#document-top-layer": {"displayText":"top layer","export":true,"for_":["Document"],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"top layer","type":"dfn","url":"#document-top-layer"},
"#in-band-outline": {"displayText":"in-band outline","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"in-band outline","type":"dfn","url":"#in-band-outline"},
"#in-the-top-layer": {"displayText":"in the top layer","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"in the top layer","type":"dfn","url":"#in-the-top-layer"},
"#out-of-band-outline": {"displayText":"out-of-band outline","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"out-of-band outline","type":"dfn","url":"#out-of-band-outline"},
"#paint-a-blocks-decorations": {"displayText":"paint a block's decorations","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"paint a block's decorations","type":"dfn","url":"#paint-a-blocks-decorations"},
"#paint-a-box-in-a-line-box": {"displayText":"paint a box in a line box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"paint a box in a line box","type":"dfn","url":"#paint-a-box-in-a-line-box"},
"#paint-a-document": {"displayText":"paint a document","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"paint a document","type":"dfn","url":"#paint-a-document"},
"#paint-a-stacking-container": {"displayText":"paint a stacking container","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"paint a stacking container","type":"dfn","url":"#paint-a-stacking-container"},
"#paint-a-stacking-context": {"displayText":"paint a stacking context","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"paint a stacking context","type":"dfn","url":"#paint-a-stacking-context"},
"#pending-top-layer-removals": {"displayText":"pending top layer removals","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"pending top layer removals","type":"dfn","url":"#pending-top-layer-removals"},
"#propdef-overlay": {"displayText":"overlay","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"overlay","type":"property","url":"#propdef-overlay"},
"#remove-an-element-from-the-top-layer-immediately": {"displayText":"remove from the top layer immediately","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"remove from the top layer immediately","type":"dfn","url":"#remove-an-element-from-the-top-layer-immediately"},
"#render-in-the-top-layer": {"displayText":"render in the top layer","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"render in the top layer","type":"dfn","url":"#render-in-the-top-layer"},
"#request-an-element-to-be-removed-from-the-top-layer": {"displayText":"request removal from the top layer","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"request removal from the top layer","type":"dfn","url":"#request-an-element-to-be-removed-from-the-top-layer"},
"#scrollable-containing-block": {"displayText":"scrollable containing block","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"scrollable containing block","type":"dfn","url":"#scrollable-containing-block"},
"#selectordef-backdrop": {"displayText":"::backdrop","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"::backdrop","type":"selector","url":"#selectordef-backdrop"},
"#top-layer-root": {"displayText":"top layer root","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"top layer root","type":"dfn","url":"#top-layer-root"},
"#valdef-overlay-auto": {"displayText":"auto","export":true,"for_":["overlay"],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"auto","type":"value","url":"#valdef-overlay-auto"},
"#valdef-overlay-none": {"displayText":"none","export":true,"for_":["overlay"],"level":"4","normative":true,"shortname":"css-position","spec":"css-position-4","status":"local","text":"none","type":"value","url":"#valdef-overlay-none"},
"https://andreubotella.com/csswg-auto-build/test/css-anchor-position-1/#propdef-position-area": {"displayText":"position-area","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-anchor-position","spec":"css-anchor-position-1","status":"current","text":"position-area","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-anchor-position-1/#propdef-position-area"},
"https://andreubotella.com/csswg-auto-build/test/css-box-4/#padding-box": {"displayText":"padding box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-box","spec":"css-box-4","status":"current","text":"padding box","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-box-4/#padding-box"},
"https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment": {"displayText":"fragment","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-break","spec":"css-break-4","status":"current","text":"fragment","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-break-4/#fragment"},
"https://andreubotella.com/csswg-auto-build/test/css-cascade-6/#origin": {"displayText":"cascade origin","export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"current","text":"cascade origin","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-cascade-6/#origin"},
"https://andreubotella.com/csswg-auto-build/test/css-color-4/#propdef-opacity": {"displayText":"opacity","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-color","spec":"css-color-4","status":"current","text":"opacity","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-color-4/#propdef-opacity"},
"https://andreubotella.com/csswg-auto-build/test/css-content-3/#propdef-content": {"displayText":"content","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-content","spec":"css-content-3","status":"current","text":"content","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-content-3/#propdef-content"},
"https://andreubotella.com/csswg-auto-build/test/css-content-3/#valdef-content-none": {"displayText":"none","export":true,"for_":["content"],"level":"3","normative":true,"shortname":"css-content","spec":"css-content-3","status":"current","text":"none","type":"value","url":"https://andreubotella.com/csswg-auto-build/test/css-content-3/#valdef-content-none"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-box": {"displayText":"block box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"block box","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-box"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level": {"displayText":"block-level","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"block-level","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level-box": {"displayText":"block-level box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"block-level box","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#block-level-box"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#box": {"displayText":"box","export":true,"for_":["CSS"],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"box","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#box"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#box-tree": {"displayText":"box tree","export":true,"for_":["CSS"],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"box tree","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#box-tree"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block": {"displayText":"containing block","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"containing block","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block-chain": {"displayText":"containing block chain","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"containing block chain","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#containing-block-chain"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#css-text-sequence": {"displayText":"text sequence","export":true,"for_":["CSS"],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"text sequence","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#css-text-sequence"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#initial-containing-block": {"displayText":"initial containing block","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"initial containing block","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#initial-containing-block"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-box": {"displayText":"inline box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"inline box","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-box"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-level": {"displayText":"inline-level","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"inline-level","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#inline-level"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#principal-box": {"displayText":"principal box","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"principal box","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#principal-box"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-display": {"displayText":"display","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"display","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-display"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-visibility": {"displayText":"visibility","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"visibility","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#propdef-visibility"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#replaced-element": {"displayText":"replaced element","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"replaced element","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#replaced-element"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#root-element": {"displayText":"root element","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"root element","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#root-element"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-block": {"displayText":"block","export":true,"for_":["display","<display-outside>"],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"block","type":"value","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-block"},
"https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-contents": {"displayText":"contents","export":true,"for_":["display","<display-box>"],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"contents","type":"value","url":"https://andreubotella.com/csswg-auto-build/test/css-display-4/#valdef-display-contents"},
"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#easing-function": {"displayText":"easing function","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-easing","spec":"css-easing-2","status":"current","text":"easing function","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#easing-function"},
"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#funcdef-linear": {"displayText":"linear()","export":true,"for_":[],"level":"2","normative":true,"shortname":"css-easing","spec":"css-easing-2","status":"current","text":"linear()","type":"function","url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#funcdef-linear"},
"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-end": {"displayText":"step-end","export":true,"for_":["<step-easing-function>","steps()"],"level":"2","normative":true,"shortname":"css-easing","spec":"css-easing-2","status":"current","text":"step-end","type":"value","url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-end"},
"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-start": {"displayText":"step-start","export":true,"for_":["<step-easing-function>","steps()"],"level":"2","normative":true,"shortname":"css-easing","spec":"css-easing-2","status":"current","text":"step-start","type":"value","url":"https://andreubotella.com/csswg-auto-build/test/css-easing-2/#valdef-step-easing-function-step-start"},
"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#propdef-overflow": {"displayText":"overflow","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-overflow","spec":"css-overflow-3","status":"current","text":"overflow","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#propdef-overflow"},
"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scroll-container": {"displayText":"scroll container","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-overflow","spec":"css-overflow-3","status":"current","text":"scroll container","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scroll-container"},
"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollable-overflow-rectangle": {"displayText":"scrollable overflow rectangle","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-overflow","spec":"css-overflow-3","status":"current","text":"scrollable overflow rectangle","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollable-overflow-rectangle"},
"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollport": {"displayText":"scrollport","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-overflow","spec":"css-overflow-3","status":"current","text":"scrollport","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-overflow-3/#scrollport"},
"https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-position": {"displayText":"absolute position","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-position","spec":"css-position-3","status":"current","text":"absolute position","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-position"},
"https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-positioning-containing-block": {"displayText":"absolute positioning containing block","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-position","spec":"css-position-3","status":"current","text":"absolute positioning containing block","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#absolute-positioning-containing-block"},
"https://andreubotella.com/csswg-auto-build/test/css-position-3/#fixed-position": {"displayText":"fixed position","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-position","spec":"css-position-3","status":"current","text":"fixed position","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#fixed-position"},
"https://andreubotella.com/csswg-auto-build/test/css-position-3/#propdef-position": {"displayText":"position","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-position","spec":"css-position-3","status":"current","text":"position","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#propdef-position"},
"https://andreubotella.com/csswg-auto-build/test/css-position-3/#sticky-position": {"displayText":"sticky position","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-position","spec":"css-position-3","status":"current","text":"sticky position","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#sticky-position"},
"https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-absolute": {"displayText":"absolute","export":true,"for_":["position"],"level":"3","normative":true,"shortname":"css-position","spec":"css-position-3","status":"current","text":"absolute","type":"value","url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-absolute"},
"https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-fixed": {"displayText":"fixed","export":true,"for_":["position"],"level":"3","normative":true,"shortname":"css-position","spec":"css-position-3","status":"current","text":"fixed","type":"value","url":"https://andreubotella.com/csswg-auto-build/test/css-position-3/#valdef-position-fixed"},
"https://andreubotella.com/csswg-auto-build/test/css-pseudo-4/#tree-abiding": {"displayText":"tree-abiding pseudo-elements","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-pseudo","spec":"css-pseudo-4","status":"current","text":"tree-abiding pseudo-elements","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-pseudo-4/#tree-abiding"},
"https://andreubotella.com/csswg-auto-build/test/css-tables-3/#table-wrapper-box": {"displayText":"table wrapper box","export":true,"for_":[],"level":"3","normative":true,"shortname":"css-tables","spec":"css-tables-3","status":"current","text":"table wrapper box","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-tables-3/#table-wrapper-box"},
"https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#propdef-transition": {"displayText":"transition","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-transitions","spec":"css-transitions-1","status":"current","text":"transition","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#propdef-transition"},
"https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#transitions": {"displayText":"transitions","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-transitions","spec":"css-transitions-1","status":"current","text":"transitions","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-transitions-1/#transitions"},
"https://andreubotella.com/csswg-auto-build/test/css-ui-4/#propdef-outline": {"displayText":"outline","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-ui","spec":"css-ui-4","status":"current","text":"outline","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css-ui-4/#propdef-outline"},
"https://andreubotella.com/csswg-auto-build/test/css-values-4/#comb-one": {"displayText":"|","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"|","type":"grammar","url":"https://andreubotella.com/csswg-auto-build/test/css-values-4/#comb-one"},
"https://andreubotella.com/csswg-auto-build/test/css-values-4/#interpolation": {"displayText":"interpolate","export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"interpolate","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/css-values-4/#interpolation"},
"https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index": {"displayText":"z-index","export":true,"for_":[],"level":"2","normative":true,"shortname":"css","spec":"css2","status":"current","text":"z-index","type":"property","url":"https://andreubotella.com/csswg-auto-build/test/css2/#propdef-z-index"},
"https://andreubotella.com/csswg-auto-build/test/selectors-4/#originating-element": {"displayText":"originating element","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"originating element","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/selectors-4/#originating-element"},
"https://andreubotella.com/csswg-auto-build/test/selectors-4/#pseudo-element": {"displayText":"pseudo-element","export":true,"for_":[],"level":"4","normative":true,"shortname":"selectors","spec":"selectors-4","status":"current","text":"pseudo-element","type":"dfn","url":"https://andreubotella.com/csswg-auto-build/test/selectors-4/#pseudo-element"},
"https://dom.spec.whatwg.org/#concept-element": {"displayText":"element","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"element","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-element"},
"https://dom.spec.whatwg.org/#concept-node-document": {"displayText":"node document","export":true,"for_":["Node"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"node document","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-node-document"},
"https://dom.spec.whatwg.org/#concept-shadow-including-inclusive-ancestor": {"displayText":"shadow-including inclusive ancestor","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"shadow-including inclusive ancestor","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-shadow-including-inclusive-ancestor"},
"https://dom.spec.whatwg.org/#concept-tree-order": {"displayText":"tree order","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"tree order","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-tree-order"},
"https://dom.spec.whatwg.org/#document": {"displayText":"Document","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Document","type":"interface","url":"https://dom.spec.whatwg.org/#document"},
"https://dom.spec.whatwg.org/#element": {"displayText":"Element","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Element","type":"interface","url":"https://dom.spec.whatwg.org/#element"},
"https://drafts.fxtf.org/css-masking-1/#propdef-mask": {"displayText":"mask","export":true,"for_":[],"level":"1","normative":true,"shortname":"css-masking","spec":"css-masking-1","status":"current","text":"mask","type":"property","url":"https://drafts.fxtf.org/css-masking-1/#propdef-mask"},
"https://infra.spec.whatwg.org/#list-contain": {"displayText":"contain","export":true,"for_":["list","stack","queue","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"contain","type":"dfn","url":"https://infra.spec.whatwg.org/#list-contain"},
"https://infra.spec.whatwg.org/#list-remove": {"displayText":"remove","export":true,"for_":["list","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"remove","type":"dfn","url":"https://infra.spec.whatwg.org/#list-remove"},
"https://infra.spec.whatwg.org/#ordered-set": {"displayText":"ordered set","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ordered set","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-set"},
"https://infra.spec.whatwg.org/#set-append": {"displayText":"append","export":true,"for_":["set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"append","type":"dfn","url":"https://infra.spec.whatwg.org/#set-append"},
"https://infra.spec.whatwg.org/#user-agent": {"displayText":"user agent","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"user agent","type":"dfn","url":"https://infra.spec.whatwg.org/#user-agent"},
"https://www.w3.org/TR/CSS2/visuren.html#x34": {"displayText":"relative positioning","export":true,"for_":[],"level":"2","normative":true,"shortname":"css","spec":"css2","status":"snapshot","text":"relative positioning","type":"dfn","url":"https://www.w3.org/TR/CSS2/visuren.html#x34"},
"https://www.w3.org/TR/CSS2/visuren.html#x43": {"displayText":"stacking context","export":true,"for_":[],"level":"2","normative":true,"shortname":"css","spec":"css2","status":"snapshot","text":"stacking context","type":"dfn","url":"https://www.w3.org/TR/CSS2/visuren.html#x43"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const refHintKey = link.getAttribute("data-refhint-key");
    let key = url;
    if(refHintKey) {
        key = refHintKey + "_" + url;
    }
    const ref = refsData[key];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
"use strict";
{
/*
Color-choosing design:

* Colors are ordered by goodness.
* On clicking a var, give it the earliest color
    with the lowest usage in the algorithm.
* On re-clicking, re-use the var's most recent color
    if that's not currently being used elsewhere.
*/

const COLOR_COUNT = 7;

document.addEventListener("click", e=>{
    if(e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
    }
});

function highlightSameAlgoVars(v) {
    // Find the algorithm container.
    let algoContainer = findAlgoContainer(v);

    // Not highlighting document-global vars,
    // too likely to be unrelated.
    if(algoContainer == null) return;

    const varName = nameFromVar(v);
    if(!v.hasAttribute("data-var-color")) {
        const newColor = chooseHighlightColor(algoContainer, v);
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.setAttribute("data-var-color", newColor);
                el.setAttribute("data-var-last-color", newColor);
            }
        }
    } else {
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.removeAttribute("data-var-color");
            }
        }
    }
}
function findAlgoContainer(el) {
    while(el != document.body) {
        if(el.hasAttribute("data-algorithm")) return el;
        el = el.parentNode;
    }
    return null;
}
function nameFromVar(el) {
    return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
}
function colorCountsFromContainer(container) {
    const namesFromColor = Array.from({length:COLOR_COUNT}, x=>new Set());
    for(let v of container.querySelectorAll("var[data-var-color]")) {
        let color = +v.getAttribute("data-var-color");
        namesFromColor[color].add(nameFromVar(v));
    }

    return namesFromColor.map(x=>x.size);
}
function leastUsedColor(colors) {
    // Find the earliest color with the lowest count.
    let minCount = Infinity;
    let minColor = null;
    for(var i = 0; i < colors.length; i++) {
        if(colors[i] < minCount) {
            minColor = i;
            minCount = colors[i];
        }
    }
    return minColor;
}
function chooseHighlightColor(container, v) {
    const colorCounts = colorCountsFromContainer(container);
    if(v.hasAttribute("data-var-last-color")) {
        let color = +v.getAttribute("data-var-last-color");
        if(colorCounts[color] == 0) return color;
    }
    return leastUsedColor(colorCounts);
}
}
</script>